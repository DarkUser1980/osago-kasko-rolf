!function(e){e.module("KaskoApp",["ui.router","ui.mask","ngSanitize","ngDialog","angularFileUpload","kaskoTemplates","calculatorC","formationPolicyC","brandingC","AddingDocumentsC","calculatorStepsC","brandingConfigs","utils","dictionary","policyOrdering","priceFormatter","inputOnly","ngThumb","jDatePicker","calculator","person","dropdown","UIElements","appMessage","priceSlider","dadata","mainContent","baseModule","carFilter","preCalculator","postCalculator","calculatorSteps","calculatorC","formationPolicyC","brandingC","AddingDocumentsC","calculatorStepsC"]),e.module("KaskoApp").value("moduleType","kasko"),e.module("baseModule",[]),e.module("calculator",[])}(angular),function(e){e.module("OsagoApp",["ui.router","ui.mask","ngSanitize","ngDialog","angularFileUpload","kaskoTemplates","brandingConfigs","utils","dictionary","policyOrdering","priceFormatter","inputOnly","ngThumb","jDatePicker","calculator","person","dropdown","UIElements","appMessage","priceSlider","dadata","mainContent","baseModule","carFilter","preCalculator","postCalculator","calculatorSteps","calculatorO","formationPolicy","AddingDocuments","branding","personalData","calculatorStepsO"]),e.module("OsagoApp").value("moduleType","osago"),e.module("baseModule",[]),e.module("calculator",[])}(angular),function(e){"use strict";e.module("baseModule").controller("baseController",["CONSTS","$rootScope","brandingService",function(e,t,a){t.currentBrandName=e.currentBrand,t.currentBrand=a[t.currentBrandName]}])}(angular),function(e){"use strict";e.module("baseModule").config(["DictionaryProvider","CONSTS","jdatepickerProvider","calculatorProvider","$compileProvider","$locationProvider",function(e,t,a,i,n,r){e.setConstants(t),window.location.port&&80!==window.location.port||n.debugInfoEnabled(!1),r.hashPrefix("!"),a.setDefaults({dateFormat:"dd.mm.yy",pDateFormat:"yy-mm-dd",mDateFormat:"yy-mm-dd",replacedSymbols:{"/":".",",":"."},inputRule:function(e){var t,a,i=/([\d]{0,2})(\.?)([\d]{0,2})(\.?)([\d]{0,4})/;return a=i.exec(e),t=e,a&&(t="",a[1]&&(t=a[1],(2==a[1].length||a[3])&&(t+=".")),a[3]&&(t+=a[3],(2==a[3].length||a[5])&&(t+=".")),t+=a[5]),t}})}])}(angular),function(e){"use strict";e.module("baseModule").constant("CONSTS",function(){var t={host:"",hostApi:"",prefixPath:"",proxyPath:"",proxyPathC:"",currentBrand:""};return AngularAppConfig&&(AngularAppConfig.host&&(t.host=AngularAppConfig.host),AngularAppConfig.hostApi&&(t.hostApi=AngularAppConfig.hostApi),AngularAppConfig.prefixPath&&(t.prefixPath=AngularAppConfig.prefixPath),AngularAppConfig.proxyPath&&(t.proxyPath=AngularAppConfig.proxyPath),t.proxyPathC=AngularAppConfig.proxyPathC||t.proxyPath,AngularAppConfig.currentBrand?t.currentBrand=AngularAppConfig.currentBrand:t.currentBrand="other"),e.extend(t,{pathToSource:t.prefixPath+"js/",pathToModules:t.prefixPath+"js/modules.",urlPrefix:t.host+"/rest/v1/",urlPrefixDefault:t.host+"/rest/default/",urlPrefixV3:t.host+"/rest/v3/default/",urlPrefixV4:t.host+"/rest/v4/",urlPrefixV3Client:t.host+"/rest/v1/client/",urlPrefixCalc:t.host+"/rest/full/",urlPrefixPolicy:t.host+"/policy/rest/",urlPrefixApi:t.hostApi+"/api/"}),t}())}(angular);var jQueryApp=jQuery.noConflict();!function(e){"use strict";e.module("baseModule").service("resources",["CONSTS",function(e){this.deal=e.urlPrefix+"deal/deal",this.person=e.urlPrefix+"client/person",this.customer=e.urlPrefix+"client/customer",this.obtainToken=e.urlPrefix+"accounts/obtain-token",this.legalPerson=e.urlPrefix+"client/legal-person",this.customerCar=e.urlPrefix+"client/car",this.currentUser=e.urlPrefix+"accounts/user/current",this.calculation=e.urlPrefixCalc+"calculation/",this.resultPolicy=e.urlPrefixPolicy+"result_policy/",this.naturalPerson=e.urlPrefix+"client/natural-person",this.insuredObject=e.urlPrefixDefault+"client/insured-object-create",this.insuredObjectOsago=e.urlPrefixDefault+"client/insured-object-osago-create",this.calculationV3=e.urlPrefixV3+"calculation/",this.userActivation=e.urlPrefix+"registration/activation",this.calculationList=e.urlPrefixV3+"calculation/list/",this.insuredObectList=e.urlPrefix+"client/insured-object",this.insuredObjectCRM=e.urlPrefix+"client/insured-object",this.notificationSend=e.urlPrefix+"notification/send",this.userRegistration=e.urlPrefix+"registration/registration",this.insuranceProduct=e.urlPrefix+"deal/insurance-product",this.savedCars=e.urlPrefix+"client/car",this.savedNaturalPersons=e.urlPrefix+"client/natural-person",this.savedLegalPersons=e.urlPrefix+"client/legal-person"}])}(angular),function(e){"use strict";e.module("baseModule").config(["$stateProvider","$parseProvider","$urlRouterProvider","CONSTS",function(e,t,a,i){var n=i.pathToModules,r="/kasko/",s="";778==window.location.port&&(s="",r+="{calculationId:[0-9]*}"),a.otherwise(function(){return r?s+r:"/"}),e.state("index",{url:"?interface&sms",abstract:!0,views:{"":{controller:"baseController",templateUrl:n+"shared/mainContent/views/main_content.html"}},resolve:{calcType:["$rootScope","moduleType",function(e,t){e.calcType=t}]}}).state("index.calculator",{url:s,abstract:!0,reloadOnSearch:!0,controller:"calculatorCtrl",templateUrl:n+"shared/calculator/views/calculator.html"}).state("index.preCalculator",{url:"/pre",controller:"preCalculatorCtrl",templateUrl:n+"shared/preCalculator/views/pre_calculator.rolf.html"}).state("index.postCalculator",{url:"/get-best-offer",controller:"postCalculatorCtrl",templateUrl:n+"shared/postCalculator/views/post_calculator.rolf.html"}).state("index.calculator.kasko",{url:r,views:{"":{controller:"calculatorCascoCtrl",templateUrl:n+"kasko/calculatorC/views/calculation.form.html"},"step_3@index.calculator.kasko":{templateUrl:n+"kasko/calculatorC/views/kasko/calculation.step_3.html"},"step_6@index.calculator.kasko":{templateUrl:n+"kasko/calculatorC/views/kasko/calculation.step_6.html"}}}).state("index.calculator.osago",{url:"/osago/",views:{"":{controller:"calculatorOsagoCtrl",templateUrl:n+"osago/calculatorO/views/calculation.form.html"},"step_2@index.calculator.osago":{templateUrl:n+"osago/calculatorO/views/osago/calculation.step_2.html"},"step_3@index.calculator.osago":{templateUrl:n+"osago/calculatorO/views/osago/calculation.step_3.html"},"step_4@index.calculator.osago":{templateUrl:n+"osago/calculatorO/views/osago/calculation.step_4.html"},"step_5@index.calculator.osago":{templateUrl:n+"osago/calculatorO/views/osago/calculation.step_5.html"},"step_6@index.calculator.osago":{templateUrl:n+"osago/calculatorO/views/osago/calculation.step_6.html"}}})}])}(angular),function(e,t){"use strict";e.module("baseModule").run(["$rootScope","$state","$injector","$http","CONSTS","$location","ngDialog",function(t,a,i,n,r,s,l){var o,c=s.path;_.mixin({isPromise:function(e){return e&&_.isFunction(e.then)},getYearByDate:function(e){var t=new Date,a=new Date(e);if(a.getTime())return new Date(t-a).getFullYear()-1970}}),t.$on("$stateChangeStart",function(e,a,i,n,r){t.lastState=a,t.lastState.toParams=i}),t.$on("$stateChangeSuccess",function(e,a,i,n){t.$previousState=n,t.$activeState=a,o&&(l.close(o),o=null)}),t.$on("ngDialog.opened",function(e,t){o=t.attr("id")}),t.cancellerRequests=[],t.cancelAllRequests=function(){e.forEach(t.cancellerRequests,function(e){e.resolve()}),t.cancellerRequests.length=0},s.path=function(e,i){if(i===!1)var n=a.current,r=t.$on("$stateChangeSuccess",function(){a.current=n,r()});return c.apply(s,[e])},t.prefixPath=r.prefixPath}])}(angular,jQueryApp),function(e){e.module("kaskoTemplates",[])}(angular),function(e){e.module("calculatorC",[])}(angular),function(e,t){"use strict";e.module("calculatorC").controller("calculatorCascoCtrl",["$scope","$q","calculatorService","CONSTS","$stateParams","Dictionary","$filter","formationPolicyService","formationPolicyStep1Service","$rootScope","ngDialog","Person","calculatorStepsService","brandingConfigs",function(t,a,i,n,r,s,l,o,c,d,u,p,m,g){function v(a){C=a.insurance_type,T=e.copy(a),t.params.drivers_count=a.driver_set.length,t.params.drivers_count_full=a.driver_set.length,a.insured_object?k(a.insured_object):f()}function f(){h()}function h(a){var i=e.copy($);i.driver_license=c.getDefaultObject("defaultDriverLicenseObject");var n=new p(e.extend({},i,a));t.drivers.push(n)}function b(a){var i=new p(e.extend({},O,a));t.persons.push(i)}function y(e){_.forEach(e,function(e){var t=new Date(e.birth_date),a=new Date(e.driving_experience_started);t.setDate(t.getDate()+2),a.setDate(a.getDate()+2);var i=_.getYearByDate(t),n=_.getYearByDate(a);i=i>=18&&i<23?19:i>=23&&i<29?24:i>=29&&i<35?30:i>=35&&i<40?36:i>=40&&i<65?41:66,n=n>=0&&n<2?1:n>=2&&n<5?3:n>=5&&n<10?6:11,e.age=i,e.expirience=n})}function w(){return(t.calculation.engine_power>9&&t.calculation.engine_power<=999||!t.calculation.engine_power)&&t.calculation.car_mark&&t.calculation.car_model&&t.calculation.car_manufacturing_year}function x(t,a){return e.isObject(t)?e.equals(t,a):null===t||null===a?Boolean(t)==Boolean(a):t==a}function k(t){return o.getInsuredObject(t).then(function(t){return I=e.copy(t),P(t)})}function P(a){var i=e.copy(a.person);return t.persons.length=0,t.drivers.length=0,a.object.vin_number?(t.osagoParams.vin_number=a.object.vin_number,t.osagoParams.vin_is_visible=!0):t.osagoParams.vin_is_visible=!1,e.forEach(i,function(a){var i=a.natural_person?"natural_person":"legal_person";a[i].selectedPerson=a[i].external_id,"natural_person"===i?(a[i].age=l("calcAge")(a[i].birth_date),a[i].expirience=l("calcAge")(a[i].driving_experience_started)):(t.osagoParams.legal_person.inn=a[i].inn,t.osagoParams.legal_person.title=a[i].title,t.osagoParams.legal_person.insurant_is_legal_person=!0),a[i].personType=i,c.setPersonCredential(a[i]),c.setPersonAddress(a[i]),a.role.length&&_.forEach(a.role,function(e){a[i]["is"+e.slice(0,1).toUpperCase()+e.slice(1,e.length)]=!0}),"natural_person"===i&&b(e.copy(a[i]))}),e.forEach(a.drivers,function(e){e.personType="natural_person",e.isDriver=!0,c.setPersonCredential(e),h(e)}),t.persons.length||t.drivers.length||b(),t.drivers.length&&(a.person.length&&(t.drivers[0].person=a.person[0].id),t.persons.length=0),t.cachedDrivers=e.copy(t.drivers),S={drivers:e.copy(t.drivers),persons:e.copy(t.persons)},a}var C,S,I,D=i.getPromises(),T={},$={credential:[],address:[],contact:[],first_name:"",last_name:"",patronymic:"",isDriver:!0,personType:"natural_person",birth_date:"",gender:"M",driving_experience_started:"",driver_license:c.getDefaultObject("defaultDriverLicenseObject")},O={is_same_address:!0,credential:[],isOwner:!0,personType:"natural_person",isDriver:!1,isInsurant:!1,first_name:"",last_name:"",patronymic:"",gender:"M",birth_date:"",passport:c.getDefaultObject("defaultPassportObject"),address_registration:{address_type:1,postal_index:"Нет",country:"Россия",city:"Не указан",street:"Не указана",house:"Не указан",housing:"Не указан",flat:"Не указан",kladr:""}},j=[];t.dicts={},t.dynamicDicts={},t.persons=[],t.drivers=[],t.params.field_was_clicked=!1,t.osagoParams={vin_number:"",vin_is_visible:!0,legal_person:{isOwner:!0,isInsurant:!1,inn:"",title:"",address_registration:{address_type:1,postal_index:"Нет",country:"Россия",city:"Не указан",street:"Не указана",house:"Не указан",housing:"Не указан",flat:"Не указан",kladr:""},is_same_address:!0,personType:"legal_person"}},t.getCurrentCalcType=function(){return m.getCurrentCalcType()},i.calculationFormIsValid=function(){return!0},t.templates.program_list=g.templates.program_list||n.pathToModules+"kasko/calculatorC/views/calculation.program_list.html",t.templates.navigation=g.templates.navigation||n.pathToModules+"shared/calculator/views/navigation.html",t.templates.step_2=g.templates.step_2||n.pathToModules+"kasko/calculatorC/views/calculation.step_2.html",t.validation={},t.isVisible=function(e,a,i){var n;+t.calculation.car_type;return i=i||t.calculation,n||(i[e]=a||null),n},t.isDisabled=function(e,a,i){var n;+t.calculation.car_type;return i=i||t.calculation,n&&(i[e]=a||null),n},_.isPromise(D.getCalculation)?D.getCalculation.then(v,f):t.calculation.id?i.getCalculation(t.calculation.id).then(v,f):f(),t.calculateKasko=function(){if(!t.params.recalculateButtonIsDisabled)return t.params.recalculateButtonIsDisabled=!0,t.params.isCalculationProgress=!0,t.root.messages.length=0,t.calculation.exploitation_area=t.calculation.exploitation_area||m.calculationInterParams.exploitation_area,t.calculation.is_calculate_osago=!1,delete t.calculation.insurance_type,delete t.calculation.insured_object,"tumen"===d.currentBrandName&&y(t.calculation.driver_set),t.postCalculateParams.second&&(t.calculation.contributory_scheme=t.params.contributory_scheme||19,t.calculation.payment_form=t.params.payment_form?[t.params.payment_form]:null),t.calculation.deductible_value=t.params.deductible_value,t.calculation.is_deductible=!!parseInt(t.calculation.deductible_value,10),t.calculate(function(a){t.cachedDrivers=e.copy(t.drivers),t.disabledFormationPolicyButtonIsActive=!0,T=e.copy(a)})},t.disabledSubmitButton=function(){return t.root.isSubmitButtonDisabled=!w()||!!t.params.isCalculationProgress,t.root.isSubmitButtonDisabled},t.addressIsValid=function(e){return e.city&&e.house&&e.street},t.getYearRange=function(e,t){var a,i,n=new Date;return e=e||0,t=void 0===t?90:t,i=n.getFullYear()-t,a=n.getFullYear()-e,i+":"+a},t.params.brandedDeductibleValues=a.when(_.map(d.currentBrand.deductible_values,function(e){return{id:e,title:e}})),function(){var a=["insuranceDuration","ownerRegistration"];e.forEach(a,function(a){t.dicts[a]=s.getItems(a).then(function(t){return t=t.results?t.results:t,j[a]=e.copy(t),t})}),t.dicts.trueFalse=[{title:"Да",id:!0},{title:"Нет",id:!1}],t.dicts.isLegalEntity=[{title:"Физическое лицо",id:!1},{title:"Юридическое лицо",id:!0}],t.dicts.insuranceDuration=t.dicts.insuranceDuration.then(function(e){return _.filter(e,function(e){return"1 год"===e.title})})}(),t.driversCountChanged=function(){var e=t.drivers.length,a=t.params.drivers_count_full;if(t.calculation.is_multidrive=!a,a&&"0"!==a?(t.persons.length=0,t.osagoParams.vin_is_visible=!1,t.osagoParams.vin_number=""):(t.persons.length=0,b(),t.osagoParams.vin_is_visible=!0),a>e)for(var i=0;a-e>i;i++)h();else t.drivers.length=+a},t.driversCountChangedSimple=function(){var a=t.calculation.driver_set.length,n=t.params.drivers_count;if(t.params.field_was_clicked){if(n>a)for(var r=0;n-a>r;r++)t.calculation.driver_set.push(e.copy(i.defaultCalcDriver));else t.calculation.driver_set.length=+n;t.calculation.is_multidrive=!!n}},t.disabledFormationPolicyButton=function(){var e,a;if(a=["created_at","id","deductible_value","drivers_count","is_new_car"],T){T.car_cost=parseInt(T.car_cost,10)+"",t.calculation.car_cost=parseInt(t.calculation.car_cost,10)+"";for(e in t.calculation)if(t.calculation.hasOwnProperty(e)&&a.indexOf(e)===-1&&!x(t.calculation[e],T[e]))return t.root.isFormationPolicyButtonDisabled=!0,!0}return t.root.isFormationPolicyButtonDisabled=!1,!1},t.resetPerson=function(e){c.resetPerson(e)}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("calculatorC").controller("calculatorCtrl",["$scope","$state","$rootScope","$stateParams","Dictionary","calculatorService","policyOrderingService","calculatorStepsService","CONSTS","$q","$location","Messages","formationPolicyStep1Service","brandingConfigs","addingDocumentsService",function(a,i,n,r,s,l,o,c,d,u,p,m,g,v,f){function h(e,t){var i=_.find(a.calculationResult,function(t){return t.id==e})||null;return l.setSelectedResult(i),a.root.selectedResult=l.getSelectedResult(),i&&l.setResultAsSelected(i),"brokers"==n.currentBrandName&&(a.params.orderButton=!1,t&&(i.show_info_on_last_step=!0)),i}function b(){a.calculationResult.sort(function(e,t){return parseFloat(e.program.sum)>parseFloat(t.program.sum)?1:-1})}function y(){for(var e,t,i=a.calculationResult.length;0!==i;)t=Math.floor(Math.random()*i),i-=1,e=a.calculationResult[i],a.calculationResult[i]=a.calculationResult[t],a.calculationResult[t]=e;return a.calculationResult}var w,x={};a.params=l.calculatorOtherParams,a.sendOrderLetter=o.sendOrderLetter,a.params.orderButton=!1,a.orderPolicy=function(){a.sendOrderLetter(),a.params.orderButton=!0};var k=30829,P=30854;a.calculationResult=[],a.templates={program_list_manager:v.templates.program_list_manager||d.pathToModules+"shared/carFilter/views/program_list.manager.html",policy_info:v.templates.policy_info||d.pathToModules+"shared/carFilter/views/policy_info.html"},a.bigSteps=c.bigSteps,a.postCalculateParams={first:!1,second:!1,third:!1,is_visible:!1,manager__client_phone:"",manager__client_name:"",button_is_disabled:!1},a.toManager=function(){a.calculation.client_phone?a.sendToManager():a.postCalculateParams.third=!0},a.sendToManager=function(){var e=new FormData,t="",i=a.postCalculateParams.manager__client_name||a.calculation.client_name,n=a.postCalculateParams.manager__client_phone||a.calculation.client_phone;a.postCalculateParams.button_is_disabled=!0,t+="Клиент просит ему перезвонить.\n\n",t+="Имя клиента: "+i+"\n",t+="Телефон клиента: "+n+"\n\n",t+="Ссылка на расчет: http://enter.b2bpolis.ru/#/calculator/"+a.calculation.id,e.append("message",t),f.send(e).then(function(){a.postCalculateParams.button_is_disabled=!1,a.postCalculateParams.is_visible=!1,m.success("Ваш запрос принят. Мы свяжемся с вами в ближайшее время.",6e3)},function(){a.postCalculateParams.button_is_disabled=!1,m.error("Не удалось отправить запрос.",6e3)})},s.getItems("contributoryScheme").then(function(e){e=e.results?e.results:e,"ural"===n.currentBrandName&&(a.params.contributoryScheme=_.forEach(e,function(e){19!==e.id&&"Единовременно"!==e.title||(e.title="Нет")})),_.head(n.currentBrand.contributory_schemas)&&(a.params.contributoryScheme=_.map(n.currentBrand.contributory_schemas,function(e){return _.find(a.params.contributoryScheme,function(t){return t.id===e})}))}),a.paymentForm=n.currentBrand.payment_forms,a.getResultWithKbm=function(){var e=_.find(a.calculationResult,function(e){return e.insurance_company.id===k});return e||(e=_.find(a.calculationResult,function(e){return e.insurance_company.id===P})),e},a.setStep=function(e){a.step=e},a.root={messages:[],selectedResult:l.getSelectedResult()},a.calculation=l.calculation;var C=i.params.calculationId||a.calculation&&a.calculation.id;a.disabledSecondStep=!!a.calculation.id,a.calculateType=function(){return n.calcType},a.root.insuranceTypeTitle=function(){return"Калькулятор ОСАГО"},C?(C!=a.calculation.id&&l.resetCalculation(),x.getCalculation=l.getCalculation(C).then(function(){w=e.copy(a.calculation)}),x.getResult=l.getResult(C).then(function(e){return e&&e.length&&e?(a.calculationResult=_.filter(_.forEach(e,l.parseResult),function(e){return parseInt(e.program.sum)&&_.head(e.program.option_set)}),a.postCalculateParams.is_visible=!0,a.params.resultsAreVisible=!0,void("brokers"==n.currentBrandName?y():b())):void a.root.messages.push("Ошибка со стороны страховой компании.")})):l.resetCalculation(),a.selectResult=function(e){var t=h(e);t&&a.bigSteps.setBigStep("fourth")},a.selectResultWithoutNext=function(e){h(e,!0)},a.getSelectedResult=function(){var e=l.getSelectedResult();return a.root.selectedResult=e,e},a.getYearRange=function(e,t){var a,i,n;return a=new Date,e=e||0,t=void 0===t?90:t,n=a.getFullYear()-t,i=a.getFullYear()-e,n+":"+i},a.resetCalculation=function(){a.calculation.id?m.success('Данные по расчету очищены, ваш расчет сохранен в разделе <a href="#/calculator/archive">Расчеты</a>.',7e3):m.success("Данные по расчету очищены.",4e3),l.resetCalculation(),g.resetAll(),a.calculationResult.length=0,p.search("policy",null),p.path("/calculator/"+n.calcType+"/",!1)},a.calculate=function(r){a.prevCalculationResult=e.copy(a.calculationResult),a.calculationResult.length=0,a.selectResult(null),a.calculation.created_by_user=null,l.createCalculation().then(function(s){var o=[],c=0;a.root.messages.length=0,console.log("%c createCalculationSuccess ","color: green"),w=e.copy(a.calculation),i.go(i.current,{calculationId:a.calculation.id},{notify:!1}),l.companiesInProgress.length&&_.forEach(l.companiesInProgress,function(e){var t=l.createResult(e.id).then(function(e){_.forEach(e,function(e){_.isFunction(n.currentBrand.resultParser)&&n.currentBrand.resultParser(e),e.is_default&&parseInt(e.program.sum)&&(a.calculationResult.push(l.parseResult(e)),"brokers"==n.currentBrandName?y():b(),c++,c>=5&&(a.params.recalculateButtonIsDisabled=!1))}),a.postCalculateParams.is_visible=!0});o.push(t)}),"function"==typeof r&&r(s),u.all(o).then(function(e){var i,n=_.flatten(e);return console.log("%c createResultSuccess ","color: green"),a.params.resultsAreCreated=!0,a.params.recalculateButtonIsDisabled=!1,n&&n.length?(i=t(".js-kasko-result").offset(),void(i&&jQueryApp("html,body").animate({scrollTop:i.top},"fast"))):(a.root.messages.push("Ошибка на стороне сервера."),void(a.params.isCalculationProgress=!1))},function(e){console.log("%c createResultError: ","color: red"),console.warn(e)}).then(function(e){a.params.recalculateButtonIsDisabled=!1,a.params.isCalculationProgress=!1})},function(e){console.log("%c createCalculationError: ","color: red"),console.warn(e),a.root.messages.push("Не удалось создать расчет. Пожалуйста, попробуйте позже."),a.params.isCalculationProgress=!1})}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("calculatorC").service("calculatorService",["$http","$q","CONSTS","$rootScope","resources","calculator","$filter","requester",function(a,i,n,r,s,l,o,c){function d(e){var a=t(".ui-datepicker-year").val();return(e=new Date(e))?(e.setFullYear(a),o("date")(e,"yyyy-MM-dd")):""}var u=l.getDefaults(),p=function(e){return e=e||new Date,o("date")(e,"yyyy-MM-dd")},m={full_year:null,field_was_clicked:!1,drivers_count:1,drivers_count_full:1,signalization_type:"",show_empty_fields:!1,resultsAreCreated:!1,deductible_value:0,contributory_scheme:19,payment_form:107,recalculateButtonIsDisabled:!1,isCalculationProgress:!1,resultsAreVisible:!r.currentBrand.with_sms,multidriveForm:{birth_date:null,driving_experience_started:null}};this.parseResult=function(e){return e.company_logo="http://enter.b2bpolis.ru/"+e.insurance_company.logo,e},this.currentResult=null,this.getOtherCompanies=function(){return[{id:41243,title:"Росгосстрах",insurance_company:{logo:"media/logo_main_ins/Logo_24.png"}},{id:41465,title:"Ренессанс",insurance_company:{logo:"media/logo_main_ins/Logo_47.png"}}]},this.calculation=e.copy(u),this.companiesInProgress=[],this.getDefaultCalculation=function(){return u},this.selectedResult=null,this.setSelectedResult=function(e){this.selectedResult=e},this.getSelectedResult=function(){return this.selectedResult},this.calculationFormIsValid=_.noop,this._promises={},this.getPromises=function(){return this._promises},this.calculatorOtherParams=e.copy(m),this.resetCalculation=function(t){var a=e.copy(this.getDefaultCalculation());this.companiesInProgress.length=0,t=t||r.calcType;for(var i in this.calculation)this.calculation.hasOwnProperty(i)&&delete this.calculation[i];for(var n in a)a.hasOwnProperty(n)&&(this.calculation[n]=a[n]);for(var s in this.calculatorOtherParams)this.calculatorOtherParams.hasOwnProperty(s)&&(this.calculatorOtherParams[s]=m[s]);return this["to_defaults_"+t]&&this["to_defaults_"+t](),this},this.to_defaults_osago=function(){var t=new Date;t.setDate(t.getDate()+1),this.calculation.insurance_duration=82,this.calculation.driver_set=[e.copy(this.defaultCalcDriver)],this.calculation.car_type=1,this.calculation.drivers_count=1,this.calculation.calculation_at_date=p(t)},this.to_defaults_kasko=function(){var t=new Date;t.setDate(t.getDate()+1),this.calculation.insurance_duration=82,this.calculation.driver_set=[e.copy(this.defaultCalcDriver)],this.calculation.car_type=1,this.calculation.drivers_count=1,this.calculation.calculation_at_date=p(t),this.calculation.deductible_currency=23},this.defaultCalcDriver={is_married:!1,gender:"M",expirience:null,age:null,has_children:!1},this.createCalculation=function(t){return t=t||this.calculation,this.companiesInProgress.length=0,t=this.correctCalculation(t),delete t.token,c.post(s.calculation+"?token",t).then(function(t){var a,i=t.data,n=["driver_set"];this.calculationToken=i.token,this.companiesInProgress=i.available_insurance_departments,delete i.available_insurance_departments;for(a in i)i.hasOwnProperty(a)&&n.indexOf(a)===-1&&(e.equals(this.calculation[a],i[a])||(this.calculation[a]=i[a]));return t.data}.bind(this))},this.getCalculation=function(e){return e=e||this.calculation.id,e==this.calculation.id?i.when(this.calculation):(this._promises.getCalculation=c.get(s.calculation+e+"/").then(function(e){var t;e=e.data;for(t in e)"user"!==t&&(this.calculation[t]=e[t]);return this.calculation}.bind(this)),this._promises.getCalculation)},this.getResult=function(e){return e=e||this.calculation.id,c.get(s.calculationV3+e+"/result/?insurance_company=1&messages=1&variables=1&options=1").then(function(e){return this.companiesInProgress=e.data,this.currentResult=e.data,e.data}.bind(this))},this.createResult=function(e,t){var i=this.calculationToken;return t=t||this.calculation.id,a({url:"http://enter.b2bpolis.ru"+s.calculationV3+t+"/result/"+e+"/?insurance_company=1&messages=1&variables=1&options=1",method:"POST",headers:{"X-Calculation-Token":i}}).then(function(e){return this.companiesInProgress=e.data,this.currentResult=e.data,e.data}.bind(this))},this.setResultAsSelected=function(t,i){var n=this.calculationToken;return i=i||this.calculation.id,a({url:"http://enter.b2bpolis.ru"+s.calculationV3+i+"/result/"+t.insurance_company.version+"/?insurance_company=1&messages=1&variables=1&options=1",method:"PUT",headers:{"X-Calculation-Token":n},data:e.extend({},t,{is_selected:!0,is_default:!0})}).then(function(e){return e.data})},this.getCredentialList=function(e){return a.get(n.urlPrefixDefault+"client/natural-person/"+e+"/credential").then(function(e){return e.data})},this.getAddressList=function(e){return a.get(n.urlPrefixDefault+"client/natural-person/"+e+"/address").then(function(e){return e.data})},this.correctCalculation=function(e){return e=e||this.calculation},this.personDateChanged=function(e,t,a){t=t||"birth_date",t.indexOf(".")!==-1?(t=t.split("."),e[t[0]][t[1]]=d(e[t])):e[t]=d(e[t])},this.validateDrivers=function(){var e,t,a=this.calculation.driver_set.length;if(this.calculation.is_multidrive,0===a)return!0;for(e=0;e<a;e++)if(t=this.calculation.driver_set[e],t.age-t.expirience<17)return!1;return!0}}])}(angular,jQueryApp),function(e){e.module("formationPolicyC",[])}(angular),function(e){"use strict";e.module("formationPolicyC").service("formationPolicyService",["$http","CONSTS","$q","$rootScope","$filter","resources","requester",function(t,a,i,n,r,s,l){function o(){return null}function c(e){return e=e||new Date,r("date")(e,"yyyy-MM-dd")}function d(e){var t;return t="legal_person"===e.personType?["title","title_eng","id","inn","ogrn","kpp","representative_first_name","representative_last_name","representative_patronymic","representative_post","representative_credential_type","representative_number","representative_issue_date"]:["id","first_name","last_name","patronymic","first_name_eng","last_name_eng","patronymic_eng","birth_date","gender","driving_experience_started","is_individual_entrepreneur","is_foreigner"],_.pick(e,t)}var u={object:{credential:[{issue_date:"2016-02-04",creator:10585,series:"3456",number:"45",object_id:1751,issue_point:"",credential_type:10,content_type:480,expiration_date:null,external_id:"9374",id:5449}],keys_count:2,manufacturing_date:"2015-01-01",engine_power:"200.00",car_modification:null,creator:10585,car_model:7687,engine_displacement:"2.00",car_body_number:null,mileage:null,number_plate:"",car_mark:303,vin_number:"55TTEEE5E5R5R6TT7",external_id:"7628",id:1751,cost:null},object_type:"car",person:[]},p=null,m=null,g={clear:function(){m=null},resetCurrentPolicy:function(){p=null},updateCustomer:function(e){var a=i.defer(),n=o();return this.getCustomer(n).then(function(i){i.natural_persons=i.natural_persons.concat(e.natural_persons),i.natural_persons=_.uniq(i.natural_persons),t.put(s.customer+"/"+n,i).then(function(e){a.resolve(e.data)},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},getCustomer:function(e){return e=e||o(),t.get(s.customer+"/"+e).then(function(e){return e.data})},getCustomerCars:function(e){return e=e||o(),t.get(s.customerCar,{params:{owner:e}}).then(function(e){return e.data})},getCarCredential:function(e){return t.get(s.customerCar+"/"+e+"/credential").then(function(e){return e.data})},getCustomerFull:function(e){var a=i.defer();return this.getCustomer(e).then(function(e){t.get(s.person+"/"+e.person).then(function(i){var n=i.data,r="naturalPerson",l=n.natural_person;n.legal_person&&(r="legalPerson",l=n.legal_person),t.get(s[r]+"/"+l).then(function(t){var i=t.data;a.resolve({person:i,drivers:e.natural_persons})},function(e){a.reject(e)})},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},saveCar:function(a){var n=o(),r=i.defer(),l=_.pick(a,["id","mileage","car_mark","car_model","car_modification","owner","manufacturing_date","vin_number","number_plate","engine_displacement","engine_power","cost","keys_count"]),c="post",d=s.customerCar;return l.owner=l.owner||n,l.id&&(c="put",d+="/"+l.id),t[c](d,l).then(function(n){var l=n.data,o=_.map(a.credential,function(e){return _.pick(e,["id","number","series","credential_type","issue_date","issue_point","expiration_date"])}),c=[];e.forEach(o,function(e){var a="post",i=s.customerCar+"/"+l.id+"/credential";e.id&&(a="put",i+="/"+e.id),c.push(t[a](i,e).then(function(e){return e.data}))}),i.all(c).then(function(e){r.resolve({car:l,credential:e})},function(e){r.reject(e)})},function(e){r.reject(e)}),r.promise},createDeal:function(a){var n=i.defer();return t.post(s.deal,e.extend({deal_status:1,customer:o()},a)).then(function(e){var i=e.data;i.car=a.car,t.put(s.deal+"/"+i.id,i).then(function(e){n.resolve(e.data)},function(e){n.reject(e)})},function(e){n.reject(e)}),n.promise},getDeal:function(e){return t.get(s.deal+"/"+e)},createInsuranceProduct:function(e,a){return t.post(s.deal+"/"+e+"/insurance-product/from-calculation",a).then(function(e){return e.data})},updateInsuranceProduct:function(e,a,i){return t.put(s.deal+"/"+e+"/insurance-product/"+a,i).then(function(e){return e.data})},createInvoice:function(e,a){return t.post(s.deal+"/"+e+"/insurance-product/"+a+"/invoice/generate").then(function(e){return e.data})},createPersonContainer:function(e,a){var i={};return a="legal_person"===a?"legal_person":"natural_person",i[a]=e,t.post(s.person,i).then(function(e){return e.data})},saveBSO:function(e,a){return t.post(s.resultPolicy+"/"+e+"/enter_bso/",a).then(function(e){return e.data})},createInsuredObjectByIds:function(e){return t.post("/rest/default/client/insured-object",e).then(function(e){return e.data})},createInsuredObjectOsago:function(t){var a={object:{car_mark:t.car.car_mark,car_model:t.car.car_model,car_model_group:t.car.car_model_group||null,car_modification:t.car.car_modification||null,cost:+t.car.cost,engine_displacement:t.car.engine_displacement,engine_power:t.car.engine_power,credential:t.car.credential,external_id:t.car.id||this.generateId(),vin_number:t.car.vin_number,number_plate:t.car.number_plate,manufacturing_date:t.car.manufacturing_date,keys_count:t.car.keys_count,mileage:t.car.mileage,car_body_number:t.car.car_body_number,engine_power_kilowatt:t.car.engine_power_kilowatt,chassis_number:t.car.chassis_number},object_type:"car",person:[],drivers:[]};return e.forEach(a.object.credential,function(e){e.external_id=e.id||this.generateId()},this),e.forEach(t.persons,function(t,i){var n,r,s={},l=[],o=t.id||this.generateId(),u=t.address_registration?[t.address_registration]:[],p=d(t),m=t.personType;u&&u.lendth&&(u[0].address_type=1),"natural_person"===m?(r=t.credential,e.forEach(r,function(e){e&&(e.issue_date=c(e.issue_date),e.external_id=e.id||this.generateId())},this),!t.is_same_address&&t.address_residential&&(u.push(t.address_residential),u[1].content_type=482,u[1].address_type=2),t.birth_date=c(t.birth_date),t.driving_experience_started=c(t.driving_experience_started)):r=null,
e.forEach(["owner","insurant"],function(e){var a="is"+e[0].toUpperCase()+e.substr(1);t[a]&&l.push(e)}),l.length>0&&(s.role=l,s.external_id=o,s.id=t.person_id,s[m]=p,s[m].external_id=o,s[m].credential=r,s[m].address=u,a.person.push(s)),t.isDriver&&(n=e.copy(p),n.external_id=o,n.credential=[],n.credential.push(_.find(r,function(e){return 3===e.credential_type})),n.credential.push(_.find(r,function(e){return 1===e.credential_type})),n.credential[1]||(n.credential.length=1),a.drivers.push(n))},this),l.post(s.insuredObjectOsago,a).then(function(t){return m=e.copy(t.data),t.data})},sendPhone:function(e){return t.post("/policy/rest/result_policy/"+e.policy_id+"/token",_.pick(e,"phone")).then(function(e){return e.data})},confirmPhone:function(e){return t.post("/policy/rest/result_policy/"+e.policy_id+"/token-verified",_.pick(e,"token")).then(function(e){return e.data})},toPay:function(e){return t.post("/payment/"+e+"/ ").then(function(e){return e.data})},createInsuredObject:function(t){var a,i;return t.car?(a={object:{car_mark:t.car.car_mark,car_model:t.car.car_model,car_model_group:t.car.car_model_group||null,car_modification:t.car.car_modification||null,cost:t.car.cost,engine_displacement:t.car.engine_displacement,engine_power:t.car.engine_power,credential:t.car.credential,external_id:t.car.id||this.generateId(),vin_number:t.car.vin_number,number_plate:t.car.number_plate,manufacturing_date:t.car.manufacturing_date,keys_count:t.car.keys_count,mileage:t.car.mileage,is_new_car:t.car.is_new_car,is_temporary:t.car.is_temporary,chassis_number:t.car.chassis_number},object_type:"car",person:[],drivers:[]},i=["owner","insurant","beneficiary"],e.forEach(a.object.credential,function(e){e.external_id=e.id||this.generateId()},this)):(a=u,i=["owner","insurant"]),e.forEach(t.persons,function(t,n){var r,s,l={},o=[],u=t.id||this.generateId(),p=[t.address_registration],m=_.filter(t.contact,function(e){return e.data}),g=d(t),v=t.personType;"legal_person"===v?s=null:(s=t.credential,e.forEach(s,function(e){e.issue_date=c(e.issue_date),e.external_id=e.id||this.generateId()},this),t.is_same_address||p.push(t.address_residential),t.is_temporary_registration&&p.push(t.address_temporary_registration),t.birth_date=c(new Date(t.birth_date)),t.driving_experience_started=t.driving_experience_started?c(new Date(t.driving_experience_started)):null),e.forEach(i,function(e){var a="is"+e[0].toUpperCase()+e.substr(1);t[a]&&o.push(e)}),e.forEach(p,function(e){e&&!e.country&&(e.country="Россия")}),o.length>0&&(l.role=o,l.external_id=u,l.id=t.person_id,l[v]=g,l[v].external_id=u,l[v].contact=m,l[v].credential=s,l[v].address=p,a.person.push(l)),t.isDriver&&(r=e.copy(g),r.external_id=u,r.address=p,r.credential=_.filter(s,function(e){return 3===e.credential_type}),a.drivers.push(r))},this),l.post(s.insuredObject,a).then(function(t){return m=e.copy(t.data),t.data})},getInsuredObject:function(t){return l.get(s.insuredObject+"/"+t).then(function(t){return m=e.copy(t.data),t.data})},getInsuredObjectOsago:function(t){return l.get(s.insuredObjectOsago+"/"+t).then(function(t){return m=e.copy(t.data),t.data})},getPolicyFile:function(e,a){return a=a?"?type="+a:"",t({method:"GET",url:s.resultPolicy+e+"/template/"+a,headers:{}}).then(function(e){return e.data})},createInsuredObjectCRM:function(e){return t.post(s.insuredObjectCRM,e).then(function(e){return e.data})},createPolicy:function(a){return t.post(s.resultPolicy,e.extend({external_id:o()},a)).then(function(e){return p=e.data})},savePolicy:function(a){var i="post",n=s.resultPolicy;return a.id&&(i="put",n=s.resultPolicy+a.id+"/"),t[i](n,e.extend({external_id:o()},a)).then(function(e){return p=e.data})},getPolicy:function(e){return t.get(s.resultPolicy+e+"/",{params:{external_id:o()}}).then(function(e){return p=e.data})},getSavedNaturalPersons:function(e){return t.get(s.savedNaturalPersons,{params:e}).then(function(e){return e.data})},getSavedLegalPersons:function(e){return t.get(s.savedLegalPersons,{params:e}).then(function(e){return e.data})},getSavedCars:function(e){return t.get(s.savedCars,{params:e}).then(function(e){return e.data})},getInsObjList:function(e){return t.get(s.insuredObectList,{params:e}).then(function(e){return console.log(e),e.data})},getCurrentPolicy:function(){return p},getCurrentInsuredObject:function(){return m},sendNotification:function(e){return t.post(s.notificationSend,e).then(function(e){return e.data})},generateId:function(){return~~(9900*Math.random()+100)},getPolicyActionsParameters:function(e){return t.get(s.resultPolicy+e+"/actions_parameters/",{params:{external_id:o()}}).then(function(e){return e.data})},executePolicyAction:function(e,i,n){return t.post(a.urlPrefixPolicy+"result_policy/"+e+"/"+i+"/",n).then(function(e){return e.data})},getPolicyDocsArchive:function(e){return t.get(a.urlPrefixPolicy+"result_policy/"+e+"/zip/").then(function(e){return e.data})},getPolicyAttachments:function(e){return t.get(s.resultPolicy+e+"/attachment/").then(function(e){return e.data})},deletePolicyAttachment:function(e,a){return t.delete(s.resultPolicy+e+"/attachment/"+a).then(function(e){return e.data})},issueToSavedPolicy:function(e){return t.post(s.resultPolicy+e+"/issue_to_saved_policy/").then(function(e){return e})},setPersonValidationDates:function(e){e.isDriver?(e.birthDateRange={min:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.age-1),c(t)}(),max:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.age),c(t)}()},e.expirienceRange={min:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.expirience-1),c(t)}(),max:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.expirience),c(t)}()}):(e.birthDateRange={min:function(){var e=new Date;return e.setFullYear(e.getFullYear()-90),c(e)}(),max:function(){var e=new Date;return e.setFullYear(e.getFullYear()-18),c(e)}()},e.expirienceRange={min:function(){var e=new Date;return e.setFullYear(e.getFullYear()-72),c(e)}(),max:function(){return c(new Date)}()}),e.birthDateRange.yearRange=new Date(e.birthDateRange.min).getFullYear()+":"+new Date(e.birthDateRange.max).getFullYear(),e.expirienceRange.yearRange=new Date(e.expirienceRange.min).getFullYear()+":"+new Date(e.expirienceRange.max).getFullYear(),e.dateChanged=function(t,a){var i=new Date(t).getFullYear(),n=new Date(a).getFullYear();e.invalidDates=i-n>=18}}};return g}])}(angular),function(e,t){"use strict";e.module("formationPolicyC").service("formationPolicyStep1Service",["$filter","$rootScope","formationPolicyService","Person","calculatorService","$q",function(t,a,i,n,r,s){function l(){return P=e.copy(A)}function o(t,a){a=a||P;var i=_.filter(t,function(e){return e.credential_type===j.credential_type}),n=_.filter(t,function(e){return e.credential_type===M.credential_type});a.vehicle_registration=_.maxBy(i,function(e){return e.id})||e.copy(j),a.vehicle_certificate=_.maxBy(n,function(e){return e.id})||e.copy(M)}function c(t){if(_.head(t.credential)&&"natural_person"===t.personType){var a=_.filter(t.credential,function(e){return e.credential_type==O.credential_type}),i=_.filter(t.credential,function(e){return e.credential_type==$.credential_type});t.driver_license=_.maxBy(a,function(e){return e.id}),t.passport=_.maxBy(i,function(e){return e.id})||e.copy($)}return t}function d(t){return e.isArray(t.contact)&&t.contact.length>0&&(t.contact=_.sortBy(_.uniqBy(t.contact,function(e){return e.contact_type}),function(e){return e.contact_type})),t}function u(e){var t=new Date,a=new Date(e);if(a.getTime())return new Date(t-a).getFullYear()-1970}function p(e){e.full=e.city+", "+e.street+", д."+e.house}function m(t){if(e.isArray(t.address)&&t.address.length>0){var a=_.filter(t.address,function(e){return 1===e.address_type});a=_.maxBy(a,function(e){return e.id});var i=_.filter(t.address,function(e){return 2===e.address_type});i=_.maxBy(i,function(e){return e.id});var n=_.filter(t.address,function(e){return 3===e.address_type});n=_.maxBy(n,function(e){return e.id}),t.is_same_address=!i,t.is_temporary_registration=Boolean(n),a&&(t.address_registration=a,p(a)),i&&(t.address_residential=i,p(i)),n&&(t.address_temporary_registration=n,p(n))}return t}function g(e,t){return t=t||a.calcType,N[t](e,P)}function v(e){return e=e||a.calcType,B[e]()}function f(e,t,i,n){return n=n||a.calcType,R[n](e,t,i)}function h(e,t){return t=t||a.calcType,E[t](e,t)}function b(e){return V.allTypes(e)}function y(e){return e=e||a.calcType,q[e]()}function w(e){return U.allTypes(e)}function x(){C.length=0,l()}function k(e){return e=e||a.calcType,L[e](e)}var P,C=[],S=r.calculation,I="yyyy-MM-dd",D=function(e){return t("date")(e,I)},T={address_type:1,postal_index:null,content_type:482,country:"Россия",city:"",street:"",house:"",housing:"",flat:"",kladr:""},$={credential_type:1,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},O={credential_type:3,series:"",number:"",issue_date:"",issue_point:"РФ",expiration_date:""},j={credential_type:4,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},M={credential_type:7,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},F={is_same_address:!0,person_type:"natural_person",credential:[],isOwner:!1,isDriver:!1,isInsurant:!1,first_name:"",last_name:"",patronymic:"",gender:null,birth_date:"",passport:e.copy($),address_registration:e.copy(T),address_residential:e.extend(e.copy(T),{address_type:2})},A={car_mark:null,car_model:null,car_modification:null,cost:0,vin_number:"",chassis_number:"",number_plate:"",engine_displacement:"",engine_power:"",engine_power_kilowatt:"",keys_count:S.driver_set.length||1,mileage:"",manufacturing_date:null,selectedCar:"",vehicle_registration:e.copy(j),vehicle_certificate:e.copy(M),document_issue_date:"",mode:"edit"};l();var R={osago:function(t,a,r){var s,l=new Date,o=18,c=new n(e.extend(e.copy(F),{personType:a||"natural_person",isOwner:!1,isInsurant:!1,isDriver:!1,selectedPerson:"",mode:"edit"}));return t=t||{},"legal_person"===a?(c.extend({title:"",isDriver:!1,inn:"",ogrn:""}),c.address_registration=c.addAddress(e.copy(T))):(s=t.expirience||0===t.expirience?t.expirience:null,null===s&&(s=u(t.driving_experience_started)),c.extend({age:t.age||o,expirience:s,gender:"M",birth_date:t.birth_date||"",is_same_address:!0,is_temporary_registration:!1,driving_experience_started:t.driving_experience_started||""}),c.passport=c.addCredential(e.copy($)),c.driver_license=c.addCredential(e.copy(O)),c.address_registration=c.addAddress(e.copy(T)),c.address_residential=c.addAddress(e.copy(T)),c.address_temporary_registration=c.addAddress(e.copy(T)),c.driving_experience_started||(l=new Date,l.setFullYear(l.getFullYear()-c.expirience),c.driver_license.issue_date=D(l),c.driving_experience_started=D(l))),c.extend(t),i.setPersonValidationDates(c),c.hasRole=function(){return c.isInsurant||c.isOwner},r||C.push(c),c}},B={osago:function(){function t(){return S.id||(S.insured_object=11920),S.insured_object?i.getInsuredObject(S.insured_object):s.when({})}return t().then(function(t){t&&t.id?g(t):_.forEach(S.driver_set,function(t){var a={isDriver:!0,showFioFields:!0};f(e.extend(a,t))}),e.extend(P,{car_mark:S.car_mark,car_model:S.car_model,car_modification:S.car_modification,cost:Math.floor(S.car_cost),car_body_number:"",vin_number:null,number_plate:"",engine_displacement:null,engine_power:S.engine_power,mileage:null,manufacturing_date:S.car_manufacturing_year+"-01-01",vehicle_registration:e.copy(j),vehicle_certificate:e.copy(M),credential:[]}),e.extend(P,t.object),P.id=null;var i=_.head(C);if(S.is_legal_entity&&"false"!==S.is_legal_entity&&(i.address_registration=e.copy(T)),S.is_legal_entity&&a.currentUser){i.isInsurant=!1;var n=f({isInsurant:!0,isOwner:!1,isDriver:!1,title:a.currentUser.last_name,inn:a.currentUser.inn,ogrn:a.currentUser.ogrn},"legal_person");a.currentUser.address&&(e.extend(n.address_registration,a.currentUser.address),p(n.address_registration))}else i&&a.currentUser&&a.currentUser.id&&(i.passport&&!i.passport.series&&(i.passport.series=a.currentUser.passport_series,i.passport.number=a.currentUser.passport_number),i.address_registration&&!i.address_registration.city&&a.currentUser.address&&(e.extend(i.address_registration,a.currentUser.address),p(i.address_registration))),i.isInsurant=!0;i.isOwner=!0})}},N={osago:function(a){var i;C.length=0,P=a.object,o(P.credential),P.engine_power_kilowatt=+(.7355*S.engine_power).toFixed(2),P.engine_power=S.engine_power,_.forEach(a.person,function(e){var a=e.natural_person?"natural_person":"legal_person";e[a].personType=a,e[a].person=e.id,c(e[a]),m(e[a]),e[a].selectedPerson=e[a].external_id,"natural_person"===a&&(e[a].age=t("calcAge")(e[a].birth_date)),e.role.length&&_.forEach(e.role,function(t){e[a]["is"+t[0].toUpperCase()+t.substr(1)]=!0}),f(e[a])}),i=_.forEach(a.drivers,function(e){e.personType="natural_person",e.isDriver=!0,c(e),m(e)}),_.forEach(i,function(t){var a;_.forEach(C,function(i,n){t.external_id===i.external_id&&(a=!0,e.extend(i,t),i.isDriver=!0)}),t.driver_license=_.find(t.credential,function(e){return 3===e.credential_type})||e.copy(O),a||f(t)})}},E={osago:function(e){var t=C.indexOf(e),a=t-1>=0?t-1:t+1;e.isOwner&&(C[a].isOwner=!0),e.isInsurant&&(C[a].isInsurant=!0),t!==-1&&C.splice(t,1)}},q={osago:function(){e.forEach(C,function(e){e.address=[],e.credential=[],e.birth_date=D(e.birth_date),"natural_person"===e.personType&&((e.isInsurant||e.isOwner)&&(e.passport.credential_type=1,e.credential.push(e.passport)),e.isDriver&&(e.driver_license&&e.credential.push(e.driver_license),e.driving_experience_started=D(e.driving_experience_started)))});var t=_.find(C,function(e){return e.isOwner}),a=_.find(C,function(e){return e.isInsurant}),n=_.map(_.filter(C,function(e){return e.isDriver}),"id"),r={owner:t.person,beneficiary:t.person,insurant:a.person,drivers:n,object_type:"car",object_id:P.id};return P.credential=[],P.vehicle_registration&&P.credential.push(P.vehicle_registration),P.vehicle_certificate&&P.credential.push(P.vehicle_certificate),i.createInsuredObjectByIds(r)}},U={allTypes:function(t){return function(a){return e.isObject(a)&&(b(t),t.extend(a),t.getCredentialList().then(function(){c(t)}),t.getAddressList().then(function(){m(t)}),t.getContactList().then(function(){d(t)})),!0}}},V={allTypes:function(t){return e.extend(t,{id:null,age:t.selectedPerson?18:t.age,birth_date:"",last_name:"",first_name:"",patronymic:"",last_name_eng:"",first_name_eng:"",patronymic_eng:"",is_same_address:!0,driving_experience_started:"",selectedPerson:"",document:{credential_type:1,series:"Не указан",number:"",issue_date:""},title:"",title_eng:"",inn:"",ogrn:"",kpp:"",representative_first_name:"",representative_last_name:"",representative_patronymic:"",representative_post:"",representative_credential_type:"",representative_number:"",representative_issue_date:"",rsa_check_id:null,person:null,is_verified:null,is_current_user:!1}),t.pT=t.pT||t.personType,t.passport=t.addCredential(e.copy($)),t.ogrntip=t.addCredential(e.copy($)),t.driver_license=t.addCredential(e.copy(O)),t.address_registration=t.addAddress(e.copy(T)),t.address_residential=t.addAddress(e.copy(T)),t.address_temporary_registration=t.addAddress(e.copy(T)),t.contact=[{contact_type:1,data:""},{contact_type:2,data:""}],t.address_registration.country=null,t.address_residential.country=null,t.address_temporary_registration.country=null,t.credential.length=0,t.address.length=0,t.contact.length=0,t}},L={osago:function(){var e={isInsurant:!1,isOwner:!1,all:!1};return _.forEach(C,function(t){t.isInsurant&&(e.isInsurant=!0),t.isOwner&&(e.isOwner=!0)}),e.all=e.isInsurant&&e.isOwner,e}};return{addPerson:f,resetPerson:b,initFromCalculation:v,initFromInsuredObject:g,removePerson:h,persons:C,getPersons:function(){return C},createInsuredObject:y,resetAll:x,showSavedPersonsCallback:w,resetCar:l,getCar:function(){return P},setCarCredentials:o,getDefaultObject:function(t){var a={defaultAddressObject:T,defaultPassportObject:$,defaultDriverLicenseObject:O,defaultVehicleRegistrationObject:j};return e.copy(a[t])},setPersonCredential:c,setPersonAddress:m,setFullAddress:p,personCheckUsed:k}}])}(angular,jQueryApp),function(e){e.module("brandingC",[])}(angular),function(e){"use strict";e.module("brandingC").service("brandingService",["CONSTS","$stateParams","brandingConfigs",function(t,a,i){var n={},r={};return n[t.currentBrand]=e.extend(r,i),n}])}(angular),function(e){e.module("AddingDocumentsC",[])}(angular),function(e){"use strict";e.module("AddingDocumentsC").service("addingDocumentsService",["$q","CONSTS",function(e,t){function a(){var e;try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){e=!1}}return e||"undefined"==typeof XMLHttpRequest||(e=new XMLHttpRequest),e}this.send=function(i,n){var r,s=e.defer();return r=a(),r.open("POST",t.proxyPathC+"mail.php",!0),r.onreadystatechange=function(){4==r.readyState&&(200==r.status?s.resolve(r.responseText):s.reject(n?n(r.responseText):r.responseText))},r.send(i),s.promise},this.uploader=null}])}(angular),function(e){e.module("calculatorStepsC",[])}(angular),function(e){e.module("calculatorO",[])}(angular),function(e){"use strict";e.module("calculatorO").controller("calculatorCascoCtrl",["$state",function(e){}])}(angular),function(e,t){"use strict";e.module("calculatorO").controller("calculatorCtrl",["$scope","$state","$rootScope","$stateParams","Dictionary","calculatorService","CONSTS","$q","$location","Messages","formationPolicyStep1Service","calculatorStepsService","brandingConfigs",function(a,i,n,r,s,l,o,c,d,u,p,m,g){var v,f={},h=30829,b=30854;a.calculationResult=[],a.params=l.calculatorOtherParams,a.templates={navigation:g.templates.navigation||o.pathToModules+"shared/calculator/views/navigation.html"},a.getResultWithKbm=function(){var e=_.find(a.calculationResult,function(e){return e.insurance_company.id===h});return e&&e.variables.KBM&&e.variables.KBM.length&&e.variables.kbm||(e=_.find(a.calculationResult,function(e){return e.insurance_company.id===b}),e||(e=_.find(a.calculationResult,function(e){return 30849===e.insurance_company.id}))),e},a.bigSteps=m.bigSteps,a.setSumWithOtherKbm=function(e){var t,i=a.getResultWithKbm(),n=e.variables.S_orig||e.program.sum,r=0;return!i||!i.variables||e.variables.KBM&&e.variables.KBM.length||i.variables.kbm?n:(e.variables.S_orig&&(r=e.program.sum-e.variables.S_orig),i.variables?(t=_.isArray(i.variables.KBM)?_.max(i.variables.KBM):_.isArray(i.variables.KBM_WITH_DOCUMENT)?_.maxBy(i.variables.KBM_WITH_DOCUMENT,function(e){return+e.kbm}):i.variables.kbm?i.variables.kbm:1,n*t+r):void 0)},a.setStep=function(e){a.step=e},a.root={messages:[],selectedResult:l.getSelectedResult()},a.calculation=l.calculation;var y=i.params.calculationId||a.calculation&&a.calculation.id;a.disabledSecondStep=!!a.calculation.id,a.calculateType=function(){return n.calcType},a.root.insuranceTypeTitle=function(){return"Калькулятор ОСАГО"},a.getCurrentCalcType=function(){return m.getCurrentCalcType()},y?(y!=a.calculation.id&&l.resetCalculation(),f.getCalculation=l.getCalculation(y).then(function(){v=e.copy(a.calculation)}),f.getResult=l.getResult(y).then(function(e){return e&&e.length&&e?void(a.calculationResult=_.forEach(e,l.parseResult)):void a.root.messages.push("Ошибка со стороны страховой компании.")})):l.resetCalculation(),a.selectResult=function(e){var t=_.find(a.calculationResult,function(t){return t.id==e});t=t||null,l.setSelectedResult(t),a.root.selectedResult=l.getSelectedResult()},a.getYearRange=function(e,t){var a,i,n;return a=new Date,e=e||0,t=void 0===t?90:t,n=a.getFullYear()-t,i=a.getFullYear()-e,n+":"+i},a.resetCalculation=function(){a.calculation.id?u.success('Данные по расчету очищены, ваш расчет сохранен в разделе <a href="#/calculator/archive">Расчеты</a>.',7e3):u.success("Данные по расчету очищены.",4e3),l.resetCalculation(),p.resetAll(),a.calculationResult.length=0,d.search("policy",null),d.path("/calculator/"+n.calcType+"/",!1)},a.calculate=function(n){a.prevCalculationResult=e.copy(a.calculationResult),a.calculationResult.length=0,a.selectResult(null),a.calculation.created_by_user=null,l.createCalculation().then(function(r){var s=[];a.root.messages.length=0,console.log("%c createCalculationSuccess ","color: green"),v=e.copy(a.calculation),i.go(i.current,{calculationId:a.calculation.id},{notify:!1}),l.companiesInProgress.length&&_.forEach(l.companiesInProgress,function(e){s.push(l.createResult(e.id).then(function(e){e=_.head(e),parseInt(e.program.sum)&&a.calculationResult.push(l.parseResult(e))}))}),"function"==typeof n&&n(r),c.all(s).then(function(e){var i,n=_.flatten(e);return console.log("%c createResultSuccess ","color: green"),a.params.resultsAreCreated=!0,n&&n.length?(i=t(".js-kasko-result").offset(),void(i&&jQueryApp("html,body").animate({scrollTop:i.top},"fast"))):(a.root.messages.push("Ошибка на стороне сервера."),void(a.params.isCalculationProgress=!1))},function(e){console.log("%c createResultError: ","color: red"),console.warn(e)}).then(function(e){a.params.isCalculationProgress=!1})},function(e){console.log("%c createCalculationError: ","color: red"),console.warn(e),a.root.messages.push("Не удалось создать расчет. Пожалуйста, попробуйте позже."),a.params.isCalculationProgress=!1})}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("calculatorO").controller("calculatorOsagoCtrl",["$scope","calculatorService","CONSTS","$stateParams","Dictionary","$filter","formationPolicyService","formationPolicyStep1Service","$rootScope","ngDialog","Person","calculatorStepsService",function(t,a,i,n,r,s,l,o,c,d,u,p){function m(a){P=a.insurance_type,D=e.copy(a),t.params.drivers_count=a.driver_set.length,t.params.drivers_count_full=a.driver_set.length,a.insured_object?y(a.insured_object):g()}function g(){v()}function v(a){var i=e.copy(T);i.driver_license=o.getDefaultObject("defaultDriverLicenseObject");var n=new u(e.extend({},i,a));t.drivers.push(n)}function f(a){var i=new u(e.extend({},$,a));t.persons.push(i)}function h(){return(t.calculation.engine_power>9&&t.calculation.engine_power<=999||!t.calculation.engine_power)&&t.calculation.car_mark&&t.calculation.car_model&&t.calculation.car_manufacturing_year}function b(t,a){return e.isObject(t)?e.equals(t,a):null===t||null===a?Boolean(t)==Boolean(a):t==a}function y(t){return l.getInsuredObject(t).then(function(t){return S=e.copy(t),w(t)})}function w(a){var i=e.copy(a.person);return t.persons.length=0,t.drivers.length=0,a.object.vin_number?(t.osagoParams.vin_number=a.object.vin_number,t.osagoParams.vin_is_visible=!0):t.osagoParams.vin_is_visible=!1,e.forEach(i,function(a){var i=a.natural_person?"natural_person":"legal_person";a[i].selectedPerson=a[i].external_id,"natural_person"===i?(a[i].age=s("calcAge")(a[i].birth_date),a[i].expirience=s("calcAge")(a[i].driving_experience_started)):(t.osagoParams.legal_person.inn=a[i].inn,t.osagoParams.legal_person.title=a[i].title,t.osagoParams.legal_person.insurant_is_legal_person=!0),a[i].personType=i,o.setPersonCredential(a[i]),o.setPersonAddress(a[i]),a.role.length&&_.forEach(a.role,function(e){a[i]["is"+e.slice(0,1).toUpperCase()+e.slice(1,e.length)]=!0}),"natural_person"===i&&f(e.copy(a[i]))}),e.forEach(a.drivers,function(e){e.personType="natural_person",e.isDriver=!0,o.setPersonCredential(e),v(e)}),t.persons.length||t.drivers.length||f(),t.drivers.length&&(a.person.length&&(t.drivers[0].person=a.person[0].id),t.persons.length=0),t.cachedDrivers=e.copy(t.drivers),C={drivers:e.copy(t.drivers),persons:e.copy(t.persons)},a}function x(){var e=t.drivers.length?t.drivers:t.persons,a={car:{car_mark:t.calculation.car_mark,car_model:t.calculation.car_model,car_model_group:t.calculation.car_model_group||null,manufacturing_date:t.calculation.car_manufacturing_year+"-01-01",engine_power:t.calculation.engine_power,cost:0,vin_number:t.osagoParams.vin_number},persons:e};return l.createInsuredObjectOsago(a)}function k(e){return e=e||new Date,s("date")(e,"yyyy-MM-dd")}var P,C,S,I=a.getPromises(),D={},T={credential:[],address:[],contact:[],first_name:"",last_name:"",patronymic:"",isDriver:!0,personType:"natural_person",birth_date:"",gender:"M",driving_experience_started:"",driver_license:o.getDefaultObject("defaultDriverLicenseObject")},$={is_same_address:!0,credential:[],isOwner:!0,personType:"natural_person",isDriver:!1,isInsurant:!1,first_name:"",last_name:"",patronymic:"",gender:"M",birth_date:"",passport:o.getDefaultObject("defaultPassportObject"),address_registration:{address_type:1,postal_index:"Нет",country:"Россия",city:"Не указан",street:"Не указана",house:"Не указан",housing:"Не указан",flat:"Не указан",kladr:""}},O=[];t.dicts={},t.dynamicDicts={},t.persons=[],t.drivers=[],t.params.field_was_clicked=!1,t.osagoParams={vin_number:"",vin_is_visible:!0,legal_person:{isOwner:!0,isInsurant:!1,inn:"",title:"",address_registration:{address_type:1,postal_index:"Нет",country:"Россия",city:"Не указан",street:"Не указана",house:"Не указан",housing:"Не указан",flat:"Не указан",kladr:""},is_same_address:!0,personType:"legal_person"}},a.calculationFormIsValid=function(){return!0},t.templates.program_list=i.pathToModules+"osago/calculatorO/views/osago/calculation.program_list.html",t.validation={},t.isVisible=function(e,a,i){var n;+t.calculation.car_type;return i=i||t.calculation,"vin_number"===e&&(n=!Number(t.params.drivers_count_full)||t.calculation.is_legal_entity&&"false"!==t.calculation.is_legal_entity,i=t.osagoParams),n||(i[e]=a||null),n},t.isDisabled=function(e,a,i){var n;+t.calculation.car_type;return i=i||t.calculation,n&&(i[e]=a||null),n},_.isPromise(I.getCalculation)?I.getCalculation.then(m,g):t.calculation.id?a.getCalculation(t.calculation.id).then(m,g):g(),t.fieldChanged=function(e){"is_legal_entity"===e&&t.calculation.is_legal_entity&&"true"!==t.calculation.is_legal_entity&&(t.params.drivers_count=0,t.params.drivers_count_full=0,t.params.field_was_clicked=!1,t.driversCountChanged(),t.calculation.driver_set.length=0,t.calculation.is_multidrive=!0)},t.calculateOsago=function(){function a(){return t.calculate(function(a){t.cachedDrivers=e.copy(t.drivers),t.disabledFormationPolicyButtonIsActive=!0,D=e.copy(a)})}var i=[],n=[];if(!t.params.isCalculationProgress){if(t.params.isCalculationProgress=!0,t.root.messages.length=0,t.calculation.is_calculate_osago=!0,t.calculation.car_cost="0",t.calculation.drivers_count=t.params.drivers_count,delete t.calculation.insurance_type,delete t.calculation.insured_object,t.calculation.is_legal_entity&&"false"!==t.calculation.is_legal_entity?t.calculation.calculation_type=45427:t.calculation.calculation_type=45426,"full"!==p.getCurrentCalcType())return a();t.calculation.drivers_count=t.params.drivers_count_full,t.calculation.driver_set.length=0,e.forEach(t.drivers,function(a){var r=s("calcAge")(a.birth_date),l=s("calcAge")(a.driving_experience_started);a.isDriver=!0,a.personType="natural_person",t.calculation.driver_set.push({age:r||18,expirience:l,is_married:!1,has_children:!1}),i.push(r),n.push(l),a.birth_date=k(a.birth_date),a.driving_experience_started=k(a.driving_experience_started),a.driver_license.credential_type=3,a.credential=[e.copy(a.driver_license)]}),e.forEach(t.persons,function(e){e.birth_date=k(e.birth_date),e.isDriver=!1,e.credential=[e.passport]}),!t.drivers.length&&t.calculation.is_legal_entity&&"false"!==t.calculation.is_legal_entity&&(t.persons=[t.osagoParams.legal_person]),t.calculation.drivers_minimal_age=Math.min.apply(Math,i),t.calculation.drivers_minimal_experience=Math.min.apply(Math,n),C={drivers:e.copy(t.drivers),persons:e.copy(t.persons)},x().then(function(e){t.calculation.insured_object=e.id||null,a()},function(){t.root.messages.push("Ошибка при сохранении объекта страхования."),t.params.isCalculationProgress=!1})}},t.disabledSubmitButton=function(){return t.root.isSubmitButtonDisabled=!h()||!!t.params.isCalculationProgress,t.root.isSubmitButtonDisabled},t.addressIsValid=function(e){return e.city&&e.house&&e.street},t.getYearRange=function(e,t){var a,i,n=new Date;return e=e||0,t=void 0===t?90:t,i=n.getFullYear()-t,a=n.getFullYear()-e,i+":"+a},function(){var a=["insuranceDuration","driversCountOsagoFull","driversCountOsagoSimple","ownerRegistration"];e.forEach(a,function(a){t.dicts[a]=r.getItems(a).then(function(t){return t=t.results?t.results:t,O[a]=e.copy(t),t})}),t.dicts.trueFalse=[{title:"Да",id:!0},{title:"Нет",id:!1}],t.dicts.isLegalEntity=[{title:"Физическое лицо",id:!1},{title:"Юридическое лицо",id:!0}],t.dicts.insuranceDuration=t.dicts.insuranceDuration.then(function(e){return _.filter(e,function(e){return"1 год"===e.title})})}(),t.driversCountChanged=function(){var e=t.drivers.length,a=t.params.drivers_count_full;if(t.calculation.is_multidrive=!a,a&&"0"!==a?(t.persons.length=0,t.osagoParams.vin_is_visible=!1,t.osagoParams.vin_number=""):(t.persons.length=0,f(),t.osagoParams.vin_is_visible=!0),a>e)for(var i=0;a-e>i;i++)v();else t.drivers.length=+a},t.driversCountChangedSimple=function(){var i=t.calculation.driver_set.length,n=t.params.drivers_count;if(t.params.field_was_clicked){if(n>i)for(var r=0;n-i>r;r++)t.calculation.driver_set.push(e.copy(a.defaultCalcDriver));else t.calculation.driver_set.length=+n;t.calculation.is_multidrive=!t.calculation.driver_set.length}},t.driversDateChanged=function(e){var t=new Date(e.birth_date),a=new Date(e.driving_experience_started),i=(new Date).setFullYear((new Date).getFullYear()-77),n=a<i,r=5679936e5;t.setDate(t.getDate()+1),e.dateIsInvalid=a-t<r||n},t.disabledFormationPolicyButton=function(){var e,a;if(a=["created_at","id","deductible_value","drivers_count","is_new_car"],D){D.car_cost=parseInt(D.car_cost,10)+"",t.calculation.car_cost=parseInt(t.calculation.car_cost,10)+"";for(e in t.calculation)if(t.calculation.hasOwnProperty(e)&&a.indexOf(e)===-1&&!b(t.calculation[e],D[e]))return t.root.isFormationPolicyButtonDisabled=!0,!0}return t.root.isFormationPolicyButtonDisabled=!1,!1},t.resetPerson=function(e){o.resetPerson(e)}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("calculatorO").service("calculatorService",["$http","$q","CONSTS","$rootScope","resources","calculator","$filter","requester",function(a,i,n,r,s,l,o,c){function d(e){var a=t(".ui-datepicker-year").val();return(e=new Date(e))?(e.setFullYear(a),o("date")(e,"yyyy-MM-dd")):""}var u=l.getDefaults(),p=function(e){return e=e||new Date,o("date")(e,"yyyy-MM-dd")},m={full_year:null,field_was_clicked:!1,drivers_count:1,drivers_count_full:1,signalization_type:"",show_empty_fields:!1,resultsAreCreated:!1};this.parseResult=function(e){return e.company_logo="http://enter.b2bpolis.ru/"+e.insurance_company.logo,e},this.currentResult=null,this.getOtherCompanies=function(){return[{id:41243,title:"Росгосстрах",insurance_company:{logo:"media/logo_main_ins/Logo_24.png"}},{id:41465,title:"Ренессанс",insurance_company:{logo:"media/logo_main_ins/Logo_47.png"}}]},this.calculation=e.copy(u),this.companiesInProgress=[],this.getDefaultCalculation=function(){return u},this.selectedResult=null,this.setSelectedResult=function(e){this.selectedResult=e},this.getSelectedResult=function(){return this.selectedResult},this.calculationFormIsValid=_.noop,this._promises={},this.getPromises=function(){return this._promises},this.calculatorOtherParams=e.copy(m),this.resetCalculation=function(t){var a=e.copy(this.getDefaultCalculation());this.companiesInProgress.length=0,t=t||r.calcType;for(var i in this.calculation)this.calculation.hasOwnProperty(i)&&delete this.calculation[i];for(var n in a)a.hasOwnProperty(n)&&(this.calculation[n]=a[n]);for(var s in this.calculatorOtherParams)this.calculatorOtherParams.hasOwnProperty(s)&&(this.calculatorOtherParams[s]=m[s]);return this["to_defaults_"+t]&&this["to_defaults_"+t](),this},this.to_defaults_osago=function(){var t=new Date;t.setDate(t.getDate()+1),this.calculation.insurance_duration=82,this.calculation.driver_set=[e.copy(this.defaultCalcDriver)],this.calculation.car_type=1,this.calculation.drivers_count=1,this.calculation.calculation_at_date=p(t)},this.defaultCalcDriver={is_married:!1,gender:"M",expirience:null,age:null,
has_children:!1},this.createCalculation=function(t){return t=t||this.calculation,this.companiesInProgress.length=0,t=this.correctCalculation(t),delete t.token,c.post(s.calculation+"?token",t).then(function(t){var a,i=t.data,n=["optional_equipment"];this.calculationToken=i.token,this.companiesInProgress=i.available_insurance_departments,delete i.available_insurance_departments;for(a in i)i.hasOwnProperty(a)&&n.indexOf(a)===-1&&(e.equals(this.calculation[a],i[a])||(this.calculation[a]=i[a]));return t.data}.bind(this))},this.getCalculation=function(e){return e=e||this.calculation.id,e==this.calculation.id?i.when(this.calculation):(this._promises.getCalculation=c.get(s.calculation+e+"/").then(function(e){var t;e=e.data;for(t in e)"user"!==t&&(this.calculation[t]=e[t]);return this.calculation}.bind(this)),this._promises.getCalculation)},this.getResult=function(e){return e=e||this.calculation.id,c.get(s.calculationV3+e+"/result/?insurance_company=1&messages=1&variables=1").then(function(e){return this.companiesInProgress=e.data,this.currentResult=e.data,e.data}.bind(this))},this.createResult=function(e,t){var i=this.calculationToken;return t=t||this.calculation.id,a({url:"http://enter.b2bpolis.ru"+s.calculationV3+t+"/result/"+e+"/?insurance_company=1&messages=1&variables=1",method:"POST",headers:{"X-Calculation-Token":i}}).then(function(e){return this.companiesInProgress=e.data,this.currentResult=e.data,e.data}.bind(this))},this.getCredentialList=function(e){return a.get(n.urlPrefixDefault+"client/natural-person/"+e+"/credential").then(function(e){return e.data})},this.getAddressList=function(e){return a.get(n.urlPrefixDefault+"client/natural-person/"+e+"/address").then(function(e){return e.data})},this.correctCalculation=function(e){return e=e||this.calculation},this.personDateChanged=function(e,t,a){t=t||"birth_date",t.indexOf(".")!==-1?(t=t.split("."),e[t[0]][t[1]]=d(e[t])):e[t]=d(e[t])},this.validateDrivers=function(){var e,t,a=this.calculation.driver_set.length;if(0===a)return!0;for(e=0;e<a;e++)if(t=this.calculation.driver_set[e],t.age-t.expirience<17)return!1;return!0}}])}(angular,jQueryApp),function(e){e.module("formationPolicy",[])}(angular),function(e){"use strict";e.module("formationPolicy").service("formationPolicyService",["$http","CONSTS","$q","$rootScope","$filter","resources","requester",function(t,a,i,n,r,s,l){function o(){return null}function c(e){return e=e||new Date,r("date")(e,"yyyy-MM-dd")}function d(e){var t;return t="legal_person"===e.personType?["title","title_eng","id","inn","ogrn","kpp","representative_first_name","representative_last_name","representative_patronymic","representative_post","representative_credential_type","representative_number","representative_issue_date"]:["id","first_name","last_name","patronymic","first_name_eng","last_name_eng","patronymic_eng","birth_date","gender","driving_experience_started","is_individual_entrepreneur","is_foreigner"],_.pick(e,t)}var u={object:{credential:[{issue_date:"2016-02-04",creator:10585,series:"3456",number:"45",object_id:1751,issue_point:"",credential_type:10,content_type:480,expiration_date:null,external_id:"9374",id:5449}],keys_count:2,manufacturing_date:"2015-01-01",engine_power:"200.00",car_modification:null,creator:10585,car_model:7687,engine_displacement:"2.00",car_body_number:null,mileage:null,number_plate:"",car_mark:303,vin_number:"55TTEEE5E5R5R6TT7",external_id:"7628",id:1751,cost:null},object_type:"car",person:[]},p=null,m=null,g={clear:function(){m=null},resetCurrentPolicy:function(){p=null},updateCustomer:function(e){var a=i.defer(),n=o();return this.getCustomer(n).then(function(i){i.natural_persons=i.natural_persons.concat(e.natural_persons),i.natural_persons=_.uniq(i.natural_persons),t.put(s.customer+"/"+n,i).then(function(e){a.resolve(e.data)},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},getCustomer:function(e){return e=e||o(),t.get(s.customer+"/"+e).then(function(e){return e.data})},getCustomerCars:function(e){return e=e||o(),t.get(s.customerCar,{params:{owner:e}}).then(function(e){return e.data})},getCarCredential:function(e){return t.get(s.customerCar+"/"+e+"/credential").then(function(e){return e.data})},getCustomerFull:function(e){var a=i.defer();return this.getCustomer(e).then(function(e){t.get(s.person+"/"+e.person).then(function(i){var n=i.data,r="naturalPerson",l=n.natural_person;n.legal_person&&(r="legalPerson",l=n.legal_person),t.get(s[r]+"/"+l).then(function(t){var i=t.data;a.resolve({person:i,drivers:e.natural_persons})},function(e){a.reject(e)})},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},saveCar:function(a){var n=o(),r=i.defer(),l=_.pick(a,["id","mileage","car_mark","car_model","car_modification","owner","manufacturing_date","vin_number","number_plate","engine_displacement","engine_power","cost","keys_count"]),c="post",d=s.customerCar;return l.owner=l.owner||n,l.id&&(c="put",d+="/"+l.id),t[c](d,l).then(function(n){var l=n.data,o=_.map(a.credential,function(e){return _.pick(e,["id","number","series","credential_type","issue_date","issue_point","expiration_date"])}),c=[];e.forEach(o,function(e){var a="post",i=s.customerCar+"/"+l.id+"/credential";e.id&&(a="put",i+="/"+e.id),c.push(t[a](i,e).then(function(e){return e.data}))}),i.all(c).then(function(e){r.resolve({car:l,credential:e})},function(e){r.reject(e)})},function(e){r.reject(e)}),r.promise},createDeal:function(a){var n=i.defer();return t.post(s.deal,e.extend({deal_status:1,customer:o()},a)).then(function(e){var i=e.data;i.car=a.car,t.put(s.deal+"/"+i.id,i).then(function(e){n.resolve(e.data)},function(e){n.reject(e)})},function(e){n.reject(e)}),n.promise},getDeal:function(e){return t.get(s.deal+"/"+e)},createInsuranceProduct:function(e,a){return t.post(s.deal+"/"+e+"/insurance-product/from-calculation",a).then(function(e){return e.data})},updateInsuranceProduct:function(e,a,i){return t.put(s.deal+"/"+e+"/insurance-product/"+a,i).then(function(e){return e.data})},createInvoice:function(e,a){return t.post(s.deal+"/"+e+"/insurance-product/"+a+"/invoice/generate").then(function(e){return e.data})},createPersonContainer:function(e,a){var i={};return a="legal_person"===a?"legal_person":"natural_person",i[a]=e,t.post(s.person,i).then(function(e){return e.data})},saveBSO:function(e,a){return t.post(s.resultPolicy+"/"+e+"/enter_bso/",a).then(function(e){return e.data})},createInsuredObjectByIds:function(e){return t.post("/rest/default/client/insured-object",e).then(function(e){return e.data})},createInsuredObjectOsago:function(t){var a={object:{car_mark:t.car.car_mark,car_model:t.car.car_model,car_model_group:t.car.car_model_group||null,car_modification:t.car.car_modification||null,cost:+t.car.cost,engine_displacement:t.car.engine_displacement,engine_power:t.car.engine_power,credential:t.car.credential,external_id:t.car.id||this.generateId(),vin_number:t.car.vin_number,number_plate:t.car.number_plate,manufacturing_date:t.car.manufacturing_date,keys_count:t.car.keys_count,mileage:t.car.mileage,car_body_number:t.car.car_body_number,engine_power_kilowatt:t.car.engine_power_kilowatt,chassis_number:t.car.chassis_number},object_type:"car",person:[],drivers:[]};return e.forEach(a.object.credential,function(e){e.external_id=e.id||this.generateId()},this),e.forEach(t.persons,function(t,i){var n,r,s={},l=[],o=t.id||this.generateId(),u=t.address_registration?[t.address_registration]:[],p=d(t),m=t.personType;u&&u.lendth&&(u[0].address_type=1),"natural_person"===m?(r=t.credential,e.forEach(r,function(e){e&&(e.issue_date=c(e.issue_date),e.external_id=e.id||this.generateId())},this),!t.is_same_address&&t.address_residential&&(u.push(t.address_residential),u[1].content_type=482,u[1].address_type=2),t.birth_date=c(t.birth_date),t.driving_experience_started=c(t.driving_experience_started)):r=null,e.forEach(["owner","insurant"],function(e){var a="is"+e[0].toUpperCase()+e.substr(1);t[a]&&l.push(e)}),l.length>0&&(s.role=l,s.external_id=o,s.id=t.person_id,s[m]=p,s[m].external_id=o,s[m].credential=r,s[m].address=u,a.person.push(s)),t.isDriver&&(n=e.copy(p),n.external_id=o,n.credential=[],n.credential.push(_.find(r,function(e){return 3===e.credential_type})),n.credential.push(_.find(r,function(e){return 1===e.credential_type})),n.credential[1]||(n.credential.length=1),a.drivers.push(n))},this),l.post(s.insuredObjectOsago,a).then(function(t){return m=e.copy(t.data),t.data})},sendPhone:function(e){return t.post("/policy/rest/result_policy/"+e.policy_id+"/token",_.pick(e,"phone")).then(function(e){return e.data})},confirmPhone:function(e){return t.post("/policy/rest/result_policy/"+e.policy_id+"/token-verified",_.pick(e,"token")).then(function(e){return e.data})},toPay:function(e){return t.post("/payment/"+e+"/ ").then(function(e){return e.data})},createInsuredObject:function(t){var a,i;return t.car?(a={object:{car_mark:t.car.car_mark,car_model:t.car.car_model,car_model_group:t.car.car_model_group||null,car_modification:t.car.car_modification||null,cost:t.car.cost,engine_displacement:t.car.engine_displacement,engine_power:t.car.engine_power,credential:t.car.credential,external_id:t.car.id||this.generateId(),vin_number:t.car.vin_number,number_plate:t.car.number_plate,manufacturing_date:t.car.manufacturing_date,keys_count:t.car.keys_count,mileage:t.car.mileage,is_new_car:t.car.is_new_car,is_temporary:t.car.is_temporary,chassis_number:t.car.chassis_number},object_type:"car",person:[],drivers:[]},i=["owner","insurant","beneficiary"],e.forEach(a.object.credential,function(e){e.external_id=e.id||this.generateId()},this)):(a=u,i=["owner","insurant"]),e.forEach(t.persons,function(t,n){var r,s,l={},o=[],u=t.id||this.generateId(),p=[t.address_registration],m=_.filter(t.contact,function(e){return e.data}),g=d(t),v=t.personType;"legal_person"===v?s=null:(s=t.credential,e.forEach(s,function(e){e.issue_date=c(e.issue_date),e.external_id=e.id||this.generateId()},this),t.is_same_address||p.push(t.address_residential),t.is_temporary_registration&&p.push(t.address_temporary_registration),t.birth_date=c(new Date(t.birth_date)),t.driving_experience_started=t.driving_experience_started?c(new Date(t.driving_experience_started)):null),e.forEach(i,function(e){var a="is"+e[0].toUpperCase()+e.substr(1);t[a]&&o.push(e)}),e.forEach(p,function(e){e&&!e.country&&(e.country="Россия")}),o.length>0&&(l.role=o,l.external_id=u,l.id=t.person_id,l[v]=g,l[v].external_id=u,l[v].contact=m,l[v].credential=s,l[v].address=p,a.person.push(l)),t.isDriver&&(r=e.copy(g),r.external_id=u,r.address=p,r.credential=_.filter(s,function(e){return 3===e.credential_type}),a.drivers.push(r))},this),l.post(s.insuredObject,a).then(function(t){return m=e.copy(t.data),t.data})},getInsuredObject:function(t){return l.get(s.insuredObject+"/"+t).then(function(t){return m=e.copy(t.data),t.data})},getInsuredObjectOsago:function(t){return l.get(s.insuredObjectOsago+"/"+t).then(function(t){return m=e.copy(t.data),t.data})},getPolicyFile:function(e,a){return a=a?"?type="+a:"",t({method:"GET",url:s.resultPolicy+e+"/template/"+a,headers:{}}).then(function(e){return e.data})},createInsuredObjectCRM:function(e){return t.post(s.insuredObjectCRM,e).then(function(e){return e.data})},createPolicy:function(a){return t.post(s.resultPolicy,e.extend({external_id:o()},a)).then(function(e){return p=e.data})},savePolicy:function(a){var i="post",n=s.resultPolicy;return a.id&&(i="put",n=s.resultPolicy+a.id+"/"),t[i](n,e.extend({external_id:o()},a)).then(function(e){return p=e.data})},getPolicy:function(e){return t.get(s.resultPolicy+e+"/",{params:{external_id:o()}}).then(function(e){return p=e.data})},getSavedNaturalPersons:function(e){return t.get(s.savedNaturalPersons,{params:e}).then(function(e){return e.data})},getSavedLegalPersons:function(e){return t.get(s.savedLegalPersons,{params:e}).then(function(e){return e.data})},getSavedCars:function(e){return t.get(s.savedCars,{params:e}).then(function(e){return e.data})},getInsObjList:function(e){return t.get(s.insuredObectList,{params:e}).then(function(e){return console.log(e),e.data})},getCurrentPolicy:function(){return p},getCurrentInsuredObject:function(){return m},sendNotification:function(e){return t.post(s.notificationSend,e).then(function(e){return e.data})},generateId:function(){return~~(9900*Math.random()+100)},getPolicyActionsParameters:function(e){return t.get(s.resultPolicy+e+"/actions_parameters/",{params:{external_id:o()}}).then(function(e){return e.data})},executePolicyAction:function(e,i,n){return t.post(a.urlPrefixPolicy+"result_policy/"+e+"/"+i+"/",n).then(function(e){return e.data})},getPolicyDocsArchive:function(e){return t.get(a.urlPrefixPolicy+"result_policy/"+e+"/zip/").then(function(e){return e.data})},getPolicyAttachments:function(e){return t.get(s.resultPolicy+e+"/attachment/").then(function(e){return e.data})},deletePolicyAttachment:function(e,a){return t.delete(s.resultPolicy+e+"/attachment/"+a).then(function(e){return e.data})},issueToSavedPolicy:function(e){return t.post(s.resultPolicy+e+"/issue_to_saved_policy/").then(function(e){return e})},setPersonValidationDates:function(e){e.isDriver?(e.birthDateRange={min:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.age-1),c(t)}(),max:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.age),c(t)}()},e.expirienceRange={min:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.expirience-1),c(t)}(),max:function(){var t=new Date;return t.setFullYear(t.getFullYear()-e.expirience),c(t)}()}):(e.birthDateRange={min:function(){var e=new Date;return e.setFullYear(e.getFullYear()-90),c(e)}(),max:function(){var e=new Date;return e.setFullYear(e.getFullYear()-18),c(e)}()},e.expirienceRange={min:function(){var e=new Date;return e.setFullYear(e.getFullYear()-72),c(e)}(),max:function(){return c(new Date)}()}),e.birthDateRange.yearRange=new Date(e.birthDateRange.min).getFullYear()+":"+new Date(e.birthDateRange.max).getFullYear(),e.expirienceRange.yearRange=new Date(e.expirienceRange.min).getFullYear()+":"+new Date(e.expirienceRange.max).getFullYear(),e.dateChanged=function(t,a){var i=new Date(t).getFullYear(),n=new Date(a).getFullYear();e.invalidDates=i-n>=18}}};return g}])}(angular),function(e,t){"use strict";e.module("formationPolicy").service("formationPolicyStep1Service",["$filter","$rootScope","formationPolicyService","Person","calculatorService","$q",function(t,a,i,n,r,s){function l(){return P=e.copy(A)}function o(t,a){a=a||P;var i=_.filter(t,function(e){return e.credential_type===j.credential_type}),n=_.filter(t,function(e){return e.credential_type===M.credential_type});a.vehicle_registration=_.maxBy(i,function(e){return e.id})||e.copy(j),a.vehicle_certificate=_.maxBy(n,function(e){return e.id})||e.copy(M)}function c(t){if(_.head(t.credential)&&"natural_person"===t.personType){var a=_.filter(t.credential,function(e){return e.credential_type==O.credential_type}),i=_.filter(t.credential,function(e){return e.credential_type==$.credential_type});t.driver_license=_.maxBy(a,function(e){return e.id}),t.passport=_.maxBy(i,function(e){return e.id})||e.copy($)}return t}function d(t){return e.isArray(t.contact)&&t.contact.length>0&&(t.contact=_.sortBy(_.uniqBy(t.contact,function(e){return e.contact_type}),function(e){return e.contact_type})),t}function u(e){var t=new Date,a=new Date(e);if(a.getTime())return new Date(t-a).getFullYear()-1970}function p(e){e.full=e.city+", "+e.street+", д."+e.house}function m(t){if(e.isArray(t.address)&&t.address.length>0){var a=_.filter(t.address,function(e){return 1===e.address_type});a=_.maxBy(a,function(e){return e.id});var i=_.filter(t.address,function(e){return 2===e.address_type});i=_.maxBy(i,function(e){return e.id});var n=_.filter(t.address,function(e){return 3===e.address_type});n=_.maxBy(n,function(e){return e.id}),t.is_same_address=!i,t.is_temporary_registration=Boolean(n),a&&(t.address_registration=a,p(a)),i&&(t.address_residential=i,p(i)),n&&(t.address_temporary_registration=n,p(n))}return t}function g(e,t){return t=t||a.calcType,N[t](e,P)}function v(e){return e=e||a.calcType,B[e]()}function f(e,t,i,n){return n=n||a.calcType,R[n](e,t,i)}function h(e,t){return t=t||a.calcType,E[t](e,t)}function b(e){return V.allTypes(e)}function y(e){return e=e||a.calcType,q[e]()}function w(e){return U.allTypes(e)}function x(){C.length=0,l()}function k(e){return e=e||a.calcType,L[e](e)}var P,C=[],S=r.calculation,I="yyyy-MM-dd",D=function(e){return t("date")(e,I)},T={address_type:1,postal_index:null,content_type:482,country:"Россия",city:"",street:"",house:"",housing:"",flat:"",kladr:""},$={credential_type:1,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},O={credential_type:3,series:"",number:"",issue_date:"",issue_point:"РФ",expiration_date:""},j={credential_type:4,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},M={credential_type:7,series:"",number:"",issue_date:"",issue_point:"",expiration_date:""},F={is_same_address:!0,person_type:"natural_person",credential:[],isOwner:!1,isDriver:!1,isInsurant:!1,first_name:"",last_name:"",patronymic:"",gender:null,birth_date:"",passport:e.copy($),address_registration:e.copy(T),address_residential:e.extend(e.copy(T),{address_type:2})},A={car_mark:null,car_model:null,car_modification:null,cost:0,vin_number:"",chassis_number:"",number_plate:"",engine_displacement:"",engine_power:"",engine_power_kilowatt:"",keys_count:S.driver_set.length||1,mileage:"",manufacturing_date:null,selectedCar:"",vehicle_registration:e.copy(j),vehicle_certificate:e.copy(M),document_issue_date:"",mode:"edit"};l();var R={osago:function(t,a,r){var s,l=new Date,o=18,c=new n(e.extend(e.copy(F),{personType:a||"natural_person",isOwner:!1,isInsurant:!1,isDriver:!1,selectedPerson:"",mode:"edit"}));return t=t||{},"legal_person"===a?(c.extend({title:"",isDriver:!1,inn:"",ogrn:""}),c.address_registration=c.addAddress(e.copy(T))):(s=t.expirience||0===t.expirience?t.expirience:null,null===s&&(s=u(t.driving_experience_started)),c.extend({age:t.age||o,expirience:s,gender:"M",birth_date:t.birth_date||"",is_same_address:!0,is_temporary_registration:!1,driving_experience_started:t.driving_experience_started||""}),c.passport=c.addCredential(e.copy($)),c.driver_license=c.addCredential(e.copy(O)),c.address_registration=c.addAddress(e.copy(T)),c.address_residential=c.addAddress(e.copy(T)),c.address_temporary_registration=c.addAddress(e.copy(T)),c.driving_experience_started||(l=new Date,l.setFullYear(l.getFullYear()-c.expirience),c.driver_license.issue_date=D(l),c.driving_experience_started=D(l))),c.extend(t),i.setPersonValidationDates(c),c.hasRole=function(){return c.isInsurant||c.isOwner},r||C.push(c),c}},B={osago:function(){function t(){return S.id||(S.insured_object=11920),S.insured_object?i.getInsuredObject(S.insured_object):s.when({})}return t().then(function(t){t&&t.id?g(t):_.forEach(S.driver_set,function(t){var a={isDriver:!0,showFioFields:!0};f(e.extend(a,t))}),e.extend(P,{car_mark:S.car_mark,car_model:S.car_model,car_modification:S.car_modification,cost:Math.floor(S.car_cost),car_body_number:"",vin_number:null,number_plate:"",engine_displacement:null,engine_power:S.engine_power,mileage:null,manufacturing_date:S.car_manufacturing_year+"-01-01",vehicle_registration:e.copy(j),vehicle_certificate:e.copy(M),credential:[]}),e.extend(P,t.object),P.id=null;var i=_.head(C);if(S.is_legal_entity&&"false"!==S.is_legal_entity&&(i.address_registration=e.copy(T)),S.is_legal_entity&&a.currentUser){i.isInsurant=!1;var n=f({isInsurant:!0,isOwner:!1,isDriver:!1,title:a.currentUser.last_name,inn:a.currentUser.inn,ogrn:a.currentUser.ogrn},"legal_person");a.currentUser.address&&(e.extend(n.address_registration,a.currentUser.address),p(n.address_registration))}else i&&a.currentUser&&a.currentUser.id&&(i.passport&&!i.passport.series&&(i.passport.series=a.currentUser.passport_series,i.passport.number=a.currentUser.passport_number),i.address_registration&&!i.address_registration.city&&a.currentUser.address&&(e.extend(i.address_registration,a.currentUser.address),p(i.address_registration))),i.isInsurant=!0;i.isOwner=!0})}},N={osago:function(a){var i;C.length=0,P=a.object,o(P.credential),P.engine_power_kilowatt=+(.7355*S.engine_power).toFixed(2),P.engine_power=S.engine_power,_.forEach(a.person,function(e){var a=e.natural_person?"natural_person":"legal_person";e[a].personType=a,e[a].person=e.id,c(e[a]),m(e[a]),e[a].selectedPerson=e[a].external_id,"natural_person"===a&&(e[a].age=t("calcAge")(e[a].birth_date)),e.role.length&&_.forEach(e.role,function(t){e[a]["is"+t[0].toUpperCase()+t.substr(1)]=!0}),f(e[a])}),i=_.forEach(a.drivers,function(e){e.personType="natural_person",e.isDriver=!0,c(e),m(e)}),_.forEach(i,function(t){var a;_.forEach(C,function(i,n){t.external_id===i.external_id&&(a=!0,e.extend(i,t),i.isDriver=!0)}),t.driver_license=_.find(t.credential,function(e){return 3===e.credential_type})||e.copy(O),a||f(t)})}},E={osago:function(e){var t=C.indexOf(e),a=t-1>=0?t-1:t+1;e.isOwner&&(C[a].isOwner=!0),e.isInsurant&&(C[a].isInsurant=!0),t!==-1&&C.splice(t,1)}},q={osago:function(){e.forEach(C,function(e){e.address=[],e.credential=[],e.birth_date=D(e.birth_date),"natural_person"===e.personType&&((e.isInsurant||e.isOwner)&&(e.passport.credential_type=1,e.credential.push(e.passport)),e.isDriver&&(e.driver_license&&e.credential.push(e.driver_license),e.driving_experience_started=D(e.driving_experience_started)))});var t=_.find(C,function(e){return e.isOwner}),a=_.find(C,function(e){return e.isInsurant}),n=_.map(_.filter(C,function(e){return e.isDriver}),"id"),r={owner:t.person,beneficiary:t.person,insurant:a.person,drivers:n,object_type:"car",object_id:P.id};return P.credential=[],P.vehicle_registration&&P.credential.push(P.vehicle_registration),P.vehicle_certificate&&P.credential.push(P.vehicle_certificate),i.createInsuredObjectByIds(r)}},U={allTypes:function(t){return function(a){return e.isObject(a)&&(b(t),t.extend(a),t.getCredentialList().then(function(){c(t)}),t.getAddressList().then(function(){m(t)}),t.getContactList().then(function(){d(t)})),!0}}},V={allTypes:function(t){return e.extend(t,{id:null,age:t.selectedPerson?18:t.age,birth_date:"",last_name:"",first_name:"",patronymic:"",last_name_eng:"",first_name_eng:"",patronymic_eng:"",is_same_address:!0,driving_experience_started:"",selectedPerson:"",document:{credential_type:1,series:"Не указан",number:"",issue_date:""},title:"",title_eng:"",inn:"",ogrn:"",kpp:"",representative_first_name:"",representative_last_name:"",representative_patronymic:"",representative_post:"",representative_credential_type:"",representative_number:"",representative_issue_date:"",rsa_check_id:null,person:null,is_verified:null,is_current_user:!1}),t.pT=t.pT||t.personType,t.passport=t.addCredential(e.copy($)),t.ogrntip=t.addCredential(e.copy($)),t.driver_license=t.addCredential(e.copy(O)),t.address_registration=t.addAddress(e.copy(T)),t.address_residential=t.addAddress(e.copy(T)),t.address_temporary_registration=t.addAddress(e.copy(T)),t.contact=[{contact_type:1,data:""},{contact_type:2,data:""}],t.address_registration.country=null,t.address_residential.country=null,t.address_temporary_registration.country=null,t.credential.length=0,t.address.length=0,t.contact.length=0,t}},L={osago:function(){var e={isInsurant:!1,isOwner:!1,all:!1};return _.forEach(C,function(t){t.isInsurant&&(e.isInsurant=!0),t.isOwner&&(e.isOwner=!0)}),e.all=e.isInsurant&&e.isOwner,e}};return{addPerson:f,resetPerson:b,initFromCalculation:v,initFromInsuredObject:g,removePerson:h,persons:C,getPersons:function(){return C},createInsuredObject:y,resetAll:x,showSavedPersonsCallback:w,resetCar:l,getCar:function(){return P},setCarCredentials:o,getDefaultObject:function(t){var a={defaultAddressObject:T,defaultPassportObject:$,defaultDriverLicenseObject:O,defaultVehicleRegistrationObject:j};return e.copy(a[t])},setPersonCredential:c,setPersonAddress:m,setFullAddress:p,personCheckUsed:k}}])}(angular,jQueryApp),function(e){e.module("AddingDocuments",[])}(angular),function(e){"use strict";e.module("AddingDocuments").controller("AddingDocumentsCtrl",["$scope","FileUploader","CONSTS","addingDocumentsService",function(e,t,a,i){e.typeInput="personalData",e.isSaveDataProgress=!1,e.uploader=i.uploader||new t({url:"/some_url",formData:[{attachment_type:1,description:""}]}),i.uploader=e.uploader,e.confirmationList={},e.addingDocumentsTemplates={uploader:a.pathToModules+"osago/AddingDocuments/views/adding_documents.uploader.html",form:a.pathToModules+"osago/personalData/views/personal_data.html",currentTemplate:"uploader",selectTemplate:function(t){e.addingDocumentsTemplates.currentTemplate=t}}}])}(angular),function(e){"use strict";e.module("AddingDocuments").service("addingDocumentsService",["$q","CONSTS",function(e,t){function a(){var e;try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){e=!1}}return e||"undefined"==typeof XMLHttpRequest||(e=new XMLHttpRequest),e}this.send=function(i,n){var r,s=e.defer();return r=a(),r.open("POST",t.proxyPath+"mail.php",!0),r.onreadystatechange=function(){4==r.readyState&&(200==r.status?s.resolve(r.responseText):s.reject(n(r.responseText)))},r.send(i),s.promise},this.uploader=null}])}(angular),function(e){e.module("branding",[])}(angular),function(e){"use strict";e.module("branding").service("brandingService",["CONSTS","brandingConfigs",function(t,a){var i={},n={};return i[t.currentBrand]=e.extend(n,a),i}])}(angular),function(e){"use strict";e.module("personalData",[])}(angular),function(e){"use strict";e.module("personalData").controller("personalDataCtrl",["$scope","CONSTS","Person","formationPolicyStep1Service","formationPolicyService","$filter","$state",function(t,a,i,n,r,s,l){function o(e){return s("date")(e,"dd.MM.yyyy")}function c(e,t){var a="";return e.city&&(a+=t+": ",a+=e.city+" "+e.street+" д."+e.house+" ",e.housing&&(a+="Корпус "+e.housing+" "),e.flat&&(a+="Кв./офис "+e.flat+" "),a+="\n"),a}t.params={person_type:null,number_type:"vin_number",car_document_type:"vehicle_registration"},t.persons=n.persons,t.car=n.getCar(),n.initFromCalculation(),t.addressIsValid=function(e){return e.city&&e.house&&e.street},t.savePersonalData=function(){var e="";_.forEach(t.persons,function(t,a){e+=a+1+"-й участник договора"+(t.isDriver?" (Водитель): ":": ")+"\n",t.isOwner&&(e+="Собственник. "),t.isInsurant&&(e+="Страхователь. "),e+="\n","legal_person"===t.personType?(t.isOwner||t.isInsurant)&&(e+="Название: "+t.title+" ИНН:"+t.inn+" ОГРН:"+t.ogrn+"\n"):(e+="ФИО: "+t.last_name+" "+t.first_name+" "+(t.patronymic||"")+"\n",e+="Дата рождения: "+o(t.birth_date)+"\n",(t.isInsurant||t.isOwner)&&(e+="Серия и номер паспорта: "+t.passport.series+" "+t.passport.number+"\nДата получения: "+o(t.passport.issue_date)+"\nКем выдан: "+t.passport.issue_point+"\n"),t.isDriver&&(e+="Дата начала стажа: "+o(t.driving_experience_started)+"г.\n",e+="Водительское удостоверение: "+t.driver_license.series+" "+t.driver_license.number+"\n")),(t.isInsurant||t.isOwner)&&(e+=c(t.address_registration,"Адрес регистрации"),t.is_same_address||(e+=c(t.address_residential,"Адрес проживания"))),e+="\n"}),"vin_number"==t.params.number_type&&(e+="VIN-номер: "+t.car.vin_number+"\n"),"car_body_number"==t.params.number_type&&(e+="Номер кузова: "+t.car.car_body_number+"\n"),"chassis_number"==t.params.number_type&&(e+="Номер шасси: "+t.car.chassis_number+"\n"),e+="Гос. рег. знак: "+t.car.number_plate+"\n",e+="Пробег: "+t.car.mileage+"\n",e+="Мощность в кВт: "+t.car.engine_power_kilowatt+"\n","vehicle_registration"==t.params.car_document_type&&(e+="СТС серия:"+t.car.vehicle_registration.series+"номер: "+t.car.vehicle_registration.number+"\n"),"vehicle_registration"==t.params.car_document_type&&(e+="ПТС серия:"+t.car.vehicle_certificate.series+"номер: "+t.car.vehicle_certificate.number+"\n"),e+="Дата получения: "+o(t.car.document_issue_date)+"г.\n",e+="Объем двигателя: "+t.car.engine_displacement+"\n",r.personalData=e,console.log(r.personalData),l.go("index.ordering")},t.setPersonAs=function(a,i){a[i]=!0,"isOwner"===i&&(a.isBeneficiary=!0),e.forEach(t.persons,function(e){a.$$hashKey!==e.$$hashKey&&(e[i]=!1,a.isBeneficiary=!1)})},t.setPersonType=function(e,a){e[a]?t.setPersonAs(e,a):e[a]=!1},t.addPerson=function(e,a){a=a||"natural_person",t.params.person_type=null,n.addPerson(e,a)},t.removePerson=function(e){n.removePerson(e)},t.insurantTypes=[{id:"natural_person",title:"Физическое лицо"},{id:"legal_person",title:"Юридическое лицо"}],t.allDriversAreChanged=function(){var e=_.filter(t.persons,function(e){return e.isDriver});return e&&e.length===t.calculation.driver_set.length},t.personCheckUsed=n.personCheckUsed,t.getYearRange=function(e,t){var a,i,n=new Date;return e=e||0,t=void 0===t?90:t,i=n.getFullYear()-t,a=n.getFullYear()-e,i+":"+a},t.templates={persons:a.pathToModules+"osago/personalData/views/personal_data.form.persons.html",person_block:a.pathToModules+"osago/personalData/views/personal_data.form.person_block.html",person_block_legal:a.pathToModules+"osago/personalData/views/personal_data.form.person_block_legal.html",addresses_block:a.pathToModules+"osago/personalData/views/personal_data.addresses_block.html",address_registration:a.pathToModules+"osago/personalData/views/personal_data.address_registration.html",address_residential:a.pathToModules+"osago/personalData/views/personal_data.address_residential.html",person_roles:a.pathToModules+"osago/personalData/views/personal_data.form.person_roles.html",car:a.pathToModules+"osago/personalData/views/personal_data.form.car.html"}}])}(angular),function(e){e.module("calculatorStepsO",[])}(angular),function(e){e.module("utils",[])}(angular),function(e){"use strict";e.module("utils").directive("compile",["$compile",function(e){return function(t,a,i){t.$watch(function(e){return e.$eval(i.compile)},function(i){a.html(i),e(a.contents())(t)})}}])}(angular),function(e,t){"use strict";e.module("utils").directive("focusing",[function(){return{restrict:"A",link:function(e,a,i,n){function r(e){return e=e||c,e.find(".field input").filter(":visible")}function s(e){var a,i,n=r(),s=t(e.target);s.hasClass("ng-invalid")||13===e.keyCode&&(a=n.eq(n.index(e.target)+1),a.length?a.focus():(i=t("."+(+d+1)+"-is-focusing"),i.length?r(i).eq(0).focus():t("#id-after-focusing").focus()))}var l,o,c=t(a),d=_.uniqueId();c.addClass("is-focusing "+d+"-is-focusing"),setTimeout(function(){l=r(),o=l.filter(".focusing-first"),o.length?o.eq(0).focus():l.eq(1).focus(),l.on("keypress",s)},300)}}}])}(angular,jQueryApp),function(e){"use strict";e.module("utils").directive("ngMax",[function(){function t(t){return e.isUndefined(t)||""===t||null===t||t!==t}return{restrict:"A",require:"ngModel",link:function(e,a,i,n){var r=function(e){var a=i.ngMax||0;return!t(e)&&e>a?void n.$setValidity(i.name,!1):(n.$setValidity(i.name,!0),e)};n.$parsers.push(r),n.$formatters.push(r),e.$watch(function(){return i.ngMax},function(e,t){e!==t&&r(n.$viewValue)})}}}])}(angular),function(e){"use strict";e.module("utils").directive("ngMin",[function(){function t(t){return e.isUndefined(t)||""===t||null===t||t!==t}return{restrict:"A",require:"ngModel",link:function(e,a,i,n){var r=function(e){var a=i.ngMin||0;return!t(e)&&e<a?void n.$setValidity(i.name,!1):(n.$setValidity(i.name,!0),e)};n.$parsers.push(r),n.$formatters.push(r),e.$watch(function(){return i.ngMin},function(e,t){e!==t&&r(n.$viewValue)})}}}])}(angular),function(e){"use strict";e.module("utils").directive("noEmpty",[function(){function t(t){return e.isUndefined(t)||""===t||null===t||t!==t||"0"===t||0===t}return{restrict:"A",require:"ngModel",link:function(e,a,i,n){var r=function(e){return t(e)?(n.$setValidity(i.name,!1),e):(n.$setValidity(i.name,!0),e)};n.$parsers.push(r),n.$formatters.push(r)}}}])}(angular),function(e,t){"use strict";e.module("utils").directive("scrollTo",[function(){return{restrict:"A",link:function(e,a,i){function n(){setTimeout(function(){r=l.offset(),s=r&&r.top||0,t("html,body").animate({scrollTop:s},"fast")},o)}var r,s,l=t(a),o=i.scrollTo?+i.scrollTo:500;l.addClass("js-scroll-to"),
n()}}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("utils").directive("scrollToTarget",[function(){return{restrict:"A",link:function(e,a,i){var n=t(a),r=400;n.on("click",function(e){e.preventDefault();var a=t(i.scrollToTarget),n=a.offset();n&&t("html, body").animate({scrollTop:n.top},r)}),t("html,body").on("scroll mousedown wheel DOMMouseScroll mousewheel keyup touchmove",function(){t("html,body").stop()})}}}])}(angular,jQueryApp),function(e){"use strict";e.module("utils").filter("boolFormatter",[function(){return function(e){return e?"да":"нет"}}])}(angular),function(e){"use strict";e.module("utils").filter("calcAge",[function(){return function(e){var t=+new Date(e);return~~((Date.now()-t)/315576e5)}}])}(angular),function(e){"use strict";e.module("utils").filter("dateExpired",[function(){return function(t,a){var i=new Date(t);return!(e.isDate(i)&&!isNaN(i.getTime()))||!!a&&Math.abs((new Date-i)/864e5)>a}}])}(angular),function(e){"use strict";e.module("utils").filter("fioFormatter",[function(){return function(t,a){var i="";return e.isObject(t)?void 0!==t.last_name&&void 0!==t.first_name?(i=(t.last_name||"")+" "+(t.first_name||""),"full"===a&&t.patronymic&&(i+=" "+t.patronymic),i):void 0!==t.title?(i=t.title,"full"===a&&t.full_title&&(i=t.full_title),i):"":t}}])}(angular),function(e){e.module("utils").filter("fractionalFormatter",[function(){return function(e,t){var a,i=parseFloat(e);if(isNaN(i))return"";for(a=i%1,t&&a&&(a=(a.toFixed(2)+"").substr(2,t)),a+="";a.length<t;)a+="0";return a}}])}(angular),function(e){"use strict";e.module("utils").filter("multiColumn",[function(){var t=[];return function(a,i){var n;if(!i||!e.isArray(a))return a;if(n=_.find(t,function(e){return JSON.stringify(e.items)===JSON.stringify(a)&&JSON.stringify(e.options)===JSON.stringify(i)}))return n.filtered;var r,s=i.columns||null,l=i.rows||null,o=[[]],c=0,d=0;if(!s&&!l)throw new Error("Number of rows or columns must be specified");if(s&&l)throw new Error("Number of rows and columns can not be used simultaneously");s=s>a.length?a.length:s,l=l>a.length?a.length:l,r=s?Math.ceil(a.length/s):l;for(var u=0,p=a.length;u<p;u++,c++)c===r&&(d++,c=0,o[d]=[]),o[d].push(a[u]);return t.push({items:a,options:i,filtered:o}),o}}])}(angular),function(e){"use strict";e.module("utils").filter("num",[function(){return function(e){var t=parseInt(e,10);return isNaN(t)?e:t}}])}(angular),function(e){"use strict";e.module("utils").service("requester",["$http","CONSTS",function(t,a){function i(e){return function(i,n){return t({url:a.proxyPathC+"proxy.php",method:e,data:n,headers:{"X-Itform-Forward":i,"Content-Type":"application/json","Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:0},params:{v:Math.floor(1e8*Math.random())}})}}return{get:i("GET"),post:i("POST"),put:i("PUT"),getOriginal:function(a,i){return t({method:"GET",url:a,params:e.extend({v:Math.floor(1e8*Math.random())},i)})}}}])}(angular),function(e){"use strict";e.module("utils").service("transformToFormData",function(){function e(e){var t=[];for(var a in e)t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return t.join("&")}return e})}(angular),function(e){e.module("dictionary",[])}(angular),function(e){"use strict";e.module("dictionary").directive("dictionary",["Dictionary","$parse",function(t,a){return{template:"{{foundResult}}",scope:{dictionary:"@",dictionaryId:"=",dictionaryArray:"=",dictionaryProp:"@"},link:function(i){function n(){var n;a(i.dictionaryProp);if(i.foundResult="",e.isString(i.dictionary)&&""!==i.dictionary)t.findItem(i.dictionary,i.dictionaryId,i.dictionaryProp).then(function(e){return i.foundResult=e,i.foundResult});else if(e.isArray(i.dictionaryArray))return n=_.find(i.dictionaryArray,function(e){return e.id==i.dictionaryId}),n&&i.dictionaryProp?(i.foundResult=n[i.dictionaryProp],i.foundResult):(i.foundResult=n,n)}i.$watch("dictionaryId",function(e,t){e!==t&&n()}),i.$watch("dictionaryArray",function(e,t){e!==t&&n()}),n()}}}])}(angular),function(e,t){"use strict";e.module("dictionary").provider("Dictionary",function(){var a={},i=[],n=86400,r=["$q","$filter","requester",function(r,s,l){function o(t,a,i){var n,r,s,l={};if(t.results&&(t=t.results),n=_.find(t,function(e){return a==e.id}),void 0!==n){if(e.isArray(i))for(r=0,s=i.length;r<s;r++)l[i[r]]=n[i[r]];else l=e.isString(i)?n[i]:n;return l}}function c(a,i,n){var r,s,l={defaults:n||{},urlParams:{}},o=a,c=l.urlParams;return e.forEach(o.split(/\W/),function(t){if("hasOwnProperty"===t)throw e.$$minErr("$resource")("badname","hasOwnProperty is not a valid parameter name.");!new RegExp("^\\d+$").test(t)&&t&&new RegExp("(^|[^\\\\]):"+t+"(\\W|$)").test(o)&&(c[t]=!0)}),o=o.replace(/\\:/g,":"),i=i||{},e.forEach(l.urlParams,function(t,a){r=i.hasOwnProperty(a)?i[a]:l.defaults[a],e.isDefined(r)&&null!==r?(s=d(r),o=o.replace(new RegExp(":"+a+"(\\W|$)","g"),function(e,t){return s+t})):o=o.replace(new RegExp("(/?):"+a+"(\\W|$)","g"),function(e,t,a){return"/"==a.charAt(0)?a:t+a}),i.hasOwnProperty(a)&&delete i[a]}),/\/+$/.test(a)||(o=o.replace(/\/+$/,"")||"/"),o=o.replace(/\/\.(?=\w+($|\?))/,"."),o=o.replace(/\/\\\./,"/."),e.isObject(i)&&_.keys(i).length>0&&(o+="?"+t.param(i)),o}function d(e){return u(e,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function u(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,t?"%20":"+")}function p(e){if(void 0===e||""===e)throw new Error("Empty dictionary name");if(void 0===f[e])throw new Error("Invalid dictionary name: "+e);return f[e]instanceof m||(f[e]=new m(f[e]),f[e].dictName=e),!0}var m,g="http://enter.b2bpolis.ru"+a.urlPrefixV4,v={},f={cities:{url:a.urlPrefixCalc+"city/:id/"},tripPurpose:{url:a.urlPrefixCalc+"trip_purpose/"},validity:{url:a.urlPrefixCalc+"validity/"},insuranceSum:{url:a.urlPrefixCalc+"insurance_sum/"},credentialTypes:{url:a.urlPrefixDefault+"client/credential-type/:id"},carMarks:{url:g+"car-mark/:id",localStorage:!0},carModelGroups:{url:g+"car-model-group",localStorage:!0},carModelsByGroup:{url:g+"car-model/:id",localStorage:!0},carModels:{url:g+"car-model/:id",localStorage:!0},carModelPrices:{url:a.urlPrefixDefault+"car_mark/:markId/car_model/:modelId/?fields=prices&year=:year",localStorage:!1,resourceParams:{markId:"@markId",modelId:"@modelId",year:"@year"}},carModifications:{url:g+"car_mark/:markId/car_model/:modelId/car_modification/:id",resourceParams:{markId:"@markId",modelId:"@modelId",id:"@id"}},ownerRegistration:{url:g+"owner-registration",localStorage:!1},exploitationArea:{url:g+"exploitation-area",localStorage:!1,urlForProxy:"/rest/full/exploitation_area/"},carBody:{url:g+"car-body",localStorage:!1},insuranceDuration:{url:g+"insurance-duration",localStorage:!1},contractDurations:{url:a.urlPrefixCalc+"contract_duration/",localStorage:!1},antiThefts:{url:a.urlPrefixDefault+"antitheft/models/",localStorage:!1},carType:{url:a.urlPrefixCalc+"car_type/",localStorage:!1},contributoryScheme:{url:g+"contributory-scheme",localStorage:!1},paymentForm:{url:g+"payment-form",localStorage:!1},insCompanyCarModels:{url:a.host+"/car_groups/rest/groups/:id/items/"},deductibleTypes:{url:a.urlPrefixCalc+"deductible_type/",localStorage:!1},targetOfUsing:{url:a.urlPrefixCalc+"target_of_using/",localStorage:!1},coverageConditions:{url:a.urlPrefixCalc+"coverage_condition/",localStorage:!1},optionalEquipments:{url:a.urlPrefixCalc+"optional_equipment/",localStorage:!1},insuranceProductStatus:{url:a.urlPrefix+"deal/insurance-product-status/:id",localStorage:!1},insuranceType:{url:g+"insurance-type"},compensationWithoutReferences:{url:a.urlPrefixCalc+"compensation_without_references/"},deductibleHarmIncident:{url:a.urlPrefixCalc+"deductible_harm_incident/"},isProlongation:{getItems:function(){var e=r.defer();return this.items=[{title:"Новый",id:!1},{title:"Из предыдущих",id:!0}],e.resolve(this.items),e.promise}},personTypes:{getItems:function(){var e=r.defer();return this.items=[{id:2,title:"Физическое лицо",shortTitle:"Физ. лицо",code:"naturalPerson"},{id:1,title:"Юридическое лицо",shortTitle:"Юр. лицо",code:"legalPerson"}],e.resolve(this.items),e.promise}},policyAreas:{url:a.urlPrefixCalc+"policy_area/",localStorage:!1},driversCountOsagoFull:{getItems:function(){var e=r.defer();return this.items=_.map(_.range(1,11),function(e){return{id:e.toString(),title:e.toString()}}),this.items.unshift({id:0,title:"Без ограничений"}),e.resolve(this.items),e.promise}},driversCountOsagoSimple:{getItems:function(){return r.when(_.map(_.range(1,11),function(e){return{id:e.toString(),title:e.toString()}}))}},driversCount:{getItems:function(){var e=r.defer();return this.items=[{title:"",item_type:"divider",code:"nat"},{title:"Ограниченный список",item_type:"header",code:"nat|active"},{id:1,title:"1 водитель",code:"nat|active"},{id:2,title:"2 водителя",code:"nat|active"},{id:3,title:"3 водителя",code:"nat|active"},{id:4,title:"4 водителя",code:"nat|active"},{id:5,title:"5 водителей",code:"nat|active"},{title:"",item_type:"divider",code:"nat"},{title:"Без ограничений",id:100,code:"nat|leg|active"}],e.resolve(this.items),e.promise}},countries:{getItems:function(){var e=r.defer();return this.items=[{id:"Азербайджан",title:"Азербайджан"},{id:"Армения",title:"Армения"},{id:"Белоруссия",title:"Белоруссия"},{id:"Казахстан",title:"Казахстан"},{id:"Киргизия",title:"Киргизия"},{id:"Молдавия",title:"Молдавия"},{id:"Таджикистан",title:"Таджикистан"},{id:"Туркмения",title:"Туркмения"},{id:"Узбекистан",title:"Узбекистан"},{id:"Украина",title:"Украина"},{id:"Грузия",title:"Грузия"},{id:"Турция",title:"Турция"},{id:"Сирия",title:"Сирия"},{id:"Тунис",title:"Тунис"},{id:"Япония",title:"Япония"},{id:"Китай",title:"Китай"},{id:"Иные",title:"Иные"}],e.resolve(this.items),e.promise}},deductibleValue:{getItems:function(){var e=r.defer();return this.items=[{id:6e3,title:6e3},{id:12e3,title:12e3},{id:2e4,title:2e4},{id:25e3,title:25e3},{id:5e4,title:5e4}],e.resolve(this.items),e.promise}},civilLiabilityVoluntaryCost:{getItems:function(){var e=r.defer();return this.items=[{id:5e5,title:5e5},{id:1e6,title:1e6},{id:15e5,title:15e5}],e.resolve(this.items),e.promise}},paymentTypes:{getItems:function(){return t.when([{title:"Банковская карта",id:"AC",img_name:"visamastercard.png"},{title:"Альфа-Клик",id:"AB",img_name:"alfaclick.jpg"},{title:"Кошелек Яндекс.Денег",id:"PC",img_name:"yandex.png"},{title:"Наличные через терминал",id:"GP",img_name:"qiwi.png"},{title:"Интернет-банк Промсвязьбанка",id:"PB",img_name:"psb.jpg"},{title:"Кошелек WebMoney",id:"WM",img_name:"webmoney.png"}])}},yesNo:{getItems:function(){return r.when([{id:!0,title:"Да"},{id:!1,title:"Нет"}])}},policyStatus:{getItems:function(){var e=r.defer();return this.items=[{id:"saved",title:"Оформление договора",code:"saved"},{id:"payed",title:"Выдан",code:"payed"},{id:"annuled",title:"Аннулирован",code:"annuled"},{id:"issued",title:"Проект договора",code:"issued"},{id:"archived",title:"Архив заключенных договоров",code:"archived"},{id:"onapproval",title:"Требует согласования",code:"onapproval"},{id:"denied",title:"Отклонен",code:"denied"}],e.resolve(this.items),e.promise}},policyActions:{getItems:function(){var e=r.defer();return this.items=[{id:"status_policy",title:"Проверить статус"},{id:"save_policy",title:"Сохранить"},{id:"print_policy",title:"Печать"},{id:"annul_policy",title:"Аннулировать"},{id:"issue_policy",title:"Оформить"}],e.resolve(this.items),e.promise}},transmission:{getItems:function(){return r.when([{id:"Автомат",title:"Автомат"},{id:"Механика",title:"Механика"}])}},driveOfCar:{getItems:function(){return r.when([{id:"Полный",title:"Полный"},{id:"Передний",title:"Передний"},{id:"Задний",title:"Задний"}])}},driverLicenseAccessory:{getItems:function(){return r.when([{id:"РФ",title:"РФ"},{id:"Иное",title:"Иное"}])}},keysCount:{getItems:function(){var e=r.defer();return this.items=_.map(_.range(1,4),function(e){return{id:e,title:e}}),e.resolve(this.items),e.promise}},notificationTypes:{url:a.urlPrefix+"notification/message-type",localStorage:!1},invoiceStatus:{url:a.urlPrefix+"invoice/invoice-status/:id",localStorage:!1},cbmCasco:{url:a.urlPrefixCalc+"cbm_casco/:id",localStorage:!1},osagoLossesCount:{url:a.urlPrefixCalc+"osago_losses_count/:id",localStorage:!1},specialProgram:{url:a.urlPrefixCalc+"special_program/:id",localStorage:!1},carParkSize:{url:a.urlPrefixCalc+"car_park_size/:id",localStorage:!1},prolongations:{url:a.urlPrefixCalc+"prolongation/:id",localStorage:!1},signalizationType:{url:a.urlPrefixCalc+"signalization_type/",localStorage:!1},insurantType:{url:a.urlPrefixCalc+"insurant_type/",localStorage:!1},dealCount:{url:a.urlPrefixCalc+"deal_count/",localStorage:!1},carParkSizeItems:{url:a.urlPrefixCalc+"car_park_size/",localStorage:!1},creditBank:{url:a.urlPrefixDefault+"bank/",localStorage:!1},technicalInspectionType:{url:a.urlPrefixCalc+"technical_inspection_type/",localStorage:!1},osagoRegion:{url:a.urlPrefixCalc+"osago_region/",localStorage:!1},osagoCity:{url:a.urlPrefixCalc+"osago_city/:id",localStorage:!1}};return m=function(t){this.items=[],this.dictName="",this.url="",this.cache=!0,this.localStorage=!1,this.lastUpdate="",this.lifeTime=n,this.resourceParams={id:"@id"},this._loadStack={},e.extend(this,t),this.defaultUrl=c(this.url)},null===localStorage.getItem("lastUpdates")&&localStorage.setItem("lastUpdates",e.toJson({})),m.prototype.load=function(t,a){var i,n;return t=t||c(this.url,a),e.isArray(this._loadStack[t])&&this.cache?(i=r.defer(),0===this._loadStack[t].length?i.resolve(this.items[t]):this._loadStack[t].push(i),i.promise):(this.urlForProxy&&(t=this.urlForProxy),n=l[this.urlForProxy?"get":"getOriginal"](t),this.cache&&(this._loadStack[t]=[],this._loadStack[t].push(n)),n.then(function(a){var i=a.data;return this.cache&&(this.items[t]=i,this._loadStack[t].shift(),e.forEach(this._loadStack[t],function(e){e.resolve(i)}),this._loadStack[t].length=0),this.localStorage&&(localStorage.setItem(t,e.toJson(i)),this.setLastUpdate(t)),i}.bind(this),function(a){this.cache&&(this._loadStack[t].shift(),e.forEach(this._loadStack[t],function(e){e.reject(a)}),this._loadStack[t].length=0)}.bind(this)))},m.prototype.setLastUpdate=function(t,a){var i=e.fromJson(localStorage.getItem("lastUpdates"))||{};a=a||(new Date).getTime(),t=t||this.dictName,this.lastUpdate=a,i[t]=a,localStorage.setItem("lastUpdates",e.toJson(i))},m.prototype.getLastUpdate=function(t){var a;return t=t||this.dictName,localStorage.getItem("lastUpdates")&&(a=e.fromJson(localStorage.getItem("lastUpdates"))[t]),this.lastUpdate||a},m.prototype.checkLastUpdate=function(e){var t=this.getLastUpdate(e);return!isNaN(parseInt(t,10))&&t+1e3*this.lifeTime>(new Date).getTime()},m.prototype.getItems=function(t){var a,i=e.isObject(t)?c(this.url,t):this.defaultUrl,n=r.defer();return this.cache&&void 0!==this.items[i]?n.resolve(e.copy(this.items[i])):this.localStorage&&this.checkLastUpdate(i)&&(a=localStorage.getItem(i))?(a=e.fromJson(a),this.cache&&(this.items[i]=a),n.resolve(e.copy(a))):this.load(i,t).then(function(t){n.resolve(e.copy(t)||[])},function(e){n.reject(e)}),n.promise},m.prototype.filter=function(e){return this.getItems().then(function(t){return s("filter")(t,e)})},m.prototype.findItem=function(t,a){var i,n=r.defer();return e.isObject(t)&&(i=e.copy(t),t=t.id),this.getItems(i).then(function(e){n.resolve(o(e,t,a))},function(e){n.reject(e)}),n.promise},m.prototype.loadItem=function(t){var a,i=r.defer();return void 0===t||null===t||""===t?i.reject("The params is empty"):((e.isString(t)||e.isNumber(t))&&(t={id:t}),a=c(this.url,t),(e.isString(t)||e.isNumber(t))&&(t={id:t}),l.getOriginal(a).then(function(e){i.resolve(e.data)},function(e){i.reject(e)})),i.promise},v.getItems=function(e){var t,a;try{p(e)}catch(e){console.log(e.message)}return t=Array.prototype.slice.apply(arguments),t.splice(0,1),a=f[e],a.getItems.apply(a,t)},v.findItem=function(e,t,a){var i,n;try{p(e)}catch(e){console.log(e.message)}return i=Array.prototype.slice.apply(arguments),i.splice(0,1),n=f[e],n.findItem.apply(n,i)},v.loadItem=function(e,t){var a,i;try{p(e)}catch(e){console.log(e.message)}return a=Array.prototype.slice.apply(arguments),a.splice(0,1),i=f[e],i.loadItem.apply(i,a)},v.filter=function(e,t){var a,i;try{p(e)}catch(e){console.log(e.message)}return a=Array.prototype.slice.apply(arguments),a.splice(0,1),i=f[e],i.filter.apply(i,a)},e.forEach(i,function(e){v.getItems(e)}),v}];return{$get:r,setConstants:function(e){a=e},setLifeTime:function(e){n=e},preload:function(t){return e.isString(t)?void(i=[t]):void(e.isArray(t)&&(i=t))}}})}(angular,jQueryApp),function(e){e.module("policyOrdering",[])}(angular),function(e){"use strict";e.module("policyOrdering").controller("policyOrderingCtrl",["$scope","$rootScope","brandingConfigs","policyOrderingService","CONSTS","calculatorService","Dictionary","Messages","$timeout","addingDocumentsService","$filter","calculatorStepsService","formationPolicyService",function(e,t,a,i,n,r,s,l,o,c,d,u,p){function m(){return{payment_type:"Наличными",receipt_type:"delivery",client_phone:"",client_name:"",delivery_date:"",delivery_time:"",delivery_address:"",arrival_date:"",arrival_time:""}}e.carInfo={},e.policyInfo={};var g=r.calculation,v=g&&g.id||9093963;e.policyOrderingInProgress=!1,e.root={},e.params={disableFormFields:!1},e.selectedResult=r.getSelectedResult(),e.dictionaryTitles={},e.formFields=m(),e.templates={navigation:n.pathToModules+"shared/calculator/views/navigation.html",policy_info:a.templates.policy_info||n.pathToModules+"shared/carFilter/views/policy_info.html"},e.getSelectedResult=function(){return e.root.selectedResult=r.getSelectedResult(),e.root.selectedResult},e.sendOrderLetter=i.sendOrderLetter,e.orderPolicy=function(){e.sendOrderLetter(),e.params.orderButton=!0},e.sendPolicyOrdering=function(){var a="",i=new FormData;return e.params.disableFormFields=!0,e.policyOrderingInProgress=!0,e.formFields.client_name=e.formFields.client_name||g.client_name,e.formFields.client_phone=e.formFields.client_phone||g.client_phone,a+="Имя клиента: "+e.formFields.client_name+"\n",a+="Номер телефона клиента: "+e.formFields.client_phone+"\n\n",a+="Номер расчета: "+r.calculation.id+"\n",a+="Выбранная страховая компания: "+e.selectedResult.insurance_company.title+" ("+e.selectedResult.id+")\n\n",a+="Способ оплаты: "+e.formFields.payment_type+"\n",a+="Тип получения: "+("delivery"===e.formFields.receipt_type?"Доставка":"Получение в офисе")+"\n","delivery"===e.formFields.receipt_type?(a+="Место доставки: "+e.formFields.delivery_address+"\n",a+="Желаемая дата доставки: "+e.formFields.delivery_date+"\n",a+="Желаемое время доставки: "+e.formFields.delivery_time+"\n"):(a+="Дата оформления: "+e.formFields.arrival_date+"\n",a+="Время оформления: "+e.formFields.arrival_time+"\n"),a+="Автомобиль: "+e.carInfo.carMark.title+" "+e.carInfo.carModelGroup.title+" "+e.carInfo.carModel.title+" "+g.car_manufacturing_year+" г. выпуска, "+g.engine_power+" л.с. \n",["tumen"].indexOf(t.currentBrandName)!==-1&&(a+="Коробка передач: "+e.calculationInterParams.params.transmission+"\n",a+="Привод: "+e.calculationInterParams.params.drive_of_car+"\n",a+="Оплата: "+e.policyInfo.contributory_scheme+"\n",a+="Автомобиль на гарантии: "+(g.is_under_warranty&&"Да"||"Нет")+"\n",a+="Новое ТС: "+(g.is_new_car&&"Да"||"Нет")+"\n",a+="СТОА: "+e.policyInfo.payment_form+"\n"),a+="Регион регистрации собственника: "+e.carInfo.owner_registration_title+"\n",a+="Страховая сумма: "+d("priceFormatter")(e.selectedResult.program.sum,2)+" рублей \n\n",p.personalData&&(a+=p.personalData),t.currentBrand.link_to_registration_in_email&&(a+="Ссылка на оформление: http://enter.b2bpolis.ru/#/calculator/"+r.calculation.id+"/result/"+e.selectedResult.id+"?s=b&fp=a"),i.append("message",a),c.uploader&&_.forEach(c.uploader.queue,function(e,t){i.append("file_"+t,e._file)}),c.send(i).then(function(){e.policyOrderingInProgress=!1,l.success("Ваш заказ принят. Мы свяжемся с вами в ближайшее время.",6e3)},function(){l.error("Не удалось отправить запрос.",6e3),e.policyOrderingInProgress=!1})},e.getYearRange=function(e,t){var a,i,n=new Date;return e=e||0,t=void 0===t?90:t,i=n.getFullYear()-t,a=n.getFullYear()-e,i+":"+a},e.paymentType=["Наличными","Банковской картой","Денежным переводом"],r.getCalculation(v).then(function(t){e.calculation=t,s.getItems("carModelGroups",{car_mark:t.car_mark}).then(function(a){e.carInfo.carModelGroup=_.find(a.results,function(e){return e.id==t.car_model_group})}),s.getItems("ownerRegistration").then(function(t){var a=_.find(t.results,function(t){return t.id==e.calculation.owner_registration});a&&(e.carInfo.owner_registration_title=a.title)}),s.getItems("contributoryScheme").then(function(t){var a=_.find(t.results,function(t){return t.id==e.calculationInterParams.contributory_scheme});a&&(e.policyInfo.contributory_scheme=a.title)}),s.getItems("paymentForm").then(function(t){var a=_.find(t.results,function(t){return t.id==e.calculationInterParams.payment_form});a&&(e.policyInfo.payment_form=a.title)}),s.getItems("carMarks",{id:t.car_mark}).then(function(t){t=t.results?t.results:t,e.carInfo.carMark=t}),s.getItems("carModels",{id:t.car_model}).then(function(t){t=t.results?t.results:t,e.carInfo.carModel=t}),t.insured_object&&p.getInsuredObject(t.insured_object).then(function(t){e.carInfo.drivers=t.drivers})}),r.getResult(v).then(function(t){e.calculationResult=t,e.selectedResult=e.selectedResult||t})}])}(angular),function(e){"use strict";e.module("policyOrdering").service("policyOrderingService",["calculatorStepsService","calculatorService","addingDocumentsService","Messages","$rootScope","$filter",function(e,t,a,i,n,r){var s=t.calculation;this.sendOrderLetter=function(){var l="",o=new FormData,c=t.getSelectedResult(),d=e.carAllSelected;return s.client_name&&(l+="Имя клиента: "+s.client_name+"\n"),s.client_phone&&(l+="Телефон клиента: "+s.client_phone+"\n"),s.id&&(l+="Номер расчета: "+s.id+"\n"),n.currentBrand.link_to_registration_in_email&&s.id&&(l+="Ссылка на оформление: http://enter.b2bpolis.ru/#/calculator/"+s.id),l+="\n",l+="Автомобиль: "+d.carMark.title+" ",l+=d.carModelGroup.title+" ",l+=d.carModel.title+" ",l+=s.car_manufacturing_year+" г. выпуска, ",l+=s.engine_power+" л.с. \n",l+="Куплен в кредит: "+(s.is_credit?"да":"нет")+"\n",l+="\n",s.is_multidrive?(l+="Минимальный возраст: "+s.drivers_minimal_age,l+="Минимальный стаж: "+s.drivers_minimal_experience,l+="\n"):_.forEach(s.driver_set,function(e,t){l+=t+1+"-й водитель возраст: "+e.age+" стаж: "+e.expirience+"\n",l+="Пол: "+("F"==e.gender?"Женский":"Мужской")+"\n",l+="В браке: "+(e.is_married?"да":"нет")+"\n",l+="Дети: "+(e.has_children?"да":"нет")+"\n",l+="\n"}),l+="Страховая сумма: "+r("priceFormatter")(c.program.sum,2)+" рублей \n\n",n.currentBrand.link_to_registration_in_email&&(l+="Ссылка на оформление: http://enter.b2bpolis.ru/#/calculator/"+s.id+"/result/"+c.id+"?s=b&fp=a"),l+="\n",o.append("message",l),a.send(o).then(function(){i.success("Ваш заказ принят. Мы свяжемся с вами в ближайшее время.",6e3)},function(){i.error("Не удалось отправить запрос.",6e3)})},this.sendLetterBeforeOrder=function(){var t="",i=new FormData,r=e.carAllSelected;return s.client_name&&(t+="Имя клиента: "+s.client_name+"\n"),s.client_phone&&(t+="Телефон клиента: "+s.client_phone+"\n"),s.id&&(t+="Номер расчета: "+s.id+"\n"),n.currentBrand.link_to_registration_in_email&&s.id&&(t+="Ссылка на оформление: http://enter.b2bpolis.ru/#/calculator/"+s.id),t+="\n",t+="Автомобиль: "+r.carMark.title+" "+r.carModelGroup.title+" "+r.carModel.title+" "+s.car_manufacturing_year+" г. выпуска, "+s.engine_power+" л.с. \n",s.is_credit&&(t+="Куплен в кредит: "+(s.is_credit?"да":"нет")+"\n"),t+="\n",s.is_multidrive?(t+="Минимальный возраст: "+s.drivers_minimal_age,t+="Минимальный стаж: "+s.drivers_minimal_experience,t+="\n"):_.forEach(s.driver_set,function(e,a){t+=a+1+"-й водитель возраст: "+e.age+" стаж: "+e.expirience+"\n",t+="Пол: "+("F"==e.gender?"Женский":"Мужской")+"\n",t+="В браке: "+(e.is_married?"да":"нет")+"\n",t+="Дети: "+(e.has_children?"да":"нет")+"\n",t+="\n"}),t+="\n",i.append("addressType","beforeOrder"),i.append("message",t),a.send(i)}}])}(angular),function(e){e.module("priceFormatter",[])}(angular),function(e,t){"use strict";e.module("priceFormatter").directive("priceFormatter",["$filter",function(e){function a(e){if(!e.selectionStart&&document.selection){var t=document.selection.createRange().duplicate();return t.moveEnd("character",e.value.length),""===t.text?e.value.length:e.value.lastIndexOf(t.text)}return e.selectionStart}function i(e,t){if(e.setSelectionRange)e.setSelectionRange(t,t);else if(e.createTextRange){var a=e.createTextRange();a.collapse(!0),a.moveEnd("character",t),a.moveStart("character",t),a.select()}return e}return{restrict:"A",require:"^ngModel",link:function(n,r,s,l){var o=s.priceFormatter||0,c=/[^0-9]/g;o&&(c=/[^0-9.]/g),r=t(r),l.$parsers.push(function(t){var n,s,l,d=t.replace(c,""),u=r.val().length,p=r.get(0);return t?(n=a(p),l=e("priceFormatter")(d,o,".",!0,!0)||"0",r.val(l),s=r.val().length,i(p,n+(s-u)),d):t=0}),l.$formatters.push(function(t){return e("priceFormatter")(t,o,".",!0,!0)})}}}])}(angular,jQueryApp),function(e){"use strict";e.module("priceFormatter").filter("priceFormatter",[function(){var e=function(e,t,a,i,n){if(t=t||0,i=i||".",a=a||" ",0===t&&isNaN(parseInt(e,10))||isNaN(parseFloat(e))||0===e)return 0;var r,s,l,o=e<0?"-":"",c=e.toString().replace(/\s/g,"").replace(/^0+/g,"").split("."),d=c[0],u=!!t&&c[1],p=d.length>3?d.length%3:0;return n&&c[1]&&0===parseInt(c[1],10)&&(u=!1),t&&e===c[0]+"."&&(u=!0),u&&c[1].length>t&&(c[1]=c[1].substr(0,t)),r=p?d.substr(0,p)+a:"",s=d.substr(p).replace(/(\d{3})(?=\d)/g,"$1"+a),l=u?i+c[1]:"",r||s||(r="0"),o+r+s+l};return function(t,a,i,n,r){return a=a||0,i=i||",",r="string"==typeof r?r:" ",e(t,a,r,i,n)}}])}(angular),function(e){e.module("inputOnly",[])}(angular),function(e){"use strict";e.module("inputOnly").directive("inputCapitalize",[function(){return{restrict:"A",require:"ngModel",link:function(e,t,a,i){var n=function(e){void 0===e&&(e="");var t=e.toUpperCase();return t!==e&&(i.$setViewValue(t),i.$render()),t};i.$parsers.push(n),n(e[a.ngModel])}}}])}(angular),function(e){"use strict";e.module("inputOnly").directive("inputFloat",[function(){return{restrict:"A",require:"ngModel",link:function(e,t,a,i){var n=a.maxPrecision?+a.maxPrecision+1:null;i.$parsers.push(function(e){var t,a="";if(""===e||void 0===e||null===e)return e;var r=(e+"").replace(/[^0-9.,]/g,"");return r=r.replace(",","."),r=r.replace(/(\.[0-9]*)(\.+)/g,"$1"),r=r.replace(/^\./g,""),n&&(t=r.indexOf("."),t!==-1&&(a=r.substr(t),a.length>n&&(r=r.slice(0,n-a.length)))),r!=e&&(i.$setViewValue(r),i.$render()),r})}}}])}(angular),function(e){"use strict";e.module("inputOnly").directive("inputInteger",[function(){return{restrict:"A",require:"ngModel",link:function(e,t,a,i){i.$parsers.push(function(e){var t;return""===e||void 0===e||null===e?e:(t=(e+"").replace(/[^0-9]/g,""),t!=e&&(i.$setViewValue(t),i.$render()),t)})}}}])}(angular),function(e){"use strict";e.module("inputOnly").directive("inputOnly",[function(){return{restrict:"A",priority:2,require:"ngModel",link:function(e,t,a,i){var n=new RegExp(a.inputOnly,"g");n&&i.$parsers.push(function(e){var t,a="";return""===e||void 0===e||null===e?e:(t=(e+"").match(n),t&&(a=t.join("")),a!=e&&(i.$setViewValue(a),i.$render()),a)})}}}])}(angular),function(e,t){"use strict";e.module("inputOnly").directive("inputPhone",["$timeout",function(e){function a(e){if(!e.selectionStart&&document.selection){var t=document.selection.createRange().duplicate();return t.moveEnd("character",e.value.length),""===t.text?e.value.length:e.value.lastIndexOf(t.text)}return e.selectionStart}function i(e,t){if(e.setSelectionRange)e.setSelectionRange(t,t);else if(e.createTextRange){var a=e.createTextRange();a.collapse(!0),a.moveEnd("character",t),a.moveStart("character",t),a.select()}return e}return{restrict:"A",require:"ngModel",link:function(n,r,s,l){var o,c=/\+7\(\d{0,3}\)[\d]{0,3}-[\d]{0,4}/,d="+7()-";r=t(r),l.$parsers.push(function(t){var n,s,u,p=r.get(0);return null===t&&(t=""),n=c.exec(t+""),n=n?n[0]:o?o:d,o=n,s=a(p),n===d&&(u=3),6===s&&(u=7),10===s&&(u=11),11===s&&o.length>=n.length&&(u=10),7===s&&o.length>=n.length&&(u=6),void 0!==u&&e(function(){i(p,u)},0),n!=t&&(l.$setViewValue(n),l.$render()),n}),r.focus(function(){var a=t(this).val();a||(l.$setViewValue(d),l.$render(),n.$apply(function(){e(function(){i(r.get(0),3)},0)}))})}}}])}(angular,jQueryApp),function(e){"use strict";e.module("inputOnly").directive("inputReplace",[function(){return{priority:1e4,restrict:"A",require:"ngModel",link:function(t,a,i,n){var r=t.$eval(i.inputReplace);if(!e.isObject(r))throw new Error("input-replace is not a object!");n.$parsers.push(function(t){if(""===t||void 0===t||null===t)return t;var a=t;return e.forEach(r,function(e,t){a=a.replace(new RegExp(t,"g"),e)}),a!=t&&(n.$setViewValue(a),n.$render()),a})}}}])}(angular),function(e){"use strict";e.module("inputOnly").directive("inputVinNumber",["vinNumberService",function(e){return{restrict:"A",require:"ngModel",link:function(t,a,i,n){var r=e.mappedAlph;n.$parsers.push(function(t){var i,s;if(""===t||void 0===t||null===t)return t;i=t.split("");for(var l=0,o=i.length;o>l;l++)for(var c in r)r.hasOwnProperty(c)&&r[c]===i[l]&&(i[l]=c);return i=i.join("").toUpperCase().replace(/[^0-9A-HJ-NPR-Z]/g,""),i!==t&&(n.$setViewValue(i),n.$render()),s=e.vinIsValid(i),a[s?"removeClass":"addClass"]("js-vin-is-invalid"),a.parent()[s?"removeClass":"addClass"]("js-vin-is-invalid"),i})}}}])}(angular),function(e){"use strict";e.module("inputOnly").service("vinNumberService",[function(){function e(e){for(var t={A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,J:1,K:2,L:3,M:4,N:5,P:7,R:9,S:2,T:3,U:4,V:5,W:6,X:7,Y:8,Z:9,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,0:0},a=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2],i=0,n=0;n<e.length;n++)i+=t[e[n]]*a[n];var r=i%11;return 10==r&&(r="X"),r==e[8]}function t(t){var a="[a-hj-npr-z0-9]",i=new RegExp("^"+a+"{8}[0-9xX]"+a+"{8}$","i");return null!==t.match(i)&&e(t)}var a={q:"й",w:"ц",e:"у",r:"к",t:"е",y:"н",u:"г",i:"ш",o:"щ",p:"з",a:"ф",s:"ы",d:"в",f:"а",g:"п",h:"р",j:"о",k:"л",l:"д",z:"я",x:"ч",c:"с",v:"м",b:"и",n:"т",m:"ь",W:"Ц",E:"У",R:"К",T:"Е",Y:"Н",U:"Г",I:"Ш",O:"Щ",P:"З",A:"Ф",S:"Ы",D:"В",F:"А",G:"П",H:"Р",J:"О",K:"Л",L:"Д",Z:"Я",X:"ч",C:"С",V:"М",B:"И",N:"Т",M:"Ь"};return{vinIsValid:t,mappedAlph:a}}])}(angular),function(e){e.module("ngThumb",[])}(angular),function(e){"use strict";e.module("ngThumb").directive("ngThumb",["$window","ngThumb",function(t,a){var i={support:!(!t.FileReader||!t.CanvasRenderingContext2D),isFile:function(a){return e.isObject(a)&&a instanceof t.File},isImage:function(e){var t="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return"|jpg|png|jpeg|bmp|gif|".indexOf(t)!==-1},isPdf:function(e){var t="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return"|pdf|".indexOf(t)!==-1}},n=a.pdfIcon;return{restrict:"A",template:"<canvas/>",link:function(e,t,a){function r(e){var t=new Image;t.onload=s,t.src=i.isPdf(l.file)?n:e.target.result}function s(){var e=l.width||this.width/this.height*l.height,t=l.height||this.height/this.width*l.width;o.attr({width:e,height:t}),o[0].getContext("2d").drawImage(this,0,0,e,t)}if(i.support){var l=e.$eval(a.ngThumb);if(i.isFile(l.file)&&(i.isImage(l.file)||i.isPdf(l.file))){var o=t.find("canvas"),c=new FileReader;c.onload=r,c.readAsDataURL(l.file)}}}}}])}(angular),function(e,t){"use strict";e.module("ngThumb").provider("ngThumb",function(){var e="",t=[function(){return{pdfIcon:e}}];return{$get:t,setPdfIcon:function(t){e=t}}})}(angular,jQueryApp),function(e){e.module("jDatePicker",[])}(angular),function(e,t){"use strict";e.module("jDatePicker").directive("jdatepicker",["$parse","$timeout","jdatepicker",function(a,i,n){return{restrict:"A",priority:2,require:"ngModel",link:function(r,s,l,o){function c(a){var i,n=a,l=t.datepicker.dpDiv,d=l.find(".ui-datepicker-year").val();return e.isString(x)&&(e.isDate(a)||(n=t.datepicker.parseDate(y,a)),n=t.datepicker.formatDate(x,n),
d!=t.datepicker._curInst.selectedYear)?(i=new Date(n),i.setFullYear(d),s.datepicker("setDate",i),c(i),void s.blur()):(o.$setViewValue(n),void r.$apply())}function d(t){var a,i;if(e.isDate(t)){if(I&&t>new Date)return!1;if(D&&t<(new Date).setDate((new Date).getDate()))return!1;if(g.yearRange&&T)return a=g.yearRange.split(":",2),i=t.getFullYear(),i>=a[0]&&i<=a[1]}return!0}function u(e){var t=new Date(l.jdatepickerMinDate).getTime(),a=new Date(l.jdatepickerMaxDate).getTime();if(new Date(e).getTime()){if(t&&t>e)return!1;if(a&&a<e)return!1}return!0}function p(e){var t=String.fromCharCode(null===e.charCode?e.keyCode:e.charCode);return e.ctrlKey||e.metaKey||t<" "||!_||_.indexOf(t)>-1||void 0!==C[t]}var m,_,g,v=n.getDefaults(),f=(new Date).getFullYear(),h=l.jdatepickerClass||v.class,b=void 0!==l.jdatepickerYearCount?parseInt(l.jdatepickerYearCount,10):v.yearCount,y=l.jdatepickerDateFormat||v.dateFormat,w=l.jdatepickerPDateFormat||v.pDateFormat||y,x=l.jdatepickerMDateFormat||v.mDateFormat,k=l.jdatepickerYearRange||v.yearRange||f-b+":"+f,P=l.jdatepickerValidator||null,C=void 0!==l.jdatepickerReplacedSymbols?l.jdatepickerReplacedSymbols:v.replacedSymbols,S=l.jdatepickerInputRule||v.inputRule,I=!!l.jdatepickerOnlyPast,D=!!l.jdatepickerOnlyFuture,T=void 0!==l.jdatepickerValidateYearRange?r.$eval(l.jdatepickerValidateYearRange):v.validateYearRange;s=t(s),t.datepicker.setDefaults(v),g={dateFormat:y,yearRange:k,onSelect:function(e,t){t.inline=!0,c(e)},showMonthAfterYear:!0,onClose:function(e,t){t.inline=!1}},e.isObject(C)&&(g.constrainInput=!1),e.isString(h)&&""!==h&&(g.beforeShow=function(){t("#ui-datepicker-div").addClass(h)}),i(function(){s.datepicker(g)},0),P&&(P=a(P),m=/\(([\dA-Za-z_$]*)(\)|,\s)/.exec(l.jdatepickerValidator),o.$parsers.unshift(function(e){var t={};return null!==m&&(t[m[1]]=e),o.$valid&&o.$setValidity(l.name,P(r,t)),e}),o.$formatters.unshift(function(e){var t={};return null!==m&&(t[m[1]]=e),o.$valid&&o.$setValidity(l.name,P(r,t)),e})),o.$parsers.unshift(function(e){return o.$setValidity(l.name,function(e){var a;try{a=t.datepicker.parseDate(y,e)}catch(i){try{a=t.datepicker.parseDate(w,e)}catch(e){return!1}return d(a)&&u(a)}return d(a)&&u(a)}(e)),e}),o.$formatters.unshift(function(a){return o.$setValidity(l.name,function(a){var i;if(e.isDate(a))return d(a);if(e.isString(a)){try{i=t.datepicker.parseDate(w,a)}catch(e){try{i=t.datepicker.parseDate(y,a)}catch(e){return!1}return d(i)&&u(i)}return d(i)&&u(i)}return!0}(a)),a}),o.$parsers.unshift(function(a){var i,n=w;try{i=t.datepicker.parseDate(y,a)}catch(e){return a}return e.isString(x)&&(n=x),t.datepicker.formatDate(n,i)}),o.$formatters.unshift(function(a){var i;if(e.isDate(a))return t.datepicker.formatDate(y,a);if(e.isString(a)){try{i=t.datepicker.parseDate(w,a)}catch(e){i=t.datepicker.parseDate(y,a)}return t.datepicker.formatDate(y,i)}return a}),e.isObject(C)&&(_=t.datepicker._possibleChars(y),s.on("keypress",p),o.$parsers.unshift(function(t){var a;return""===t||void 0===t||null===t?t:(a=t,e.forEach(C,function(e,t){a=a.replace(new RegExp(t,"g"),e)}),a!=t&&(o.$setViewValue(a),o.$render()),a)})),e.isFunction(S)&&s.on("keyup",function(e){var t,a=s.val(),i=[8,9,16,17,37,39,46];e.ctrlKey||e.metaKey||e.altKey||i.indexOf(e.keyCode)!==-1||(t=S(a),s.val(t),o.$setViewValue(t),s.datepicker("hide"))})}}}])}(angular,jQueryApp),function(e){"use strict";e.module("jDatePicker").provider("jdatepicker",[function(){var t={class:"",yearCount:6,dateFormat:"yy-mm-dd",pDateFormat:null,mDateFormat:null,yearRange:null,maxDate:null,minDate:null,closeText:"Закрыть",prevText:"&#x3C;Пред",nextText:"След&#x3E;",currentText:"Сегодня",monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],dayNamesShort:["вск","пнд","втр","срд","чтв","птн","сбт"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],weekHeader:"Нед",changeMonth:!0,changeYear:!0,firstDay:1,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"",replacedSymbols:null,selectOtherMonths:!0,showOtherMonths:!0,validateYearRange:!0};this.setDefaults=function(a){e.extend(t,a)},this.$get=function(){return{getDefaults:function(){return t}}}}])}(angular),function(e){"use strict";e.module("calculator").controller("calculatorNavigationCtrl",["$scope","$state","calculatorService","$rootScope","calculatorStepsService","moduleType",function(e,t,a,i,n,r){function s(e){return function(){return e.test(t.current.name)}}function l(){return n.bigSteps.getBigStep()}e.calculation=a.calculation,e.navigation=function(){var e=[{active:function(){return s(/index.calculator/)()&&"first"===l().name},link:"index.calculator."+i.calcType,title:"Ваш автомобиль",onClick:function(){n.bigSteps.setBigStep("first")},additional_conditions:{},icon:"car"},{active:function(){return s(/index.calculator/)()&&"second"===l().name},link:"index.calculator."+i.calcType,title:"Параметры расчета",onClick:function(){n.bigSteps.setBigStep("second")},condition_disabled:function(){var e=a.calculation;return!parseInt(e.car_cost)&&"third"!==l().name},additional_conditions:{},icon:"options"},{active:function(){return"third"===l().name},onClick:function(){n.bigSteps.setBigStep("third")},link:"index.addingDocuments",title:"Тариф",condition_disabled:function(){return["third","fourth"].indexOf(l().name)===-1&&!a.getSelectedResult()},additional_conditions:{},icon:"tasks"},{active:function(){return"fourth"===l().name},onClick:function(){n.bigSteps.setBigStep("fourth")},isHidden:function(){},link:"index.ordering",title:"Заказ",condition_disabled:function(){return!a.getSelectedResult()},icon:"checked calendar"}];return"osago"===r&&(e=[{active:function(){return s(/index.calculator/)()&&"first"===l().name},title:"Рассчитайте тариф",onClick:function(){n.bigSteps.setBigStep("first")},icon:"options"},{active:function(){return s(/index.calculator/)()&&"second"===l().name},title:"Добавьте документы",onClick:function(){n.bigSteps.setBigStep("second")},condition_disabled:function(){var e=a.calculation;return!a.getSelectedResult()||!parseInt(e.car_cost)&&"fourth"!==l().name},icon:"file text outline"},{active:function(){return"fourth"===l().name},onClick:function(){n.bigSteps.setBigStep("fourth")},title:"Получите полис",condition_disabled:function(){return["fourth"].indexOf(l().name)===-1},icon:"shopping bag"}]),_.forEach(e,function(e){"function"!=typeof e.isHidden&&(e.isHidden=_.noop),"function"!=typeof e.condition_disabled&&(e.condition_disabled=_.noop),"function"!=typeof e.onClick&&(e.onClick=_.noop)}),e}(),e.goToStep=function(n){var r=a.getSelectedResult();t.go(e.navigation[n].link,{calculationId:e.calculation.id||t.params.calculationId,calcType:i.calcType||"osago",companyId:r&&r.id||t.params.companyId},{reload:!1})}}])}(angular),function(e){"use strict";e.module("calculator").provider("calculator",[function(){var t={id:null,car_cost:0,car_mark:null,car_model_group:null,car_model:null,car_manufacturing_year:null,exploitation_area:null,owner_registration:null,drivers_count:0,driver_set:[],drivers_minimal_age:null,drivers_minimal_experience:null,is_multidrive:!1,target_of_using:null,insurance_duration:null,contributory_scheme:null,payment_type:null,mileage:null,insurable_risk:null,claim_form:null,payment_form:null,deductible_value:null,civil_liability_voluntary_cost:null,car_type:null,insured_object:null,count_years_break_even_insurance:0,calculation_at_date:null,insurance_type:null,has_foreign_registration:!1,maximum_mass:null,seats_number:null,engine_power:null,engine_displacement:null,is_legal_entity:!1,has_trailer:!1,calculation_type:null,is_earlier_insurance:null};this.setDefaults=function(a){e.extend(t,a)},this.$get=function(){return{getDefaults:function(){return t}}}}])}(angular),function(e,t){"use strict";e.module("calculator").directive("goToCalculation",["$state","$rootScope","calculatorService","formationPolicyService","$timeout","formationPolicyStep1Service",function(e,a,i,n,r,s){return{restrict:"AC",scope:{calcType:"@",params:"=goToCalculation",transitionParams:"=",options:"=transitionOptions"},link:function(l,o,c,d){var u=t(o);u.click(function(t){var o=l.options||{},c=o.calcType||a.calcType,d=l.params||{},p=l.transitionParams||{};return!u.hasClass("disabled")&&!u.is(":disabled")&&(t.preventDefault(),a.calcType=c,d.rsa=e.params.rsa,r(function(){(o.resetCalc||o.resetAll)&&(s.resetAll(),i.resetCalculation()),(o.resetPolicy||o.resetAll)&&(s.resetAll(),n.resetCurrentPolicy())},0),void e.go("index.calculator."+c,d,p))})}}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("calculator").directive("moveToStep",["$timeout","calculatorStepsService",function(e,a){return{restrict:"A",template:'<div class="c-change-step"></div>',link:function(i,n,r){var s=t(n),l="forward"===r.moveToStep?"forward":"back";s.addClass("c-change-step--"+l),"back"===l&&s.html('<i class="icon-left-open-big"></i>'),s.click(function(t){return e(function(){a.toPrevSmallStep()},0),!1})}}}])}(angular,jQueryApp),function(e){"use strict";e.module("calculator").service("calculatorStepsService",["stepsService","calculatorService","CONSTS","$filter","brandingConfigs","moduleType",function(t,a,i,n,r,s){function l(){var e=u.bigSteps.getBigStep().name;return t.steps[e]||[]}function o(){return{age:26,expirience:2,is_married:!1,has_children:!1,gender:"M",birth_date:"",driving_experience_started:""}}var c=a.calculation,d={carModel:null,carModelGroup:null,carMark:null},u=this;this.brandSteps=t.steps;var p={first:{name:"first",templateUrl:r.templates.first_big_step||i.pathToModules+"shared/calculatorSteps/views/first_big_step.html"},second:{name:"second",templateUrl:function(){var e="C";return"osago"===s&&(e="O"),i.pathToModules+s+"/calculatorSteps"+e+"/views/second_big_step.html"}()},third:{name:"third",templateUrl:r.templates.third_big_step||i.pathToModules+"shared/carFilter/views/third_big_step.html"},fourth:{name:"fourth",templateUrl:r.templates.fourth_big_step||i.pathToModules+"shared/carFilter/views/fourth_big_step.html"}};this.bigsStepsTepmplates=p;var m={year:{name:"year",clearStep:function(){c.car_manufacturing_year=null},toNextStep:function(){c.car_manufacturing_year=u.calculationInterParams.car_manufacturing_year},getLabelTitle:function(){return c.car_manufacturing_year?c.car_manufacturing_year+" г.в.":null},templateUrl:i.pathToModules+"shared/calculatorSteps/views/step.year.html"},car_mark:{name:"car_mark",clearStep:function(){c.car_mark=null,d.carMark=null},toNextStep:function(){c.car_mark=u.calculationInterParams.car_mark},getLabelTitle:function(){return d.carMark&&d.carMark.title},templateUrl:i.pathToModules+"shared/calculatorSteps/views/step.car_mark.html"},car_model_group:{name:"car_model_group",clearStep:function(){c.car_model_group=null,d.carModelGroup=null},toNextStep:function(){c.car_model_group=u.calculationInterParams.car_model_group},getLabelTitle:function(){return d.carModelGroup&&d.carModelGroup.title},templateUrl:i.pathToModules+"shared/calculatorSteps/views/step.car_model_group.html"},car_model:{name:"car_model",clearStep:function(){c.car_model=null,d.carModel=null},toNextStep:function(){c.car_model=u.calculationInterParams.car_model},getLabelTitle:function(){return d.carModel&&d.carModel.title},templateUrl:i.pathToModules+"shared/calculatorSteps/views/step.car_model.html"},engine_power:{name:"engine_power",clearStep:function(){c.engine_power=null},toNextStep:function(){c.engine_power=u.calculationInterParams.engine_power},getLabelTitle:function(){return c.engine_power?c.engine_power+" л.с.":null},templateUrl:r.templates.engine_power||i.pathToModules+"shared/calculatorSteps/views/step.engine_power.html"},sms_verification:{name:"sms_verification",clearStep:function(){c.client_name=null,c.client_phone=null},toNextStep:function(){c.client_name=u.calculationInterParams.client_name,c.client_phone=u.calculationInterParams.client_phone},getLabelTitle:function(){return c.client_name?c.client_name+" ("+c.client_phone+")":null},templateUrl:r.templates.sms_verification||i.pathToModules+"shared/carFilter/views/sms_step_osago.html"},exploitation_area:{name:"exploitation_area",clearStep:function(){c.exploitation_area=null},toNextStep:function(){c.exploitation_area=u.calculationInterParams.exploitation_area},getLabelTitle:function(){return c.exploitation_area?this.calculationInterParams.exploitation_area_title:null}.bind(this),templateUrl:r.templates.car_cost||i.pathToModules+"shared/calculatorSteps/views/step.exploitation_area.html"},contributory_scheme:{name:"contributory_scheme",clearStep:function(){c.contributory_scheme=null},toNextStep:function(){c.contributory_scheme=u.calculationInterParams.contributory_scheme},getLabelTitle:function(){return c.contributory_scheme?this.calculationInterParams.contributory_scheme:null}.bind(this),templateUrl:r.templates.car_cost||i.pathToModules+"shared/calculatorSteps/views/step.contributory_scheme.html"},car_cost:{name:"car_cost",clearStep:function(){c.car_cost=null},toNextStep:function(){c.car_cost=u.calculationInterParams.car_cost},getLabelTitle:function(){return c.car_cost?n("priceFormatter")(c.car_cost,0)+" руб.":null},templateUrl:r.templates.car_cost||i.pathToModules+"shared/calculatorSteps/views/step.car_cost.html"},mileage:{name:"mileage",clearStep:function(){c.mileage=null},toNextStep:function(){c.mileage=u.calculationInterParams.mileage},getLabelTitle:function(){return c.mileage?n("priceFormatter")(c.mileage,0)+" км.":null},templateUrl:r.templates.mileage||i.pathToModules+"shared/calculatorSteps/views/step.mileage.html"},owner_registration:{name:"owner_registration",clearStep:function(){c.owner_registration=null},toNextStep:function(){c.owner_registration=u.calculationInterParams.owner_registration},templateUrl:i.pathToModules+"shared/calculatorSteps/views/step.owner_registration.html"},drivers_count:{name:"drivers_count",clearStep:function(){c.drivers_count=null,u.calculationInterParams.drivers_count=null},toNextStep:function(){c.drivers_count=u.calculationInterParams.drivers_count.id},getLabelTitle:function(){return u.calculationInterParams.drivers_count&&u.calculationInterParams.drivers_count.title||null},templateUrl:i.pathToModules+"shared/calculatorSteps/views/step.drivers_count.html"},drivers:{name:"drivers",clearStep:function(){},toNextStep:function(){c.driver_set=u.calculationInterParams.drivers},templateUrl:r.templates.drivers||i.pathToModules+"shared/calculatorSteps/views/step.drivers.html"},is_multidrive:{name:"is_multidrive",clearStep:function(){c.is_multidrive=null,c.drivers_minimal_age=null,c.drivers_minimal_experience=null},toNextStep:function(){c.is_multidrive=!0,c.drivers_minimal_age=u.calculationInterParams.drivers_minimal_age,c.drivers_minimal_experience=u.calculationInterParams.drivers_minimal_experience},templateUrl:r.templates.is_multidrive||i.pathToModules+"shared/calculatorSteps/views/step.is_multidrive.html"},is_earlier_insurance:{name:"is_earlier_insurance",clearStep:function(){c.is_earlier_insurance=null},toNextStep:function(){c.is_earlier_insurance=u.calculationInterParams.is_earlier_insurance},getLabelTitle:function(){return _.isBoolean(c.is_earlier_insurance)?c.is_earlier_insurance?"Ранее был застрахован":"Ранее не страховался":""},templateUrl:r.templates.is_earlier_insurance||i.pathToModules+"shared/calculatorSteps/views/step.is_earlier_insurance.html"},is_credit:{name:"is_credit",clearStep:function(){c.is_credit=null},toNextStep:function(){c.is_credit=u.calculationInterParams.is_credit},getLabelTitle:function(){return _.isBoolean(c.is_credit)?c.is_credit?"Куплен в кредит":"Без кредита":""},templateUrl:i.pathToModules+"shared/calculatorSteps/views/step.is_credit.html"},calculation_type:{name:"calculation_type",clearStep:function(){u.calculationInterParams.calculation_type=null},toNextStep:function(){},getLabelTitle:function(){return u.calculationInterParams.calculation_type&&("full"===u.calculationInterParams.calculation_type?"Точный с КБМ":"Примерный")},templateUrl:i.pathToModules+"shared/calculatorSteps/views/step.calculation_type.html"},"car_settings.tumen":{name:"car_settings.tumen",clearStep:function(){c.car_cost=null,c.mileage=null,c.engine_power=null,c.engine_displacement=null},toNextStep:function(){c.car_cost=u.calculationInterParams.car_cost,c.mileage=u.calculationInterParams.mileage,c.engine_power=u.calculationInterParams.engine_power,c.engine_displacement=u.calculationInterParams.engine_displacement},getLabelTitle:function(){},templateUrl:i.pathToModules+"shared/calculatorSteps/views/step.car_settings.tumen.html"},"policy_settings.tumen":{name:"policy_settings.tumen",clearStep:function(){c.contributory_scheme=null,c.is_under_warranty=null,c.payment_form=null,c.is_new_car=null},toNextStep:function(){c.contributory_scheme=u.calculationInterParams.contributory_scheme,c.is_under_warranty=u.calculationInterParams.is_under_warranty,c.payment_form=[u.calculationInterParams.payment_form],c.is_new_car=u.calculationInterParams.is_new_car},getLabelTitle:function(){},templateUrl:i.pathToModules+"shared/calculatorSteps/views/step.policy_settings.tumen.html"},calc:{name:"calc",clearStep:function(){},toNextStep:function(){}}};e.forEach(t.stepsHacks,function(t,a){m[a]&&(m[a]=e.extend({},m[a],t))}),this.getDefaultDriver=o,this.carAllSelected=d,this.getCurrentCalcType=function(){return this.calculationInterParams.calculation_type}.bind(this);var g={activeState:this.brandSteps.first[0],activeStateSecond:this.brandSteps.second[0],activeBigStep:"first"};this.getActiveStep=function(){return m[g.activeState]},this.getCurrentStepIndex=function(e){var t,a,i=u.bigSteps.getBigStep().name;if("first"===i)t=u.getActiveStep();else{if("second"!==i)return null;t=u.getActiveStepSecond()}return a=l(),_.findIndex(a,function(a){return u.getStepObjectByItem(a)===(e||t.name)})},this.getIndexByStep=function(e){var t=l();return e=u.getStepObjectByItem(e),_.findIndex(t,function(t){return t===e})},this._getToggledStep=function(e,t){var a,i=this.getCurrentStepIndex(t),n=(u.bigSteps.getBigStep().name,l());if(i===-1)throw new Error("The brand doesn't contain this step.");return a=n[i+e],this.getStepObjectByItem(a)},this.getCurrentStep=function(){return u._getToggledStep(0)},this.getNextStep=function(){return u._getToggledStep(1)},this._clearByStep=function(e){var a=this.bigSteps.getBigStep().name;_.findLast(t.steps[a],function(t){var a;return t=u.getStepObjectByItem(t),a=t===e,m[t].clearStep(),a})},this.getStepObjectByItem=function(e){return _.isFunction(e)&&e(c)||e},this._toggleSmallStep=function(e,t){var a=this.bigSteps.getBigStep().name,i=this._getToggledStep(e,t);if(i&&"calc"!==i){if("first"===a)return this.setActiveStep(i);if("second"===a)return this.setActiveStepSecond(i)}if(e<0){if("second"===a&&this.bigSteps.setBigStep("first"),"third"===a||"fourth"===a&&"osago"===s)return this.bigSteps.setBigStep("second");"fourth"===a&&this.bigSteps.setBigStep("third")}e>0&&("first"===a&&this.bigSteps.setBigStep("second"),"second"===a&&this.bigSteps.setBigStep("third"),"third"===a&&this.bigSteps.setBigStep("fourth"))},this.calculationInterParams=e.extend({},{engine_power:c.engine_power||120,exploitation_area:c.exploitation_area||null,calculation_type:null,car_cost:c.car_cost||null,drivers:c.driver_set.length?c.driver_set:[],drivers_count:null,drivers_minimal_age:18,drivers_minimal_experience:0,is_earlier_insurance:null,engine_displacement:1,lastDriverIndex:0,currentDriverIndex:0,contributory_scheme:0,payment_form:null,is_under_warranty:null,is_new_car:null,params:{transmission:"Автомат",drive_of_car:"Полный"}},r.calculationInterParamsDefaults),this.toNextSmallStep=this._toggleSmallStep.bind(this,1),this.toPrevSmallStep=this._toggleSmallStep.bind(this,-1),this.setActiveStep=function(e){var t=this.bigSteps.getBigStep().name;this._clearByStep(e),"first"===t&&(g.activeState=e),"second"===t&&(g.activeStateSecond=e)}.bind(this),this.getActiveStepSecond=function(){return m[g.activeStateSecond]},this.getAllSteps=function(){return m},this.setActiveStepSecond=function(e){g.activeStateSecond=e},this.bigSteps={getBigStep:function(){return p[g.activeBigStep]},setBigStep:function(e){g.activeBigStep=e}}}])}(angular),function(e){e.module("person",[])}(angular),function(e){"use strict";e.module("person").factory("Person",["resources","$q","$http","CONSTS",function(t,a,i,n){function r(e){var t;return t="legal_person"===e._personType?["title"]:["first_name","last_name","patronymic","birth_date","gender"],_.pick(e,t)}var s;return s=function(e){e=e||{},"legal_person"===e.personType?(this._personType="legal_person",this._resourcePrefix=t.legalPerson):(this._personType="natural_person",this._resourcePrefix=t.naturalPerson),this.credential=[],this.contact=[],this.address=[],this.extend(e)},s.prototype.extend=function(t){e.extend(this,t)},s.prototype.get=function(e,t){var a=e||this.id||null;if(null===a)throw new Error("id is null!");return i.get(this._resourcePrefix+"/"+e,t).then(function(e){return this.extend(e.data),e.data}.bind(this))},s.prototype.getCredentialList=function(){return this._getList("credential")},s.prototype.getContactList=function(){return this._getList("contact")},s.prototype.getAddressList=function(){return this._getList("address")},s.prototype._getList=function(e){var t;return this.id?i.get(this._resourcePrefix+"/"+this.id+"/"+e).then(function(t){return this[e]=t.data,this[e]}.bind(this)):(t=a.defer(),t.resolve(this[e]),t.promise)},s.prototype.addCredential=function(e){return this._addItem("credential",e)},s.prototype.addContact=function(e){return this._addItem("contact",e)},s.prototype.addAddress=function(e){return this._addItem("address",e)},s.prototype._addItem=function(t,a){if(!e.isArray(this[t]))throw new Error(t+" of person is not array");return this[t].push(a),a},s.prototype.saveCredentialList=function(){return this._saveList("credential")},s.prototype.saveContactList=function(){return this._saveList("contacts")},s.prototype.saveAddressList=function(){return this._saveList("address")},s.prototype._saveList=function(t,n,r){var s=[],l=this;if(this[t])return e.forEach(this[t],function(a){var o,c="post",d=l._resourcePrefix+"/"+l.id+"/"+t;a.id&&(c="put",d+="/"+a.id),o=i[c](d,a),o.then(function(t){return e.extend(a,t.data),t.data}),e.isFunction(n)&&o.then(n),e.isFunction(r)&&o.catch(r),s.push(o)}),a.all(s)},s.prototype.removeContact=function(e){return this._removeItem("contact",e)},s.prototype.removeAddress=function(e){return this._removeItem("address",e)},s.prototype.removeCredential=function(e){return this._removeItem("credential",e)},s.prototype._removeItem=function(e,t){var n=a.defer();return this[e]&&(t.id?i.delete(this._resourcePrefix+"/"+this.id+"/"+e+"/"+t.id).then(function(){this[e]=_.reject(this[e],function(e){return t===e}),n.resolve(this[e])}.bind(this),function(e){n.reject(e)}):(this[e]=_.reject(this[e],function(e){return t===e}),n.resolve(this[e]))),n.promise},s.prototype.save=function(){var e="post",t=this._resourcePrefix;return this.id&&(e="put",t+="/"+this.id),i[e](t,r(this)).then(function(e){return this.extend(e.data),e.data}.bind(this))},s.prototype.remove=function(){var e=a.defer();return this.id?i.delete(this._resourcePrefix+"/"+this.id):(e.reject("Person hasn't id"),e.promise)},s.prototype.saveAll=function(){var e=a.defer();return this.save().then(function(t){var i=[];i.push(this.saveCredentialList()),i.push(this.saveAddressList()),a.all(i).then(function(a){e.resolve({person:t,credential:a[0],address:a[1]})},function(t){e.reject(t)})}.bind(this),function(t){e.reject(t)}),e.promise},s}])}(angular),function(e){"use strict";e.module("person").service("personService",["$http","$q","CONSTS","resources",function(t,a,i,n){return{getNaturalPerson:function(e){return t.get(n.naturalPerson+"/"+e).then(function(e){return e.data})},getNaturalPersonData:function(e){var i={id:e},r=[];return r.push(t.get(n.naturalPerson+"/"+i.id+"/credential").then(function(e){return e.data})),r.push(t.get(n.naturalPerson+"/"+i.id+"/address").then(function(e){return e.data})),r.push(t.get(n.naturalPerson+"/"+i.id+"/contact").then(function(e){return e.data})),a.all(r).then(function(e){var t=e[0],a=e[1],n=e[2];return i.driver_license=_.find(t,function(e){return 3===e.credential_type}),i.passport=_.find(t,function(e){return 1===e.credential_type}),i.address_registration=_.find(a,function(e){return 1===e.address_type}),i.address_residential=_.find(a,function(e){return 2===e.address_type}),i.contactData=function(){var e=_.find(n,function(e){return 1===e.contact_type}),t=_.find(n,function(e){return 2===e.contact_type});return{phone:e,email:t}}(),i})},saveNaturalPersonFull:function(t){var i={},n=_.pick(t,["first_name","last_name","patronymic","birth_date","gender","id","driving_experience_started"]);return i.person=this.saveNaturalPerson(n),t.driver_license&&(e.extend(t.driver_license,{credential_type:3}),i.driver_license=this.saveNaturalPersonCredential(t.id,t.driver_license)),t.passport&&(e.extend(t.passport,{credential_type:1}),i.passport=this.saveNaturalPersonCredential(t.id,t.passport)),t.contactData&&t.contactData.phone&&t.contactData.phone.data&&(i.phone=this.saveNaturalPersonContact(t.id,e.extend(t.contactData.phone,{contact_type:1}))),t.contactData&&t.contactData.email&&t.contactData.email.data&&(i.email=this.saveNaturalPersonContact(t.id,e.extend(t.contactData.email,{contact_type:2}))),t.address_registration&&(e.extend(t.address_registration,{address_type:1}),i.address_registration=this.saveNaturalPersonAddress(t.id,t.address_registration)),t.address_residential&&(e.extend(t.address_residential,{address_type:1}),i.address_residential=this.saveNaturalPersonAddress(t.id,t.address_residential)),a.all(i).then(function(t){var a=e.extend(t.person,t);return delete a.person,a})},saveNaturalPerson:function(e){var a="post",i=n.naturalPerson;return e.id&&(a="put",i+="/"+e.id),t[a](i,e).then(function(e){return e.data})},saveNaturalPersonCredential:function(e,a){var i="post",r=n.naturalPerson+"/"+e+"/credential";return a.id&&(i="put",r+="/"+a.id),t[i](r,a).then(function(e){return e.data})},saveNaturalPersonAddress:function(e,a){var i="post",r=n.naturalPerson+"/"+e+"/address";return a.id&&(i="put",r+="/"+a.id),t[i](r,a).then(function(e){return e.data})},saveNaturalPersonContact:function(e,a){var i="post",r=n.naturalPerson+"/"+e+"/contact";return a.id&&(i="put",r+="/"+a.id),t[i](r,a).then(function(e){return e.data})}}}])}(angular),function(e){e.module("dropdown",[])}(angular),function(e,t){"use strict";e.module("dropdown").constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function(e){var t=null;this.open=function(n){t||(e.bind("click",a),e.bind("keydown",i)),t&&t!==n&&(t.isOpen=!1),t=n},this.close=function(n){t===n&&(t=null,e.unbind("click",a),e.unbind("keydown",i))};var a=function(e){if(t){var a=t.getToggleElement();e&&a&&a[0].contains(e.target)||t.$apply(function(){t.isOpen=!1})}},i=function(e){27===e.which&&(t.focusToggleElement(),a())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function(t,a,i,n,r,s){var l,o=this,c=t.$new(),d=n.openClass,u=e.noop,p=a.onToggle?i(a.onToggle):e.noop;this.init=function(e){o.$element=e,a.isOpen&&(l=i(a.isOpen),u=l.assign,t.$watch(l,function(e){c.isOpen=!!e}))},this.toggle=function(e){return c.isOpen=arguments.length?!!e:!c.isOpen,c.isOpen},this.isOpen=function(){return c.isOpen},c.getToggleElement=function(){return o.toggleElement},c.focusToggleElement=function(){o.toggleElement&&o.toggleElement[0].focus()},c.$watch("isOpen",function(a,i){s[a?"addClass":"removeClass"](o.$element,d),a?(c.focusToggleElement(),r.open(c)):r.close(c),u(t,a),e.isDefined(a)&&a!==i&&p(t,{open:!!a})}),t.$on("$locationChangeSuccess",function(){c.isOpen=!1}),t.$on("$destroy",function(){c.$destroy()})}]).directive("dropdown",function(){return{controller:"DropdownController",link:function(e,t,a,i){i.init(t)}}}).directive("dropdownToggle",function(){return{require:"?^dropdown",link:function(e,t,a,i){if(i){i.toggleElement=t;var n=function(n){n.preventDefault(),t.hasClass("disabled")||a.disabled||e.$apply(function(){i.toggle()})};t.bind("click",n),t.attr({"aria-haspopup":!0,"aria-expanded":!1}),e.$watch(i.isOpen,function(e){t.attr("aria-expanded",!!e)}),e.$on("$destroy",function(){t.unbind("click",n)})}}}})}(angular,jQueryApp),function(e){e.module("UIElements",[])}(angular),function(e,t){"use strict";e.module("UIElements").directive("inputSlider",["$filter",function(a){function i(i,n,r,s){function l(e){p.slider({min:u?0:f,max:u||h,step:v,slide:function(t,a){e?s.$setViewValue(e[a.value].id):s.$setViewValue(Math.floor(a.value/v)*v)},create:function(){c(f,h),s.$viewValue&&o(s.$viewValue)}})}function o(e){b?b.then(function(t){e="null"===e?null:e,_.find(t,function(t,a){if(t.id==e)return p.slider("option","value",a),!0})}):p.slider("option","value",e)}function c(e,t){b||(p.slider("option","min",e),p.slider("option","max",t)),r.isSum&&(e=a("priceFormatter")(e),t=a("priceFormatter")(t)),m.text(e),g.text(t),p.removeClass("hidden")}function d(){f&&h?c(f,h):p.addClass("hidden")}var u,p=t(n),m=p.find(".js-slider-min"),g=p.find(".js-slider-max"),v=r.sliderStep?r.sliderStep>>0:1e3,f=r.defaultMin?r.defaultMin>>0:0,h=r.defaultMax?r.defaultMax>>0:1e6,b=r.slideItems?i.$eval(r.slideItems):null;p.addClass("b-input-slider"),_.isPromise(b)?(p.addClass("b-input-slider__range"),b.then(function(e){f=_.head(e).title,h=_.last(e).title,u=e.length-1,v=1,l(e)})):l(),i.$watch(function(){return i.$eval(r.inputSlider)},function(t,a){t&&!e.equals(t,a)&&(p.slider("option","value",t.sum),t.maxSum&&t.minSum?(p.slider("option","min",t.minSum),p.slider("option","max",t.maxSum),c(t.minSum,t.maxSum)):d())},!0),i.$watch(function(){return s.$viewValue},function(e,t){o(e)})}return{restrict:"EA",require:"ngModel",link:i,scope:!1,template:'<div class="b-input-slider_range"><span class="b-input-slider_min js-slider-min"></span><span class="b-input-slider_max js-slider-max"></span></div>'}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("UIElements").directive("semCheckbox",["$compile",function(a){var i=100;return{restrict:"EA",require:"ngModel",replace:!0,scope:!1,template:'<div class="ui checkbox"><input type="checkbox" tabindex="0" class="hidden sem-checkbox"><label></label></div>',compile:function(n,r,s){var l,o=t(n),c=o.find(".sem-checkbox"),d=o.find("label"),u=r.semId,p="sem-id-"+i++;return o.removeAttr("sem-checkbox"),e.forEach(r.$attr,function(e,t){["class","semType","style"].indexOf(t)===-1?(c.attr(e,r[t]),o.removeAttr(e)):r[t]&&o.addClass(r[t])}),"radio"===r.semType&&c.attr("type","radio"),u?(d.attr("for",u),c.attr("id",u)):(d.attr("for",p),c.attr("id",p)),d.html(r.semLabel),l=a(o),{pre:function(e){l(e)}}}}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("UIElements").directive("semDropdown",["$timeout","$q",function(a,i){return{restrict:"EA",require:"^ngModel",replace:!0,template:'<div><input type="hidden"><i class="dropdown icon"></i><div class="text"><span ng-bind="placeholder"></span></div><div class="menu"></div></div>',scope:{items:"=semDropdownItems",placeholder:"@semDropdownPlaceholder"},link:function(a,n,r,s){function l(t){g.empty(),!a.placeholder||v||f||g.append(d({id:"",title:a.placeholder})),e.forEach(t,function(e){var t={id:e.id,title:e.title,item_type:e.item_type};h&&(t={id:e,title:e}),g.append(d(t))}),t&&t.length||u.addClass("disabled js-was-empty")}function o(e,t){function a(t){var a,i=_.find(t,function(t){var a=h?t:t.id;return a==e});return a=i?h?i:i.id:null,c(a),a}return t?a(t):p.promise.then(a)}function c(t){var a;a=e.isArray(t)?_.map(t,function(e){return e+""}):void 0==t?"":t+"",u.dropdown("set selected",a)}function d(e){var t=e.item_type||"item";return'<div class="'+t+'" data-value="'+e.id+'"><span>'+e.title+"</span></div>"}var u=t(n),p=i.defer(),m=[],g=u.find(".menu"),v=u.hasClass("multiple"),f=u.hasClass("placeholder-is-not-item"),h=!!r.semDropdownSimple;
a.items||console.log("У этого элемента нет поля items ",n[0]),a.items&&(_.isPromise(a.items)?a.items.then(p.resolve):_.isArray(a.items)?p.resolve(a.items):_.isFunction(a.items)&&a.items().then(function(t){return m=t,p.resolve(m.items),a.$watch(function(){return m.changingCondition()},function(t,a){var i,n;if(!e.equals(t,a))return i=m.items,m.action({items:i},t),n=i&&i[0]&&i[0].id,l(i),u.dropdown("refresh"),n&&u.hasClass("js-was-empty")&&(u.removeClass("disabled"),o(s.$viewValue)),"null"!==r.semDropdownDefaultValue&&n?o(s.$viewValue,i)||c(n):void c(null)},!0),t})),u.hasClass("selection")||u.find(".icon.dropdown").remove(),p.promise.then(function(e){l(e),u.dropdown({selectOnKeydown:!1,fullTextSearch:!0,forceSelection:!1,match:"text",onChange:function(e){var t=e;"false"!==e&&"true"!==e||(t=JSON.parse(e)),s.$setViewValue(t)},message:{addResult:"Добавить <b>{term}</b>",count:"{count} выбрано",maxSelections:"Доступно {maxCount}",noResults:"Совпадений не найдено."},className:{label:"ui red label"},action:r.semDropdownAction}),c(s.$viewValue)}),a.items&&(e.isFunction(a.items)||e.isFunction(a.items.then))||a.$watch("items",function(e,t){e&&e.length&&(1!==p.promise.$$state.status?p.resolve(e):l(e),u.hasClass("js-was-empty")&&(u.removeClass("disabled"),o(s.$viewValue)))},!0),a.$watch(function(){return s.$viewValue},function(t,a){var i=u.dropdown("get value");t==i&&!_.isBoolean(t)&&!_.isNumber(t)||e.equals(t,i)||(void 0==t||v?c(s.$viewValue):o(t))})}}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("UIElements").directive("semErrorLabel",["errorLabelProvider",function(e){function a(a,i,n){function r(e){o.text(e.title),e.class&&o.addClass(e.class),o.addClass("sem-error-label")}var s,l,o=t(i),c=n.labelNamespace;if(!c)throw new Error("Не задана область видимости");s=function(){var e=o.siblings("input"),t="attr";return e.length||(e=o.siblings(".ui.input").find("input").eq(0),e.length||(e=o.siblings(".dropdown"),t="data",e.length||(e=o.siblings(".js-label-target")))),e[t]("name")}(),l=e.getLabel(c,s),r(l)}return{restrict:"EA",link:a,replace:!0,template:'<div class="ui top pointing basic label"></div>'}}])}(angular,jQueryApp),function(e,t){"use strict";e.module("UIElements").directive("semPopup",[function(){return{restrict:"EA",scope:{content:"@semPopupContent",title:"@semPopupTitle",variation:"@semPopupVariation",position:"@semPopupPosition"},compile:function(){return{pre:function(e,a,i,n){var r=t(a),s={content:e.content,title:e.title,variation:e.variation,position:e.position?e.position:"top center"};"UNPUT"===a.tagName&&(s.on="focus"),r.popup(s)}}}}}])}(angular,jQueryApp),function(e){"use strict";e.module("UIElements").provider("errorLabelProvider",[function(){var e={title:"Поле не заполнено"},t={fps1:{first_name:{title:"Имя не заполнено"},last_name:{title:"Фамилия не заполнена"},citizenship:{title:"Гражданство не выбрано"},person_document_issue_date:{title:"Дата выдачи документа не заполнена"},document:{title:"Тип документа не выбран"},address_registration:{title:"Не все обязательные поля адреса заполнены"},person_phone:{title:"Телефон не заполнен"}}};this.$get=function(){return{getLabel:function(a,i){return i&&t[a][i]||e}}}}])}(angular),function(e){e.module("appMessage",[])}(angular),function(e){e.module("appMessage").directive("messages",["CONSTS",function(e){return{restrict:"EA",replace:!0,templateUrl:e.pathToModules+"shared/appMessage/views/messages_template.html"}}])}(angular),function(e){e.module("appMessage").factory("Messages",["$rootScope","$timeout",function(e,t){function a(a,r,s,l){var o={type:a,msg:r,close:function(){n(i(this))},isList:l};e.aborting||(e.messages.push(o),void 0!==s&&s>0&&t(o.close,s))}function i(t){return e.messages.indexOf(t)}function n(t){e.messages.splice(t,1)}return e.messages=[],{error:function(e,t,i){a("error",e,t,i)},warning:function(e,t,i){a("warning",e,t,i)},info:function(e,t,i){a("info",e,t,i)},success:function(e,t,i){a("success",e,t,i)}}}])}(angular),function(e){"use strict";e.module("priceSlider",[])}(angular),function(e,t){"use strict";e.module("priceSlider").directive("priceSlider",["$timeout",function(e){function a(a,i,n,r){var s=t(i),l=t(a.popoversQuery),o=t(".car_price-bg-line"),c=s.slider({min:a.minCarPrice||0,max:a.maxCarPrice||1e6,step:1e3,slide:function(e,t){r.$setViewValue(1e3*Math.floor(t.value/1e3)),t.handle&&o.css("width",t.handle.style.left)},change:function(t,a){e(function(){a.handle&&o.css("width",a.handle.style.left)},0)},create:function(e,a){t(this).find(".ui-slider-handle").append(l)}});a.$watch(function(){return r.$viewValue},function(e,t){e&&e!==t&&(c.slider("value",e),a.modelCarCost=e)}),a.$watch("minCarPrice",function(e){void 0!==e&&(s.slider("option","min",+(e||0)),c.slider("value",r.$viewValue))}),a.$watch("maxCarPrice",function(e){void 0!==e&&(s.slider("option","max",+(e||0)),c.slider("value",r.$viewValue))}),a.changeModelCarCost=function(){r.$setViewValue(a.modelCarCost)},a.keyupModelCarCost=function(e){13===e.keyCode&&a.changeModelCarCost()},a.$on("$destroy",function(e){s.slider("destroy")})}return{restrict:"EA",require:"ngModel",link:a,scope:{minCarPrice:"=",maxCarPrice:"=",popoversQuery:"="},template:'<div hidden><div class="car_price-popover"><input price-formatter type="text" ng-model="modelCarCost" ng-keyup="keyupModelCarCost($event)" ng-blur="changeModelCarCost()" class="car_price-popover-input"><span class="car_price-popover-triangle"></span></div></div><div class="car_price-bg-line"></div><div class="car_price-min_value">{{(minCarPrice) | priceFormatter}}р.</div><div class="car_price-max_value">{{(maxCarPrice) | priceFormatter}}р.</div>'}}])}(angular,jQueryApp),function(e){"use strict";e.module("dadata",[])}(angular),function(e,t){"use strict";e.module("dadata").directive("dadata",["$timeout",function(e){function a(a,i,n){function r(e){o.append(t("<div/>").text(e)),o.show()}var s=n.dadataType,l=t(i),o=l.find(".js-dadata-messages");o.hide(),t(i).find("[dadata-target]").suggestions({serviceUrl:"https://dadata.ru/api/v2",token:"840fc8bdabac6c26db9271f4a37906560d23e690",type:s.toUpperCase(),onSelect:function(t){var i=t.data;o.empty(),o.hide(),"address"===s&&(e(function(){a.targetObj.full=t.value},200),a.targetObj.street=i.street_with_type||null,a.targetObj.city=i.region_with_type||null,a.targetObj.kladr=i.kladr_id||null,a.targetObj.house=i.house||null,a.targetObj.housing=i.block||null,a.targetObj.flat=i.flat||null,a.targetObj.postal_index=i.postal_code||null,a.targetObj.house||r("Введите номер дома."),a.targetObj.city||r("Введите название города или области."),a.targetObj.street||r("Введите название улицы."))}})}return{restrict:"A",link:a,scope:{targetObj:"=dadata"}}}])}(angular,jQueryApp),function(e){e.module("mainContent",[])}(angular),function(e){e.module("carFilter",[])}(angular),function(e){"use strict";e.module("carFilter").controller("carFilterCtrl",["$scope","Dictionary","$rootScope","policyOrderingService","calculatorService","calculatorStepsService","CONSTS","Messages","$http","addingDocumentsService","moduleType",function(e,t,a,i,n,r,s,l,o,c,d){function u(e){var t=[];for(var a in e)t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return t.join("&")}function p(){var t=(new Date).getFullYear()-e.calculation.car_manufacturing_year;e.calculationInterParams.mileage=e.calculationInterParams.mileage||2e4*t}function m(t){t&&(e.calculationInterParams.exploitation_area=t.id,e.calculationInterParams.exploitation_area_title=t.title)}var g=new Date,v=a.currentBrand;e.calculatorParams=n.calculatorOtherParams,e.sendLetterBeforeOrder=i.sendLetterBeforeOrder,e.carFilterStep=1,e.selectedCar={},e.calculation=n.calculation,e.carFilterTemplates=r.bigsStepsTepmplates,e.clientParams={client_name:"",client_phone:"",sms_is_visible:!1,client_params_are_disabled:!1},e.showSMSform=function(){e.clientParams.client_params_are_disabled=!0,e.clientParams.send_sms_text=!0,e.clientParams.sms_is_visible=!0,e.calculation.client_name=e.clientParams.client_name,e.calculation.client_phone=e.clientParams.client_phone,o({url:s.proxyPathC+"smsc/sendcode.php",method:"POST",transformRequest:u,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:{phone_no:e.clientParams.client_phone}}).then(function(t){_.isString(t.data)&&/(отправлен)/.test(t.data)&&(e.clientParams.sms_is_visible=!0),e.clientParams.client_params_are_disabled=!1})},e.showSMSformOsago=function(){e.calculationInterParams.client_params_are_disabled=!0,e.calculation.client_name=e.calculationInterParams.client_name,e.calculation.client_phone=e.calculationInterParams.client_phone,o({url:s.proxyPathC+"smsc/sendcode.php",method:"POST",transformRequest:u,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:{phone_no:e.calculationInterParams.client_phone}}).then(function(t){_.isString(t.data)&&/(отправлен)/.test(t.data)&&(e.calculationInterParams.sms_is_visible=!0),e.calculationInterParams.client_params_are_disabled=!1})},e.confirmCodeOsago=function(){e.calculationInterParams.sms_button_is_disabled=!0,e.calculationInterParams.confirm_code_is_incorrect=!1,o({url:s.proxyPathC+"smsc/verify.php",method:"POST",transformRequest:u,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:{code:e.calculationInterParams.sms_code}}).then(function(t){_.isString(t.data)&&/(Код проверки верный)/.test(t.data)?"osago"===c?e.toNextStep("sms_verification"):e.calculationInterParams.resultsAreVisible=!0:e.calculationInterParams.confirm_code_is_incorrect=!0,e.calculationInterParams.sms_button_is_disabled=!1})},e.calculateKaskoCarFilter=function(){e.$parent.calculateKasko()},e.confirmCode=function(){e.clientParams.sms_button_is_disabled=!0,e.calculatorParams.confirm_code_is_incorrect=!1,o({url:s.proxyPathC+"smsc/verify.php",method:"POST",transformRequest:u,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:{code:e.clientParams.sms_code}}).then(function(t){_.isString(t.data)&&/(Код проверки верный)/.test(t.data)?(e.calculatorParams.resultsAreVisible=!0,a.currentBrand.sendLetterBeforeOrder&&e.sendLetterBeforeOrder()):e.calculatorParams.confirm_code_is_incorrect=!0,e.clientParams.sms_button_is_disabled=!1})},"laura"==a.currentBrandName?e.driversChanging=[{id:1,title:"1 водитель"},{id:2,title:"2 водителя"},{id:3,title:"3 водителя"},{id:4,title:"4 водителя"}]:e.driversChanging=[{id:1,title:"1 водитель"},{id:2,title:"2 водителя"},{id:3,title:"3 водителя"},{id:4,title:"4 водителя"},{id:0,title:"Без ограничений"}],e.bigSteps=r.bigSteps,e.mainRegions=[],e.calculationInterParams=r.calculationInterParams,e.carFilterParams={brandSteps:r.brandSteps,allSteps:r.getAllSteps(),ownerRegistrationViewIsFull:!1,selectedResult:function(){return n.getSelectedResult()},was_clicked:!1,setIsEarlierInsurance:function(t){e.calculationInterParams.is_earlier_insurance=!!t,e.toNextStep("is_earlier_insurance")},setIsCredit:function(t){e.calculationInterParams.is_credit=!!t,e.toNextStep("is_credit")}},e.calcTypes=[{id:"simple",title:"Примерный"},{id:"full",title:"Точный (с данными КБМ водителей)"}],e.toManagerAfterSms=function(){e.clientParams.client_phone?e.sendToManager():e.postCalculateParams.third=!0},e.sendToManagerAfterSms=function(){var t=new FormData,a="";e.calculation.client_name,e.calculation.client_phone;a+="КАСКО.\n",t.append("message",a),d.send(t).then(function(){l.success("Ваш запрос принят. Мы свяжемся с вами в ближайшее время.",6e3)},function(){l.error("Не удалось отправить запрос.",6e3)})},e.onKeypressDecorator=function(e,t){if(13==e.keyCode&&"function"==typeof t)return t},e.setCalculationType=function(t){e.calculationInterParams.calculation_type=t},e.goNextDriver=function(t){var a=t+1;return e.calculationInterParams.driverIsEditing?(e.calculationInterParams.currentDriverIndex=e.calculationInterParams.lastDriverIndex,void(e.calculationInterParams.driverIsEditing=!1)):(e.calculation.driver_set[t]=e.calculationInterParams.drivers[t],void(e.calculationInterParams.drivers_count&&e.calculationInterParams.drivers_count.id===a?e.toNextStep("drivers"):(e.calculationInterParams.currentDriverIndex=a,e.calculationInterParams.lastDriverIndex=a)))},e.toEditDriver=function(t){var a=e.calculationInterParams.currentDriverIndex;e.calculationInterParams.currentDriverIndex=t,e.calculationInterParams.driverIsEditing=!0,e.calculationInterParams.lastDriverIndex=a},e.getActiveButtonClass=function(e){return e&&"active"||""},e.getCurrentStepObject=function(t){return t=r.getStepObjectByItem(t),e.carFilterParams.allSteps[t]},e.getCurrentStepIndex=r.getCurrentStepIndex,e.getIndexByStep=r.getIndexByStep,e.changeDriversCount=function(t){e.calculationInterParams.drivers_count=t,e.calculation.drivers_count=t.id,e.calculationInterParams.drivers.length=0,e.calculation.driver_set.length=0,e.calculation.is_multidrive=!e.calculation.drivers_count,t.id&&(_.times(t.id,function(){e.calculationInterParams.drivers.push(r.getDefaultDriver())}),e.calculationInterParams.currentDriverIndex=0),e.toNextStep("drivers_count")},e.toNextStep=function(t){var a=r.getNextStep(),i=r.getCurrentStep(),n=e.bigSteps.getBigStep().name;return e.carFilterParams.allSteps[i].toNextStep(),!a&&"second"==n&&"kasko"===c||"calc"===a?(e.calculateKaskoCarFilter(),r.toNextSmallStep("calc")):void r.toNextSmallStep(t)},e.isEarlierInsuranceNext=function(){e.calculation.is_earlier_insurance=e.calculationInterParams.is_earlier_insurance,e.setActiveStep("is_earlier_insurance")},e.activeStep={},e.getActiveStep=function(){return e.activeStep=r.getActiveStep(),e.activeStep},e.getActiveStepSecond=function(){return e.activeStepSecond=r.getActiveStepSecond(),e.activeStepSecond},e.setActiveStep=r.setActiveStep,e.toggleOwnerRegistrationView=function(){e.carFilterParams.ownerRegistrationViewIsFull=!e.carFilterParams.ownerRegistrationViewIsFull},e.selectExploitationArea=function(t){t=t||e.calculationInterParams.exploitation_area,e.exploitationArea.then(function(a){var i=_.find(a,function(e){return e.id==t});m(i),e.toNextStep("exploitation_area")})},e.selectOwnerRegistration=function(t){t=t||e.calculationInterParams.owner_registration,e.ownerRegistration.then(function(a){var i=_.find(a,function(e){return e.id==t});m(i),e.toNextStep("owner_registration")})},e.selectIsEarlierInsurance=function(t){e.calculationInterParams.is_earlier_insurance=t,e.isEarlierInsuranceNext()},e.driversDateChanged=function(e){var t=new Date(e.birth_date),a=new Date(e.driving_experience_started),i=(new Date).setFullYear((new Date).getFullYear()-77),n=a<i,r=5679936e5;t.setDate(t.getDate()+1),e.dateIsInvalid=a-t<r||n},e.getYearRange=function(e,t){var a,i,n=new Date;return e=e||0,t=void 0===t?90:t,i=n.getFullYear()-t,a=n.getFullYear()-e,i+":"+a},e.exploitationArea=t.getItems("exploitationArea").then(function(t){t=t.results?t.results:t;var i;return e.calculation.exploitation_area&&(i=_.find(t,function(t){return t.id==e.calculation.exploitation_area}),m(i)),e.mainRegions=_.map(v.exploitation_areas,function(e){return _.find(t,function(t){return t.id===e})}),"tumen"===a.currentBrandName&&_.forEach(e.mainRegions,function(e){e.id===a.currentBrand.exploitation_areas[0]&&(e.title="Тюменская область")}),t}),e.ownerRegistration=t.getItems("ownerRegistration").then(function(t){t=t.results?t.results:t;var a;return e.calculation.owner_registration&&(a=_.find(t,function(t){return t.id==e.calculation.owner_registration}),m(a)),e.mainOwnerRegistrations=_.map(v.owner_registrations,function(e){return _.find(t,function(t){return t.id===e})}),t}),t.getItems("transmission").then(function(t){e.carFilterParams.transmission=t}),t.getItems("driveOfCar").then(function(t){e.carFilterParams.driveOfCar=t}),t.getItems("contributoryScheme").then(function(t){t=t.results||t,e.carFilterParams.contributoryScheme=_.map(a.currentBrand.contributory_schemas,function(e){return _.find(t,function(t){return t.id===e})})}),t.getItems("yesNo").then(function(t){e.carFilterParams.yesNo=t}),e.isInit=!1,e.carSearch={title:""},e.allSelected=r.carAllSelected,e.setCarFilterStep=function(t){e.carFilterStep=t},e.monYears=_.range(g.getFullYear(),g.getFullYear()-55,-1),e.selectMonYear=function(t){_.isNil(t)||(e.calculation.car_manufacturing_year=e.monYears[t]),p(),r.toNextSmallStep("year")},e.$watch("carModel",function(t){t&&(e.monYearAction=e.carModel)},!0)}])}(angular),function(e){"use strict";e.module("carFilter").directive("carFilter",["CONSTS",function(e){return{restrict:"EA",require:"ngModel",scope:{modelCarMark:"=cfModelCarMark",modelCarModel:"=cfModelCarModel",modelCarModelGroup:"=cfModelCarModelGroup",modelCarCost:"=cfModelCarCost",isInvalid:"="},controller:"carFilterCtrl",templateUrl:e.pathToModules+"shared/carFilter/views/car_filter.html"}}])}(angular),function(e){"use strict";e.module("carFilter").directive("carGroupModelsList",["CONSTS","Dictionary","carFilter","calculatorStepsService",function(e,t,a,i){function n(e,a,n,r){e.carModelGroups=[],e.$watch("carMarkId",function(a){a&&(e.carModelGroups=[],t.getItems("carModelGroups",{car_mark:a}).then(function(t){t=t.results?t.results:t,e.$parent.modelGroups=t,e.carModelGroups=t}))}),e.selectCarModelGroup=function(t,a){if(t)return r.$setViewValue(t.id),e.$parent.$parent.allSelected.carModelGroup=t,a||i.toNextSmallStep("car_model_group"),!1},e.$watch(function(){return r.$viewValue},function(a,i){a&&t.getItems("carModelGroups",{car_mark:e.carMarkId}).then(function(t){var i;t=t.results?t.results:t,i=_.find(t,function(e){return e.id===a}),e.selectCarModelGroup(i,!0)})})}var r=a.getDefaults();return{restrict:"EA",require:"ngModel",scope:{orderBy:"@",columns:"@",carMarkId:"=",isInvalid:"=",carManufacturingYear:"="},templateUrl:e.pathToModules+"shared/carFilter/views/car_filter.car_group_models_list.html",compile:function(e,t){return void 0===t.columns&&(t.columns=r.columns),void 0===t.orderBy&&(t.orderBy=r.orderBy),n}}}])}(angular),function(e){"use strict";e.module("carFilter").directive("carManufacturingYears",["CONSTS","carFilter",function(e,t){return{restrict:"EA",require:"ngModel",templateUrl:e.pathToModules+"shared/carFilter/views/car_filter.car_manufacturing_years.html"}}])}(angular),function(e){"use strict";e.module("carFilter").directive("carMarksList",["CONSTS","Dictionary","carFilter","calculatorStepsService",function(t,a,i,n){function r(e){return e>18?e<72?2:3:1}function s(t,a){var i;return!e.isArray(t)||t.length<10?t:(i=_.map(t,function(e){return{id:e.id,rank:e.rank}}),i.sort(function(e,t){return e.rank<t.rank?1:-1}),e.forEach(i,function(e,t){e.popularity=r(t)}),void _.forEach(t,function(e){_.find(i,function(t){var a=e.id===t.id;return a&&(e.popularity=t.popularity),a})}))}function l(t,i,r,l){t.carMarks=[],t.maxCarMarksLimit=9999,t.carMarksLimit=t.limit||o.popularCarMarks.length||o.limit,a.getItems("carMarks").then(function(e){e=e.results||e,s(e),e=e.results?e.results:e,t.carMarks=e,t.maxCarMarksLimit=e.length}),t.toggleAllMarks=function(){t.carMarksLimit=t.carMarksLimit===t.limit?t.maxCarMarksLimit:t.limit},t.selectCarMark=function(e,a){if(e)return l.$setViewValue(e.id),t.$parent.allSelected.carMark=e,a||n.toNextSmallStep("car_mark"),!1},!o.popularCarMarks||e.isArray(o.popularCarMarks)&&0===o.popularCarMarks.length?t.filterByPopularity=function(){return!0}:t.filterByPopularity=function(e){return!!(t.carMarksLimit!==t.limit||t.$parent.carSearch&&t.$parent.carSearch.title)||o.popularCarMarks.indexOf(e.id)!==-1},t.$watch(function(){return l.$viewValue},function(e,i){e!=i&&a.findItem("carMarks",e).then(function(e){t.selectCarMark(e,!0)})})}var o=i.getDefaults();return{restrict:"EA",require:"ngModel",scope:{orderBy:"@",limit:"@",columns:"@",carMarkSelected:"=ngModel",selectHandler:"=",isInvalid:"="},templateUrl:t.pathToModules+"shared/carFilter/views/car_filter.car_marks_list.html",compile:function(e,t){return void 0===t.limit&&(t.limit=o.popularCarMarks.length||o.limit),void 0===t.columns&&(t.columns=o.columns),void 0===t.orderBy&&(t.orderBy=o.orderBy),l}}}])}(angular),function(e){"use strict";e.module("carFilter").directive("carModelsList",["CONSTS","Dictionary","carFilter","calculatorStepsService",function(e,t,a,i){function n(e,a,n,r){e.carModels=[],e.selectedModelId={},e.$watch("carModelGroupId",function(a){a&&(e.carModels=[],t.getItems("carModelsByGroup",{car_mark:e.carMarkId,car_model_group:a}).then(function(t){t=t.results?t.results:t,e.$parent.carModel=t,e.carModels=t}))}),e.selectCarModel=function(t,a){if(t)return a&&(i.toNextSmallStep("car_model"),e.$parent.$parent.isInit=!0),r.$setViewValue(t.id),e.selectedModelId=t.id,e.$parent.$parent.allSelected.carModel=t,!1},e.$watch(function(){return r.$viewValue},function(a,i){a&&t.getItems("carModelsByGroup",{car_mark:e.carMarkId,car_model_group:e.carModelGroupId}).then(function(t){t=t.results?t.results:t;var i;i=_.find(t,function(e){return e.id===a}),e.selectCarModel(i)})})}var r=a.getDefaults();return{restrict:"EA",require:"ngModel",scope:{orderBy:"@",columns:"@",carMarkId:"=",carModelGroupId:"=",isInvalid:"=",carManufacturingYear:"="},templateUrl:e.pathToModules+"shared/carFilter/views/car_filter.car_models_list.html",compile:function(e,t){return void 0===t.columns&&(t.columns=r.columns),void 0===t.orderBy&&(t.orderBy=r.orderBy),n}}}])}(angular),function(e){"use strict";e.module("carFilter").filter("carFilterYears",function(){return function(e,t){var a=[];e=e||[];for(var i=0,n=e.length;n>i;i++){var r=e[i].start_manufacturing_year,s=e[i].stop_manufacturing_year;t>=r&&t<=s&&a.push(e[i])}return a}})}(angular),function(e){"use strict";e.module("carFilter").provider("carFilter",[function(){var t={popularCarMarks:[4740,291,294,4737,297,303,3763,456,312,315,318,324,40612,330,333,336,339,3908,342,35526,345,348,351,354,357,360,363,366,372,375,3911,585,381,384,390,393,396,399,402,411,414,30590,426,429,432,435,438,441,444,447,450,552,33327,555,564,558],limit:72,columns:6,orderBy:"title"};this.setDefaults=function(a){e.extend(t,a)},this.$get=function(){return{getDefaults:function(){return t}}}}])}(angular),function(e){e.module("preCalculator",[])}(angular),function(e){"use strict";e.module("preCalculator").controller("preCalculatorCtrl",["$scope","$state",function(e,t){e.typesToSelect={first:{title:"Планируете приобрести авто в РОЛЬФ",name:"first"},second:{title:"Планируете приобрести авто у другого Дилера",name:"second"}},e.preCalculatorParams={selectedType:null,is_second_step:!1,currentStep:"first",toNextStep:function(){"first"===e.preCalculatorParams.selectedType?t.go("index.postCalculator"):t.go("index.calculator.kasko")}}}])}(angular),function(e){e.module("postCalculator",[])}(angular),function(e){"use strict";e.module("postCalculator").controller("postCalculatorCtrl",["$scope","addingDocumentsService","Messages",function(e,t,a){e.postCalculatorParams={client_name:"",client_phone:"",message:""},e.preSendToManager=function(){var i=new FormData,n="",r=e.postCalculatorParams.client_name,s=e.postCalculatorParams.client_phone,l=e.postCalculatorParams.message;n+="Клиент просит ему перезвонить.\n\n",n+="Имя клиента: "+r+"\n",n+="Телефон клиента: "+s+"\n\n",n+="Сообщение: "+l+"\n\n",i.append("message",n),t.send(i).then(function(){e.postCalculatorParams.button_is_disabled=!0,e.postCalculatorParams.is_visible=!0,a.success("Ваш запрос принят. Мы свяжемся с вами в ближайшее время.",6e3)},function(){e.postCalculatorParams.button_is_disabled=!0,a.error("Не удалось отправить запрос.",6e3)})}}])}(angular),function(e){"use strict";e.module("postCalculator").controller("postCalculatorCtrl",["$scope","addingDocumentsService","Messages",function(e,t,a){e.postCalculatorParams={client_name:"",client_phone:"",message:"",carMark:!1},e.setCarMark=function(t){e.postCalculatorParams.carMark=t},e.preSendToManager=function(){var i=new FormData,n="",r=e.postCalculatorParams.client_name,s=e.postCalculatorParams.client_phone,l=e.postCalculatorParams.carMark;n+="Клиент просит ему перезвонить.\n\n",n+="Имя клиента: "+r+"\n",n+="Телефон клиента: "+s+"\n\n",n+="Марка: "+l+"\n\n",i.append("message",n),i.append("addressType",l),t.send(i).then(function(){e.postCalculatorParams.button_is_disabled=!0,e.postCalculatorParams.is_visible=!0,a.success("Ваш запрос принят. Мы свяжемся с вами в ближайшее время.",6e3)},function(){e.postCalculatorParams.button_is_disabled=!0,a.error("Не удалось отправить запрос.",6e3)})}}])}(angular),function(e){e.module("calculatorSteps",[])}(angular),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.kasko/calculatorC/views/calculation.form.html",'<div ng-include="templates.step_2" ng-if="[\'first\', \'second\'].indexOf(bigSteps.getBigStep().name) !== -1"></div><div ui-view="step_3"></div><div ui-view="step_4" ng-if="getCurrentCalcType() === \'full\'"></div><div ui-view="step_5" ng-if="getCurrentCalcType() === \'simple\'"></div><div ui-view="step_6" ng-show="getCurrentCalcType()"></div><div ng-include="templates.program_list" class="js-kasko-result" ng-show="params.resultsAreVisible && bigSteps.getBigStep().name === \'third\'"></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.kasko/calculatorC/views/calculation.program_list.html",'<div ng-include="templates.program_list_manager" class="mt60"></div><div class="c-tac b-content-loading mt40" ng-if="!calculationResult.length"><i class="spinner loading icon big grey" tabindex="0" style="font-size: 40px;"></i></div><div class="ui form b-full-width-bg_white mt70 pos-rel" ng-if="calculationResult.length"><div move-to-step=""></div><div class="p20"><div class="b-results"><div class="ui grid five column stackable"><div class="b-result-kasko column pb80 pt20" align="center" ng-repeat="result in calculationResult | limitTo:5" ng-class="\'b-result-kasko--index-\' + $index"><div><div class="b-result-kasko_best-price"><span>Лучшая цена!</span></div><div class="b-result-kasko_head" title="{{result.insurance_company.title}}"><div class="b-result-kasko_insurance_company-logo mb5"><img ng-src="{{result.company_logo}}" alt=""></div><div class="b-result-kasko_insurance_company-title mb20 mt15"><h3><span ng-bind="result.insurance_company.title"></span></h3></div></div><div class="b-result-kasko_sum mt10 mb20 nowrap"><h3><span><span ng-bind="result.program.sum | priceFormatter:0:\'\':false"></span>. <small ng-bind="result.program.sum | fractionalFormatter:2"></small> руб.</span></h3></div><div class="b-result-kasko_option_set"><div ng-repeat="option in result.program.option_set | filter:{\'is_active\': true}"><span ng-bind="option.title"></span></div></div><div class="b-result-kasko_actions" align="center"><button class="ui button green small" title="Перейти к заказу" ng-click="selectResult(result.id)" onclick="yaCounter41407164.reachGoal(\'m-program-list\'); return true;" type="button">Выбрать</button></div></div></div></div></div></div></div><div class="p20 mt30" ng-if="root.messages.length"><div class="ui error message"><ul class="list"><li ng-repeat="message in root.messages"><span ng-bind="message"></span></li></ul><i class="close icon" ng-click="root.messages.length = 0;"></i></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.kasko/calculatorC/views/calculation.step_2.html",'<div class="ui form b-full-width-bg_white css-small-sized-fields"><div class="p20"><div class="ui doubling stackable grid four column bottom aligned"><div class="column"><div class="field" align="left"><label for="id_is_legal_entity">Тип страхователя:</label><div class="ui search selection dropdown" id="id_is_legal_entity" sem-dropdown="" ng-model="calculation.is_legal_entity" sem-dropdown-items="dicts.isLegalEntity"></div></div></div><div class="column"><div class="field"><label>Срок страхования:</label><div class="ui search selection dropdown" id="id_insurance_duration" sem-dropdown="" ng-model="calculation.insurance_duration" sem-dropdown-items="dicts.insuranceDuration"></div></div></div><div class="column"><div class="field"><label for="id_calculation_at_date">Дата начала действия договора:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(-1, 0)}}" jdatepicker-only-future="true" placeholder="__.__.____" id="id_calculation_at_date" required="" ng-model="calculation.calculation_at_date"> <i class="icon calendar circular branded inverted"></i></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.kasko/calculatorC/views/kasko/calculation.step_3.html",'<div class="css-cars-filter b-full-width-bg m0 mt30" ng-class="\'css-cars-filter--step-\' + bigSteps.getBigStep().name" style="font-size: 15px;" ng-show="!params.resultsAreVisible || bigSteps.getBigStep().name !== \'third\'"><div class="p20"><car-filter cf-model-car-mark="calculation.car_mark" cf-model-car-model="calculation.car_model" cf-model-car-model-group="calculation.car_model_group" cf-model-car-cost="calculation.car_cost"></car-filter></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.kasko/calculatorC/views/kasko/calculation.step_6.html",'<div class="ui form b-full-width-bg_white"><div class="p20"><div class="ui grid stackable four column bottom aligned"><div class="row"><div class="twelve wide column">&nbsp;</div><div class="column" align="right"><div class="field"><button class="button ui green" style="margin-right: 0;" ng-click="calculateKasko()" ng-class="{loading: params.isCalculationProgress}" ng-disabled="calculation_form.$invalid || disabledSubmitButton()" type="button">Рассчитать</button></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.kasko/calculatorStepsC/views/second_big_step.html",'<div><div class="ui large labels" ng-class="$root.currentBrand.steps_buttons_color"><div class="ui label basic mb10" ng-repeat="item in carFilterParams.brandSteps.second" ng-show="getCurrentStepObject(item).getLabelTitle()"><span ng-bind="getCurrentStepObject(item).getLabelTitle()"></span> <i class="icon delete" ng-click="setActiveStep(getCurrentStepObject(item).name)" ng-keydown="$event.keyCode == 13 && setActiveStep(getCurrentStepObject(item).name)" tabindex="0"></i></div></div><div class="p20" ng-show="getActiveStepSecond().name !== carFilterParams.brandSteps.second[0]"><div class="ui divider" style="border-top-style: dashed;"></div></div><div ng-repeat="item in carFilterParams.brandSteps.second" ng-show="getCurrentStepObject(item).name === getActiveStepSecond().name" ng-class="\'show-active-\' + getCurrentStepObject(item).name" ng-include="getCurrentStepObject(item).templateUrl"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorO/views/calculation.form.html",'<div ui-view="step_2" ng-show="bigSteps.getBigStep().name === \'first\'"></div><div ui-view="step_3"></div><div ng-show="bigSteps.getBigStep().name === \'first\'"><div ui-view="step_4" ng-if="getCurrentCalcType() === \'full\'"></div><div ui-view="step_5" ng-if="getCurrentCalcType() === \'simple\'"></div><div ui-view="step_6" ng-show="getCurrentCalcType()"></div><div class="js-kasko-result" ng-include="templates.program_list" ng-show="getCurrentCalcType()"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorO/views/osago/calculation.program_list.html",'<div ng-show="params.resultsAreCreated && !calculationResult.length"><h2 class="b-content_title c-tac mb40">К сожалению, мы не можем оформить ОСАГО на данный автомобиль</h2></div><div class="ui form b-full-width-bg_white" ng-if="calculationResult.length"><div class="p20"><div><table class="b-kasko-result ui very basic table"><tr><td><h4 ng-show="getResultWithKbm().variables.KBM.length || getResultWithKbm().variables.kbm">КБМ:</h4></td><td class="c-tar"></td></tr><tr><td><h3 class="b-content_title mt5" ng-repeat="kbm in getResultWithKbm().variables.KBM track by $index"><span ng-bind="cachedDrivers[$index].last_name"></span> <span ng-bind="cachedDrivers[$index].first_name"></span> <span ng-if="cachedDrivers[$index].last_name">—</span> <span ng-bind="kbm"></span></h3><div ng-if="!cachedDrivers.length"><span ng-bind="getResultWithKbm().variables.kbm"></span></div></td><td></td></tr></table></div><div class="css-divider-tilde ui divider horizontal header">~</div><div><h1 class="b-content_title c-tac">Выберите компанию для оформления договора:</h1><div class="ui grid three column mt30"><div class="b-result column" align="center" tabindex="0" ng-repeat="result in calculationResult" ng-if="result.program.sum && result.program.sum != 0" ng-mousedown="selectResult(result.id)" ng-keypress="$event.keyCode == 13 && selectResult(result.id)" ng-class="{\'b-result--selected\': result.id === root.selectedResult.id}"><div><img ng-src="{{result.company_logo}}" alt=""><div class="b-result_select"><i class="icon checkmark"></i></div><div class="b-result_sum c-tac mt5"><span ng-bind="setSumWithOtherKbm(result) | priceFormatter:0:\'\':false"></span>.<small ng-bind="setSumWithOtherKbm(result) | fractionalFormatter:2"></small> руб.</div></div></div></div><div class="mt55 c-tac"><button class="m0 ui button" ng-class="[params.isCalculationProgress ? \'loading\' : \'\', ($root.currentBrand.download_documents_button || $root.currentBrand.main_buttons_color)]" ng-disabled="disabledFormationPolicyButton() || calculation_form.$invalid || !calculationResult.length || !root.selectedResult" ng-click="bigSteps.setBigStep(\'second\')" type="button"><span></span> Загрузить<br><strong>документы</strong></button></div></div></div></div><div class="p20 mt30" ng-if="root.messages.length"><div class="ui error message"><ul class="list"><li ng-repeat="message in root.messages"><span ng-bind="message"></span></li></ul><i class="close icon" ng-click="root.messages.length = 0;"></i></div></div>');
}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorO/views/osago/calculation.step_2.html",'<div class="ui form b-full-width-bg_white css-small-sized-fields"><div class="p20"><div class="ui stackable grid four column bottom aligned"><div class="column"><div class="field" align="left"><label for="id_is_legal_entity">Тип собственника:</label><div class="ui search selection dropdown" id="id_is_legal_entity" sem-dropdown="" ng-change="fieldChanged(\'is_legal_entity\')" ng-model="calculation.is_legal_entity" sem-dropdown-items="dicts.isLegalEntity"></div></div></div><div class="column"><div class="field"><label>Срок страхования:</label><div class="ui search selection dropdown" id="id_insurance_duration" sem-dropdown="" ng-model="calculation.insurance_duration" sem-dropdown-items="dicts.insuranceDuration"></div></div></div><div class="column"><div class="field"><label for="id_calculation_at_date">Дата начала действия договора:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(-1, 0)}}" jdatepicker-only-future="true" placeholder="__.__.____" id="id_calculation_at_date" required="" ng-model="calculation.calculation_at_date"> <i class="icon calendar circular branded inverted"></i></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorO/views/osago/calculation.step_3.html",'<div class="css-cars-filter b-full-width-bg m0 mt30" style="font-size: 15px;"><div class="p20"><car-filter cf-model-car-mark="calculation.car_mark" cf-model-car-model="calculation.car_model" cf-model-car-model-group="calculation.car_model_group" cf-model-car-cost="calculation.car_cost"></car-filter></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorO/views/osago/calculation.step_4.html",'<div class="ui form b-full-width-bg pt55 m0 mt10"><div class="p20"><div class="nowrap css-show-errors ui grid stackable relaxed"><div class="row"><div class="four wide column"><div class="field mt15" align="left"><label for="id_drivers_count">Количество водителей:</label><div class="ui search selection dropdown" id="id_drivers_count" sem-dropdown="" ng-model="params.drivers_count_full" ng-class="{disabled: calculation.is_legal_entity}" ng-change="driversCountChanged()" sem-dropdown-items="dicts.driversCountOsagoFull"></div></div></div><div class="twelve wide column b-drivers_osago"><h3 class="b-drivers_osago_person-type b-content_title" ng-if="drivers.length"><i class="icon" ng-class="\'user\' + (drivers.length > 1 ? \'s\' : \'\')"></i> Водители:</h3><div ng-repeat="driver in drivers" ng-form="driver_form" ng-model="driver" class="is-form"><div class="ui grid three column stackable"><div class="row"><div class="column"><div class="field"><label for="id_driver_osago_last_name_{{$index}}">Фамилия:</label> <input type="text" required="" ng-pattern="params.name_pattern" id="id_driver_osago_last_name_{{$index}}" ng-model="driver.last_name"></div></div><div class="column"><div class="field"><label for="id_driver_osago_first_name_{{$index}}">Имя:</label> <input type="text" required="" ng-pattern="params.name_pattern" id="id_driver_osago_first_name_{{$index}}" ng-model="driver.first_name"></div></div><div class="column"><div class="field"><label for="id_driver_osago_patronymic_{{$index}}">Отчество:</label> <input type="text" ng-pattern="params.name_pattern" id="id_driver_osago_patronymic_{{$index}}" ng-model="driver.patronymic"></div></div></div><div class="row"><div class="column"><div class="field"><label for="id_driver_license_series">Водительское удостоверение:</label><div class="ui fields"><div class="seven wide field"><input type="text" required="" maxlength="4" minlength="4" placeholder="Серия" id="id_driver_license_series" ng-model="driver.driver_license.series"></div><div class="nine wide field"><input type="text" required="" input-integer="" maxlength="6" minlength="6" placeholder="Номер" id="id_driver_license_number" ng-model="driver.driver_license.number"></div></div></div></div><div class="column"><div class="field" ng-class="{error: driver.dateIsInvalid}"><label for="id_driving_experience_started_{{$index}}">Дата начала стажа:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{ getYearRange(0, 73) }}" jdatepicker-only-past="true" ng-change="driversDateChanged(driver)" placeholder="__.__.____" id="id_driving_experience_started_{{$index}}" required="" ng-model="driver.driving_experience_started"> <i class="icon calendar circular branded inverted"></i></div></div></div><div class="column"><div class="field" ng-class="{error: driver.dateIsInvalid}"><label for="id_driver_birth_date_{{$index}}">Дата рождения:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{ getYearRange(18, 91) }}" jdatepicker-only-past="true" ng-change="driversDateChanged(driver);" placeholder="__.__.____" id="id_driver_birth_date_{{$index}}" required="" ng-model="driver.birth_date"> <i class="icon calendar circular branded inverted"></i></div></div></div></div></div><div class="ui divider mt30 mb15" ng-if="drivers.length > 1 && (drivers.length - 1) !== $index"></div></div><div ng-repeat="person in persons" ng-form="person_form" ng-model="person" class="is-form"><div class="ui loader"></div><h3 class="b-drivers_osago_person-type b-content_title">Собственник:</h3><div class="ui grid four column stackable" ng-if="!calculation.is_legal_entity"><div class="row"><div class="column"><div class="field"><label for="id_person_osago_last_name_{{$index}}">Фамилия:</label> <input type="text" required="" ng-pattern="params.name_pattern" id="id_person_osago_last_name_{{$index}}" ng-model="person.last_name"></div></div><div class="column"><div class="field"><label for="id_person_osago_first_name_{{$index}}">Имя:</label> <input type="text" required="" ng-pattern="params.name_pattern" id="id_person_osago_first_name_{{$index}}" ng-model="person.first_name"></div></div><div class="column"><div class="field"><label for="id_person_osago_patronymic_{{$index}}">Отчество:</label> <input type="text" ng-pattern="params.name_pattern" id="id_person_osago_patronymic_{{$index}}" ng-model="person.patronymic"></div></div><div class="column"><div class="field"><label for="id_person_birth_date_{{$index}}">Дата рождения:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 90)}}" placeholder="__.__.____" id="id_person_birth_date_{{$index}}" required="" ng-model="person.birth_date"> <i class="icon calendar circular branded inverted"></i></div></div></div></div><div class="row"><div class="six wide column"><div class="field"><label for="id_person_passport">Паспорт:</label><div class="ui fields"><div class="seven wide field"><input type="text" required="" input-integer="" maxlength="4" minlength="4" placeholder="Серия" id="id_person_passport" ng-model="person.passport.series"></div><div class="nine wide field"><input type="text" required="" input-integer="" maxlength="6" minlength="6" placeholder="Номер" ng-model="person.passport.number"></div></div></div></div><div class="four wide column"><div class="field"><label for="id_person_passport_issue_date_{{$index}}">Дата выдачи:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 26)}}" placeholder="__.__.____" id="id_person_passport_issue_date_{{$index}}" required="" ng-model="person.passport.issue_date"> <i class="icon calendar circular branded inverted"></i></div></div></div><div class="six wide column" ng-if="isVisible(\'vin_number\')"><div class="field"><label for="id_vin_number_np">VIN:</label> <input type="text" ng-model="osagoParams.vin_number" input-vin-number="" minlength="17" maxlength="17" required="" id="id_vin_number_np"><div class="ui label pointing basic top grey c-vin-error-label css-can-wrap" ng-show="osagoParams.vin_number.length === 17">Не совпадает контрольная сумма VIN</div></div></div></div></div><div class="ui grid three column stackable" ng-if="calculation.is_legal_entity"><div class="row"><div class="column" ng-if="isVisible(\'vin_number\')"><div class="field"><label for="id_vin_number">VIN:</label> <input type="text" ng-model="osagoParams.vin_number" input-vin-number="" minlength="17" maxlength="17" required="" id="id_vin_number"><div class="ui label pointing basic top grey c-vin-error-label css-can-wrap" ng-show="osagoParams.vin_number.length === 17">Не совпадает контрольная сумма VIN</div></div></div><div class="column"><div class="field"><label for="id_legal_person_inn">ИНН:</label> <input type="text" required="" input-integer="" id="id_legal_person_inn" ng-model="osagoParams.legal_person.inn"></div></div><div class="column"><div class="field"><label for="id_legal_person_title">Наименование юр. лица:</label> <input type="text" required="" id="id_legal_person_title" ng-model="osagoParams.legal_person.title"></div></div></div></div></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorO/views/osago/calculation.step_5.html",'<div class="ui form b-full-width-bg pt35 m0 mt10"><div class="p20"><div class="nowrap css-show-errors ui grid stackable relaxed"><div class="four wide column"><div class="field"><label>Количество водителей:</label><div class="ui search selection dropdown" sem-dropdown="" ng-click="params.field_was_clicked = true;" ng-focus="params.field_was_clicked = true;" ng-class="{disabled: calculation.is_legal_entity}" ng-change="params.field_was_clicked && driversCountChangedSimple()" ng-model="params.drivers_count" sem-dropdown-items="dicts.driversCountOsagoSimple"></div></div></div><div class="five wide column"><div class="field" ng-repeat="driver in calculation.driver_set"><label>Возраст и стаж водителя:</label><div class="ui fields"><div class="eight wide field" ng-class="{\'error\': driver.age < 18 || driver.age > 87}"><input type="text" ng-model="driver.age" input-integer="" required=""></div><div class="eight wide field" ng-class="{\'error\': driver.age - driver.expirience < 18}"><input type="text" ng-model="driver.expirience" input-integer="" required=""></div></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorO/views/osago/calculation.step_6.html",'<div class="ui form b-full-width-bg_white"><div class="p20"><div class="ui grid stackable four column bottom aligned"><div class="row"><div class="twelve wide column">&nbsp;</div><div class="column" align="right"><div class="field"><button class="ui button" ng-click="calculateOsago()" ng-class="[params.isCalculationProgress ? \'loading\' : \'\', ($root.currentBrand.perform_the_calculation_button || $root.currentBrand.main_buttons_color)]" ng-disabled="calculation_form.$invalid || disabledSubmitButton()" type="button"><span></span> Рассчитать</button></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/AddingDocuments/views/adding_documents.uploader.html",'<div class="p20 mt10"><div ng-class="{\'b-disabled-block\': isNotUpload}"><div class="ui grid stackable"><div class="row"><div class="six wide column"><ul class="uploader-queue" nv-file-drop="" nv-file-over="" uploader="uploader" over-class="uploader-queue_over"><li ng-if="!uploader.queue.length">Для оформления полиса нужно загрузить файлы.</li><li ng-repeat="item in uploader.queue" class="list-item animation-fade"><div ng-if="item._file.type.indexOf(\'image/\') !== -1"><div ng-thumb="{ file: item._file, height: 70 }"></div></div><div ng-if="item._file.type === \'application/pdf\'"><a href="{{item.file_url}}" target="_blank"><img ng-src="{{params.images_path}}pdf.png" alt="{{item.description}}" height="70"></a></div><div ng-if="item._file.type === \'application/msword\' || isDocument(item._file.type)"><a href="{{item.file_url}}" target="_blank"><img ng-src="{{params.images_path}}doc_icon.png" alt="{{item.description}}" height="70"></a></div><div class="uploader-queue-actions"><button type="button" ng-click="item.remove()" class="button button-wrong">Удалить</button></div></li></ul><div class="control-row mt15"><input type="file" nv-file-select="" class="ui button" name="file" style="width: 100%;" uploader="uploader" multiple=""><h4>Выбрано: {{uploader.queue.length}}</h4></div></div><div class="ten wide column"><h2 class="b-content_title m0">Подтверждаю загрузку минимального пакета документов</h2><div class="b-full-width-bg" style="padding: 15px 0;margin-left: -15px;"><div class="p20">Для заполнения полиса добавьте сканы или фотографии ваших документов. Мы внесем эти данные и проверим их самостоятельно.</div></div><div class="b-uploader_confirmation-list"><div class="list-item mb5"><sem-checkbox ng-model="confirmationList.id_is_1" sem-label="Копия паспорта Страхователя (1 лист и лист с пропиской)" required="required" id="id_is_1" name="is_1"></sem-checkbox></div><div class="list-item mb5"><sem-checkbox ng-model="confirmationList.id_is_2" sem-label="Копия паспорта Собственника (1 лист и лист с пропиской)" required="required" id="id_is_2" name="is_2"></sem-checkbox></div><div class="list-item mb5"><sem-checkbox ng-model="confirmationList.id_is_4" sem-label="Копия ПТС или свидетельство о регистрации (с двух сторон)" required="required" id="id_is_4" name="is_4"></sem-checkbox></div><div class="list-item mb5"><sem-checkbox ng-model="confirmationList.id_is_7" sem-label="Копия вод. удостоверений с обеих сторон всех водителей" required="required" id="id_is_7" name="is_7"></sem-checkbox></div></div></div></div></div></div><div class="mt20 c-tar"><a href="" ng-click="bigSteps.setBigStep(\'fourth\')" ng-class="[ isSaveDataProgress && \'loading\' || \'\', (f_policy_step_3_form.$invalid || !uploader.queue.length) && \'disabled\', ($root.currentBrand.save_the_data_button || $root.currentBrand.main_buttons_color)]" class="ui button"><span></span> Сохранить<br><strong>данные</strong></a></div><div class="mt40" ng-if="errors.length"><div class="ui error message"><ul class="list"><li ng-repeat="error in errors" ng-if="errors.length > 0"><span ng-bind="error"></span></li></ul><i class="close icon" ng-click="errors.length = 0;"></i></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.address_registration.html",'<div dadata="person.address_registration" dadata-type="address"><div class="fields"><div class="twelve field wide"><label for="id_address_registration_postal_full">Введите полный адрес:</label><div class="ui transparent input"><input type="text" required="" dadata-target="" ng-blur="fieldBlurred()" class="ui transparent input" ng-class="{\'css-error-input\': !addressIsValid(person.address_registration)}" id="id_address_registration_postal_full" ng-model="person.address_registration.full" name="address_registration_postal_full"></div></div><div class="two field wide"><label>Корпус:</label><div class="ui transparent input"><input type="text" title="Корпус" ng-blur="fieldBlurred()" ng-model="person.address_registration.housing" name="address_registration_housing"></div></div><div class="two field wide"><label>Кв./офис:</label><div class="ui transparent input"><input type="text" title="Квартира" ng-blur="fieldBlurred()" ng-model="person.address_registration.flat" name="address_registration_flat"></div></div></div><div class="js-dadata-messages ui pointing red basic label"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.address_residential.html",'<div dadata="person.address_residential" dadata-type="address"><div class="fields"><div class="twelve field wide"><label for="id_address_residential_postal_full">Введите полный адрес:</label><div class="ui transparent input"><input type="text" required="" dadata-target="" ng-change="addressIsValid(person.address_residential)" ng-blur="fieldBlurred()" class="ui transparent input" ng-class="{\'css-error-input\': !addressIsValid(person.address_residential)}" id="id_address_residential_postal_full" ng-model="person.address_residential.full" name="address_residential_postal_full"></div></div><div class="two field wide"><label>Корпус:</label><div class="ui transparent input"><input type="text" title="Корпус" ng-change="addressIsValid(person.address_residential)" ng-blur="fieldBlurred()" ng-model="person.address_residential.housing" name="address_residential_housing"></div></div><div class="two field wide"><label>Кв./офис:</label><div class="ui transparent input"><input type="text" title="Квартира" ng-change="addressIsValid(person.address_residential)" ng-blur="fieldBlurred()" ng-model="person.address_residential.flat" name="address_residential_flat"></div></div></div><div class="js-dadata-messages ui pointing red basic label"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.addresses_block.html",'<div class="b-addresses"><div class="b-address ui stackable grid"><div class="row"><div class="b-address_line column"><div class="p20"><div class="field" ng-class="{disabled: isDisabledForm}"><div class="b-addresses_checkboxes mb15"><strong>Адрес регистрации:</strong><sem-checkbox sem-label="Совпадает с фактическим" ng-model="person.is_same_address"></sem-checkbox></div><div ng-include="templates.address_registration"></div></div><div class="field" ng-class="{disabled: isDisabledForm}" style="padding-top: 10px;" ng-if="!person.is_same_address"><label class="mb15">Адрес проживания:</label><div ng-include="templates.address_residential"></div></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.form.car.html",'<div class="ui form b-car-form"><div class="p20"><h3 class="ui horizontal divider header"><i class="icon car"></i><span></span></h3><div class="ui grid stackable four column b-full-width-bg is-form" ng-form="car_form" check-in-rsa="params" check-in-rsa-send="{{car_form.$valid}}" ng-model="car"><div class="ui loader" ng-class="{active: rsaParams.is_sending}"></div><div class="row"><div class="sixteen wide column"><h2 class="b-content_title m0 mb15">Автомобиль <strong ng-if="params.car_mark" class="vam"><span ng-bind="params.car_mark"></span> — <span ng-bind="params.car_model_group"></span> — <span ng-bind="params.car_model"></span> \'<span ng-repeat="char in calculation.car_manufacturing_year | limitTo: -2 track by $index" ng-bind="char"></span></strong></h2></div></div><div class="row bottom aligned"><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><div align="center" style="margin-top: -2em;"><sem-checkbox ng-model="params.number_type" sem-label="VIN" sem-type="radio" name="number_type" value="vin_number"></sem-checkbox><sem-checkbox ng-model="params.number_type" sem-label="Номер кузова" sem-type="radio" class="ml10" name="number_type" value="car_body_number"></sem-checkbox><sem-checkbox ng-model="params.number_type" sem-label="Номер шасси" sem-type="radio" name="number_type" style="margin: 0.5em 0;" value="chassis_number"></sem-checkbox></div><div class="ui input" ng-if="params.number_type === \'vin_number\'"><input type="text" input-vin-number="" required="" maxlength="17" ng-minlength="17" ng-blur="fieldBlurred()" placeholder="Введите VIN-номер автомобиля" id="id_vin_number" name="vin_number" ng-model="car.vin_number"></div><div class="ui label pointing basic top grey c-vin-error-label" ng-show="car.vin_number.length === 17 && params.number_type === \'vin_number\'">Не совпадает контрольная сумма VIN</div><div class="ui input" ng-if="params.number_type === \'car_body_number\'"><input type="text" required="" ng-blur="fieldBlurred()" name="car_body_number" placeholder="Введите номер кузова автомобиля" ng-model="car.car_body_number"></div><div class="ui input" ng-if="params.number_type === \'chassis_number\'"><input type="text" required="" name="chassis_number" ng-blur="fieldBlurred()" placeholder="Введите номер шасси автомобиля" ng-model="car.chassis_number"></div></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_number_plate">Гос. рег. знак:</label> <input type="text" input-capitalize="" ng-blur="fieldBlurred()" maxlength="10" required="" id="id_number_plate" name="number_plate" ng-model="car.number_plate"></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_mileage">Пробег:</label> <input type="text" maxlength="8" input-integer="" input-float="" id="id_mileage" ng-blur="fieldBlurred()" name="mileage" ng-model="car.mileage"></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_engine_power_kilowatt">Мощность в кВт:</label> <input type="text" input-float="" ng-max="735" max-precision="2" maxlength="6" id="id_engine_power_kilowatt" name="engine_power_kilowatt" ng-blur="fieldBlurred()" ng-model="car.engine_power_kilowatt"></div></div></div><div class="row"><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><div><sem-checkbox ng-model="params.car_document_type" sem-label="ПТС" sem-type="radio" name="car_document_type" value="vehicle_registration"></sem-checkbox><sem-checkbox ng-model="params.car_document_type" sem-label="СТС" sem-type="radio" class="ml10" name="car_document_type" value="vehicle_certificate"></sem-checkbox></div><div class="ui fields" ng-if="params.car_document_type === \'vehicle_registration\'"><div class="seven field wide mb10"><input type="text" name="vehicle_registration_series" required="" input-only="[А-Яа-я0-9]+" maxlength="4" ng-minlength="4" ng-blur="fieldBlurred()" placeholder="Серия" id="id_vehicle_registration_series" ng-model="car.vehicle_registration.series"></div><div class="nine field wide"><input type="text" name="vehicle_registration_number" placeholder="Номер" required="" input-integer="" ng-blur="fieldBlurred()" maxlength="6" ng-model="car.vehicle_registration.number"></div></div><div class="ui fields" ng-if="params.car_document_type === \'vehicle_certificate\'"><div class="seven field wide mb10"><input type="text" name="vehicle_certificate_series" required="" input-only="[А-Яа-я0-9]+" ng-blur="fieldBlurred()" maxlength="4" ng-minlength="4" placeholder="Серия" id="id_vehicle_certificate_series" ng-model="car.vehicle_certificate.series"></div><div class="nine field wide"><input type="text" name="vehicle_certificate_number" placeholder="Номер" required="" ng-blur="fieldBlurred()" input-integer="" maxlength="6" ng-model="car.vehicle_certificate.number"></div></div></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_document_issue_date">Дата получения:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 20)}}" jdatepicker-only-past="true" name="document_issue_date" ng-change="fieldBlurred()" placeholder="__.__.____" id="id_document_issue_date" required="" ng-model="car.document_issue_date"> <i class="icon calendar circular blue inverted"></i></div></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_engine_displacement">Объем двигателя:</label> <input type="text" input-float="" ng-blur="fieldBlurred()" ng-max="100" id="id_engine_displacement" name="engine_displacement" ng-model="car.engine_displacement"></div></div></div><div class="js-check-in-rsa_message ui message" ng-class="rsaParams.message_type" ng-bind="rsaParams.message"></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.form.person_block.html",'<div class="ui form"><div class="p20"><div ng-include="templates.person_roles"></div><div ng-if="!person.isDriver && person.personType === \'natural_person\' || person.showFioFields"><div class="ui grid stackable four column"><div class="row"><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label>Фамилия</label> <input type="text" required="" name="last_name" ng-blur="fieldBlurred()" ng-pattern="params.name_pattern" placeholder="Иван" ng-model="person.last_name"></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label>Имя</label> <input type="text" placeholder="Петров" required="" ng-blur="fieldBlurred()" name="first_name" ng-pattern="params.name_pattern" ng-model="person.first_name"></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label>Отчество</label> <input type="text" name="patronymic" ng-blur="fieldBlurred()" ng-pattern="params.name_pattern" placeholder="Александрович" ng-model="person.patronymic"></div></div><div class="column" ng-if="person.hasRole()"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_person_birth_date_{{$index}}">Дата рождания</label><div class="ui icon input"><input type="text" jdatepicker="" ng-blur="fieldBlurred()" jdatepicker-year-range="{{person.birthDateRange.yearRange}}" jdatepicker-max-date="{{person.birthDateRange.max}}" jdatepicker-min-date="{{person.birthDateRange.min}}" name="birth_date" placeholder="__.__.____" id="id_person_birth_date_{{$index}}" required="" ng-model="person.birth_date"> <i class="icon calendar circular blue inverted"></i></div></div></div></div></div></div><div ng-if="person.hasRole()"><div class="ui grid stackable four column"><div class="row"><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_person_passport_series_{{$index}}">Серия и номер паспорта</label><div class="ui fields"><div class="seven field wide mb10"><input type="text" name="person_passport_series" class="focusing-first" required="" ng-blur="fieldBlurred()" input-integer="" maxlength="4" minlength="4" placeholder="Серия" id="id_person_passport_series_{{$index}}" ng-model="person.passport.series"></div><div class="nine field wide"><input type="text" name="person_passport_number" placeholder="Номер" ng-blur="fieldBlurred()" required="" input-integer="" maxlength="6" minlength="6" ng-model="person.passport.number"></div></div></div></div><div class="column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_person_passport_issue_date_{{$index}}">Дата выдачи</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 20)}}" jdatepicker-only-past="true" name="passport_issue_date" placeholder="__.__.____" ng-change="fieldBlurred()" id="id_person_passport_issue_date_{{$index}}" required="" ng-model="person.passport.issue_date"> <i class="icon calendar circular blue inverted"></i></div></div></div><div class="eight wide column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_passport_issue_point">Кем выдан</label> <input type="text" name="passport_issue_point" required="" ng-blur="fieldBlurred()" id="id_passport_issue_point" placeholder="Отделением УФМС по Санкт-Петербургу" ng-model="person.passport.issue_point"></div></div></div></div><div class="row-margin"><div ng-include="templates.addresses_block" ng-if="person.hasRole() || person.isDriver"></div></div></div><div class="js-check-in-rsa_message ui message" ng-class="rsaParams.message_type" ng-bind="rsaParams.message"></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.form.person_block_legal.html",'<div class="ui form"><div class="p20"><div ng-include="templates.person_roles"></div><div class="ui grid stackable"><div class="row"><div class="four wide column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_title_{{$index}}">Название:</label> <input type="text" required="" id="id_title_{{$index}}" name="legal_person_title" ng-model="person.title"></div></div><div class="four wide column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_inn_{{$index}}">ИНН:</label> <input type="text" required="" id="id_inn_{{$index}}" input-integer="" minlength="10" maxlength="10" name="legal_person_inn" ng-model="person.inn"></div></div><div class="four wide column"><div class="field" ng-class="{disabled: isDisabledForm}"><label for="id_ogrn_{{$index}}">ОГРН:</label> <input type="text" id="id_ogrn_{{$index}}" name="legal_person_ogrn" input-integer="" minlength="13" maxlength="13" ng-model="person.ogrn"></div></div></div></div></div><div class="b-addresses" ng-if="person.hasRole()"><div class="b-address ui stackable grid"><div class="row"><div class="b-address_line column"><div class="p20"><div class="field" ng-class="{disabled: isDisabledForm}"><label class="mb15">Юридический адрес:</label><div ng-include="templates.address_registration"></div></div></div></div></div></div></div><div align="right" class="mt15" ng-if="person.hasRole() && currentUser.is_legal_person"><a href="" user-to-person="" ng-model="person">Заполнить данными из профиля</a></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.form.person_roles.html",'<div class="ui grid stackable"><div class="row"><div class="five wide column"><h2 class="b-content_title"><strong ng-if="person.isDriver && !person.showFioFields" ng-bind="person | fioFormatter:\'full\'"></strong> <strong ng-if="person.showFioFields">Водитель</strong> <strong ng-if="!person.isDriver">Участник договора (<span ng-bind="person.personType === \'legal_person\' ? \'Юр. лицо\' : \'Физ. лицо\'"></span>)</strong></h2></div><div class="seven wide column"><div class="three fields"><div class="field"><sem-checkbox ng-model="person.isDriver" disabled="disabled" sem-label="Водитель"></sem-checkbox></div><div class="field" ng-class="{disabled: isDisabledForm, error: !personCheckUsed().isOwner}"><sem-checkbox ng-model="person.isOwner" sem-label="Собственник" ng-change="setPersonType(person, \'isOwner\')" name="person_is_owner"></sem-checkbox></div><div class="field" ng-class="{disabled: isDisabledForm, error: !personCheckUsed().isInsurant}"><sem-checkbox ng-model="person.isInsurant" sem-label="Страхователь" ng-change="setPersonType(person, \'isInsurant\')" name="person_is_insurant"></sem-checkbox></div></div></div><div class="four wide column"><div class="field without-dropdown-placeholder" style="min-width: 140px;" ng-class="{disabled: isDisabledForm}"><div ng-if="!$index"><div class="ui floating blue dropdown button small" ng-model="params.person_type" sem-dropdown="" ng-class="{disabled: isDisabledForm}" ng-change="addPerson({}, params.person_type)" sem-dropdown-action="select" sem-dropdown-items="insurantTypes" sem-dropdown-placeholder="Добавить участника договора"></div></div><h3 ng-if="$index"><i ng-class="{disabled: isDisabledForm}" class="icon remove red" ng-click="removePerson(person)"></i></h3></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.form.persons.html",'<div class="b-full-width-bg_white b-f-policy_person ui form is-form" ng-repeat="person in persons" ng-form="person_form" ng-model="person"><div class="ui loader"></div><div ng-if="person.personType === \'natural_person\'" ng-include="templates.person_block"></div><div ng-if="person.personType === \'legal_person\'" ng-include="templates.person_block_legal"></div><div class="p20"><h3 ng-if="persons.length > 1 && (persons.length - 1) !== $index" class="ui horizontal divider header"><i class="icon users"></i><span></span></h3></div></div>');
}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/personalData/views/personal_data.html",'<div ng-include="templates.persons"></div><div ng-include="templates.car"></div><div class="mt40 c-tar"><button class="ui button" ng-disabled="f_policy_step_3_form.$invalid" ng-class="[params.isCalculationProgress ? \'loading\' : \'\', ($root.currentBrand.save_the_data_button || $root.currentBrand.main_buttons_color)]" type="button" ng-click="savePersonalData()"><span></span> Сохранить<br><strong>данные</strong></button></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.osago/calculatorStepsO/views/second_big_step.html",'<div ng-controller="AddingDocumentsCtrl"><div class="p20 mb40 c-tac" ng-show="$root.currentBrand.show_personal_data"><div class="ui basic buttons"><button class="ui button" tabindex="0" ng-click="addingDocumentsTemplates.selectTemplate(\'uploader\')" ng-class="{active: addingDocumentsTemplates.currentTemplate === \'uploader\'}" type="button">Загрузить фото документов</button> <button class="ui button" tabindex="0" ng-click="addingDocumentsTemplates.selectTemplate(\'form\')" ng-class="{active: addingDocumentsTemplates.currentTemplate === \'form\'}" type="button">Заполнить личные данные</button></div></div><div ng-form="f_policy_step_3_form" class="f_policy_step_3-form is-form css-hide-errors"><div ng-if="addingDocumentsTemplates.currentTemplate === \'uploader\'" ng-include="addingDocumentsTemplates.uploader"></div><div ng-if="addingDocumentsTemplates.currentTemplate === \'form\'"><div ng-controller="personalDataCtrl" ng-include="addingDocumentsTemplates.form" class="css-show-errors"></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculator/views/calculator.html",'<div ng-include="templates.navigation"></div><div class="calculator-block main-content-body template-{{$root.calcType}}"><form name="calculation_form" autocomplete="off" ng-class="{\'calculation-form_error\': params.show_empty_fields}" class="calculation-form"><div ui-view=""></div></form></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculator/views/document_uploader.html",'<ul class="uploader-queue" nv-file-drop="" nv-file-over="" uploader="uploader" over-class="uploader-queue_over"><li ng-if="!uploadedFiles.length && !uploader.queue.length">Загрузка файлов</li><li ng-repeat="file in uploadedFiles" class="list-item animation-fade"><div ng-if="file.mime_type.indexOf(\'image/\') !== -1"><a ng-href="{{file.file_url}}" target="_blank"><img ng-src="{{file.file_url}}" alt="{{file.description}}" height="70"></a></div><div ng-if="file.mime_type === \'application/pdf\'"><a ng-href="{{file.file_url}}" target="_blank"><img ng-src="{{params.images_path}}pdf.png" alt="{{file.description}}" height="70"></a></div><div ng-if="file.mime_type === \'application/msword\' || isDocument(file.mime_type)"><a ng-href="{{file.file_url}}" target="_blank"><img ng-src="{{params.images_path}}doc_icon.png" alt="{{file.description}}" height="70"></a></div><div class="uploader-queue-actions"><button type="button" ng-click="removeUploadedImage(file)" class="ui button red mini">Удалить</button></div></li><li ng-repeat="item in uploader.queue" class="list-item animation-fade"><div ng-if="item._file.type.indexOf(\'image/\') !== -1"><div ng-thumb="{ file: item._file, height: 70 }"></div></div><div ng-if="item._file.type === \'application/pdf\'"><a href="{{item.file_url}}" target="_blank"><img ng-src="{{params.images_path}}pdf.png" alt="{{item.description}}" height="70"></a></div><div ng-if="item._file.type === \'application/msword\' || isDocument(item._file.type)"><a href="{{item.file_url}}" target="_blank"><img ng-src="{{params.images_path}}doc_icon.png" alt="{{item.description}}" height="70"></a></div><div class="uploader-queue-actions"><button type="button" ng-click="item.remove()" class="ui button red mini">Удалить</button></div></li></ul>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculator/views/navigation.html",'<div class="b-steps"><div class="ui steps" ng-controller="calculatorNavigationCtrl"><div class="step" ng-repeat="navItem in navigation track by $index" ng-click="navItem.onClick()" ng-if="!navItem.isHidden()" ng-class="{ active: navItem.active(), disabled: navItem.condition_disabled() }"><i class="icon" ng-class="navItem.icon"></i><div class="content"><div class="title" ng-bind-html="navItem.title"></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/person/views/person.html",'<h1 class="main-content-header">Данные профиля</h1><div class="main-content-body"><form name="person_form" class="person_edit-form" ng-submit="savePerson()"><div class="control-row"><div class="f_policy-driver-last_name-block"><label for="id_last_name" class="fp-label">Фамилия:</label> <input type="text" ng-model="person.last_name" class="input-text input-sub_medium" id="id_last_name" name="last_name" required=""></div><div class="f_policy-driver-first_name-block"><label for="id_first_name" class="fp-label">Имя:</label> <input type="text" ng-model="person.first_name" class="input-text input-sub_medium" id="id_first_name" name="first_name" required=""></div><div class="f_policy-driver-patronymic-block"><label for="id_patronymic" class="fp-label">Отчество:</label> <input type="text" ng-model="person.patronymic" class="input-text input-sub_medium" id="id_patronymic" name="patronymic"></div></div><div class="control-row"><div class="f_policy-driver-driver_license-block"><label for="id_driver_license_series" class="fp-label">Водительское удостоверение:</label> <input type="text" ng-model="person.driver_license.series" class="input-text input-nano" maxlength="4" id="id_driver_license_series" name="driver_license_series" required=""> <input type="text" ng-model="person.driver_license.number" class="input-text input-small" maxlength="6" id="id_driver_license_number" name="driver_license_number" required=""></div><div class="f_policy-driver-driver_license_date-block"><label for="id_driver_license_date_{{$index}}" class="fp-label">Дата получения прав:</label> <span class="input-date-wrap"><input type="text" jdatepicker="" jdatepicker-year-count="90" ng-model="person.driver_license.issue_date" class="input-date input-mini" id="id_driver_license_date_{{$index}}" name="driver_license_date" required=""> <i class="icon-calendar"></i></span></div><div class="f_policy-driver-birth_date-block"><label for="id_birth_date_{{$index}}" class="fp-label">Дата рождения:</label> <span class="input-date-wrap"><input type="text" jdatepicker="" jdatepicker-year-count="90" ng-model="person.birth_date" class="input-date input-mini" id="id_birth_date_{{$index}}" name="birth_date" required=""> <i class="icon-calendar"></i></span></div></div><div class="control-row"><div class="f_policy-driver-passport-block"><label for="id_passport_series" class="fp-label">Серия, номер паспорта:</label> <input type="text" input-integer="" ng-model="person.passport.series" class="input-text input-nano" maxlength="4" id="id_passport_series" name="passport_series" required=""> <input type="text" input-integer="" ng-model="person.passport.number" class="input-text input-small" maxlength="6" id="id_passport_number" name="passport_number" required=""></div><div class="f_policy-driver-passport_point-block"><label for="id_passport_point" class="fp-label">Кем выдан:</label> <input type="text" ng-model="person.passport.issue_point" class="input-text input-big" id="id_passport_point" name="passport_point"></div><div class="f_policy-driver-passport_date-block"><label for="id_passport_date_{{$index}}" class="fp-label">Дата выдачи:</label> <span class="input-date-wrap"><input type="text" jdatepicker="" jdatepicker-year-count="90" ng-model="person.passport.issue_date" class="input-date input-mini" id="id_passport_date_{{$index}}" name="passport_date" required=""> <i class="icon-calendar"></i></span></div></div><div class="control-row"><div class="f_policy-driver-address-block"><div class="f_policy-driver-address_registration-block"><label for="id_address_registration_postal_index" class="fp-label">Адрес регистрации:</label><div class="input-wrapper"><input type="text" ng-model="person.address_registration.postal_index" class="input-text input-mini" placeholder="индекс" maxlength="6" id="id_address_registration_postal_index" name="address_registration_postal_index"> <input type="text" ng-model="person.address_registration.city" class="input-text input-mini" placeholder="город" id="id_address_registration_city" name="address_registration_city"> <input type="text" ng-model="person.address_registration.street" class="input-text input-mini" placeholder="улица" id="id_address_registration_street" name="address_registration_street"> <input type="text" ng-model="person.address_registration.house" class="input-text input-nano" placeholder="дом" id="id_address_registration_house" name="address_registration_house"> <input type="text" ng-model="person.address_registration.housing" class="input-text input-nano" placeholder="корп." id="id_address_registration_housing" name="address_registration_housing"> <input type="text" ng-model="person.address_registration.flat" class="input-text input-nano" placeholder="кв." id="id_address_registration_flat" name="address_registration_flat"></div></div><div class="f_policy-driver-address_residential-block" ng-if="!person.is_same_address"><label for="id_address_residential_postal_index" class="fp-label">Адрес проживания:</label><div class="input-wrapper"><input type="text" ng-model="person.address_residential.postal_index" class="input-text input-mini" placeholder="индекс" maxlength="6" id="id_address_residential_postal_index" name="address_residential_postal_index"> <input type="text" ng-model="person.address_residential.city" class="input-text input-mini" placeholder="город" id="id_address_residential_city" name="address_residential_city"> <input type="text" ng-model="person.address_residential.street" class="input-text input-mini" placeholder="улица" id="id_address_residential_street" name="address_residential_street"> <input type="text" ng-model="person.address_residential.house" class="input-text input-nano" placeholder="дом" id="id_address_residential_house" name="address_residential_house"> <input type="text" ng-model="person.address_residential.housing" class="input-text input-nano" placeholder="корп." id="id_address_residential_housing" name="address_residential_housing"> <input type="text" ng-model="person.address_residential.flat" class="input-text input-nano" placeholder="кв." id="id_address_residential_flat" name="address_residential_flat"></div></div></div><div class="f_policy-driver-is_same_address-block"><div class="sub-block"><input type="checkbox" ng-model="person.is_same_address" class="checkbox" id="id_is_same_address" name="is_same_address"> <label for="id_is_same_address">Совпадает с фактическим</label></div></div></div><div class="form-actions"><button type="submit" ng-disabled="isSavePersonProgress" class="button person-submit">Сохранить <i class="icon-done"></i></button><div loading-spinner="isSavePersonProgress" class="calc-loading"></div></div></form></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/person/views/person.save_message.success.html",'<form name="person_message_success" class="formation_policy_message-form ngdialog-form" ng-submit="closeThisDialog()"><div class="ngdialog-message">Персона сохранена</div><div class="form-actions"><button type="submit" class="button person_message_success-submit-button">Ок</button></div></form>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/appMessage/views/messages_template.html",'<div class="b-messages"><div ng-repeat="message in $root.messages" ng-class="message.type" class="b-messages_item ui message"><i class="icon close" ng-click="message.close()"></i><div ng-if="!message.isList" compile="message.msg"></div><ul class="list" ng-if="message.isList"><li ng-repeat="msg in message.msg"><span ng-bind-html="msg"></span></li></ul></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/mainContent/views/main_content.html",'<div ui-view=""></div><div align="right" class="mt20 mr15" ng-if="!$root.currentBrand.watermark_is_hidden">Разработка и поддержка <a href="http://b2bpolis.ru" target="_blank">Умный полис</a></div><div call-to-manager=""></div><messages></messages>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/car_filter.car_group_models_list.html",'<div class="c-tac b-content-loading" ng-if="!carModelGroups || !carModelGroups.length"><i class="spinner loading icon big grey" tabindex="0"></i></div><div class="ui five column doubling grid"><div class="row"><div class="column ui list" ng-repeat="column in carModelGroups | carFilterYears: carManufacturingYear | orderBy:\'rank\':reverse | orderBy:orderBy | multiColumn:{columns: 5}"><div ng-repeat="carModelGroup in column" class="item css-car-item" tabindex="0" ng-click="selectCarModelGroup(carModelGroup)" ng-keypress="$event.keyCode == 13 && selectCarModelGroup(carModelGroup)" title="{{carModelGroup.title}}"><span ng-bind="carModelGroup.title"></span></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/car_filter.car_manufacturing_years.html",'<div class="ui labels"><button class="ui large label basic" type="button" ng-repeat="year in monYears | limitTo: 10" tabindex="0" ng-class="[ year == calculation.car_manufacturing_year ? \'blue\' : \'\', $root.currentBrand.year_of_the_car_color ]" ng-click="selectMonYear($index)"><span ng-bind="year"></span></button><div style="display: inline-block;" class="nowrap"><label class="ml15" style="display: inline-block;">Другой:</label><div style="display: inline-block;"><div class="ui form"><div class="field" style="width: 90px;"><div sem-dropdown-items="monYears" class="ui compact selection dropdown" sem-dropdown="" ng-focus="carFilterParams.was_clicked = true;" ng-click="carFilterParams.was_clicked = true;" ng-change="carFilterParams.was_clicked && selectMonYear()" sem-dropdown-placeholder="2016" ng-class="$root.currentBrand.year_of_the_car_color" sem-dropdown-simple="true" ng-model="calculation.car_manufacturing_year"></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/car_filter.car_marks_list.html",'<div class="c-tac b-content-loading" ng-if="!carMarks || !carMarks.length"><i class="spinner loading icon big grey" tabindex="0"></i></div><div class="ui six column doubling grid"><div class="row"><div class="column ui list" ng-repeat="column in carMarks | filter:$parent.carSearch | filter:filterByPopularity | limitTo:carMarksLimit | orderBy:orderBy | multiColumn:{columns: 6}"><div ng-repeat="carMark in column" class="item css-car-item" title="{{carMark.title}}" tabindex="0" ng-class="[\'css-car-item--\' + carMark.popularity, carMarkSelected === carMark && \'css-item-selected\' || \'\']" ng-keypress="$event.keyCode == 13 && selectCarMark(carMark)" ng-click="selectCarMark(carMark)"><span ng-bind="::carMark.title"></span></div></div></div></div><div style="position: relative;z-index: 2;" class="c-tar"><a href="" class="car_filter-car_marks-all_marks_link p20" ng-click="toggleAllMarks()"><span ng-if="carMarksLimit === limit">Все марки</span> <span ng-if="carMarksLimit !== limit">Закрыть</span></a></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/car_filter.car_models_list.html",'<div class="c-tac b-content-loading" ng-if="!carModels || !carModels.length"><i class="spinner loading icon big grey" tabindex="0"></i></div><div class="ui five column doubling grid"><div class="row"><div class="column ui list" ng-repeat="column in carModels | carFilterYears:carManufacturingYear | orderBy:\'rank\':reverse | orderBy:orderBy | multiColumn:{columns: 5}"><div ng-repeat="carModel in column" class="item css-car-item" tabindex="0" ng-keypress="$event.keyCode == 13 && selectCarModel(carModel, true)" ng-click="selectCarModel(carModel, true)" ng-class="{ \'css-item-selected\': selectedModelId === carModel.id }" title="{{carModel.title}}"><span ng-bind="carModel.title"></span></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/car_filter.html",'<style>\n    i.icon.delete:focus {\n        color: #fff;\n        opacity: 1 !important;\n        outline: none;\n    }\n</style><div class="ui form b-calc-step pos-rel" ng-class="[\'b-calc-step--\' + getActiveStep().name, \'b-calc-step-second--\' + getActiveStepSecond().name]"><div move-to-step="" ng-show="getActiveStep().name !== carFilterParams.brandSteps.first[0]"></div><div ng-repeat="template in carFilterTemplates" ng-if="bigSteps.getBigStep().name === template.name" ng-include="template.templateUrl"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/fourth_big_step.html",'<div ng-controller="policyOrderingCtrl" ng-form="ordering_form" class="is-form"><div class="b-ordering m0"><div class="ui grid stackable"><div class="row"><div class="eleven wide column"><div class="b-ordering-block b-full-width-bg b-full-width-bg--green p30" style="height: 100%" ng-if="carInfo.carMark"><h3 class="b-content_title m0">Автомобиль</h3><h3 class="b-content_title p20 mt10"><strong><span ng-bind="carInfo.carMark.title"></span> <span ng-bind="carInfo.carModelGroup.title"></span> <span ng-bind="carInfo.carModel.title"></span> — <span ng-bind="calculation.car_manufacturing_year"></span> г. выпуска, <span ng-bind="calculation.engine_power"></span> л.с.</strong></h3><h3 class="b-content_title mt30">Водители:</h3><h3 class="b-content_title p20 mt10" ng-show="!calculation.is_multidrive"><div ng-repeat="driver in calculation.driver_set"><strong>Возраст - <span ng-bind="driver.age"></span>, стаж - <span ng-bind="driver.expirience"></span></strong></div></h3><h3 class="b-content_title p20 mt10" ng-show="calculation.is_multidrive"><div><strong>Минимальный возраст - <span ng-bind="calculation.drivers_minimal_age"></span>, минимальный стаж - <span ng-bind="calculation.drivers_minimal_experience"></span></strong></div></h3><div class="b-ordering-block_icon"><i class="icon info"></i></div></div></div><div class="five wide column"><div class="b-full-width-bg b-ordering-block b-full-width-bg--red" style="height: 100%" ng-if="carFilterParams.selectedResult()"><h3 class="b-content_title m0">Выбранный страховой продукт:</h3><h3 class="b-content_title c-tar m0 mt10"><div class="b-ordering_ins-company"><strong ng-bind="carFilterParams.selectedResult().insurance_company.title"></strong></div><div class="mt5 b-ordering_price"><strong><span ng-bind="carFilterParams.selectedResult().program.sum | priceFormatter:0:\'\':false"></span>.<small ng-bind="carFilterParams.selectedResult().program.sum | fractionalFormatter:2"></small> р.</strong></div></h3><div class="b-ordering-block_icon"><i class="icon calculator"></i></div></div></div></div><div class="row"><div class="eleven wide column"><div class="b-full-width-bg b-ordering-block b-ordering-block--form"><h3 class="b-content_title m0 mb20">Введите данные для оформления заказа:</h3><form name="ordering_form"><div class="ui form"><div class="ui grid stackable two column"><div class="row" ng-if="!$root.currentBrand.with_sms"><div class="column"><div class="field"><label>Ваше имя:</label> <input type="text" ng-model="formFields.client_name" required=""></div></div><div class="column"><div class="field"><label>Ваш телефон:</label> <input type="text" ui-mask="+7 (999) 999-9999" required="" placeholder="+7 (___) ___-____" ng-model="formFields.client_phone"></div></div></div><div class="row"><div class="column"><div class="field"><label>Способ оплаты:</label><div class="ui search selection dropdown" id="id_owner_registration" sem-dropdown="" ng-model="formFields.payment_type" sem-dropdown-simple="true" sem-dropdown-items="paymentType"></div></div></div></div><div class="row one column"><div class="column"><div class="mt10"><sem-checkbox ng-model="formFields.receipt_type" sem-label="Бесплатная доставка в течение 2-х дней" sem-type="radio" class="mr25" name="receipt_type" value="delivery"></sem-checkbox><sem-checkbox ng-model="formFields.receipt_type" sem-label="Оформление в офисе" sem-type="radio" name="receipt_type" value="office"></sem-checkbox></div></div></div></div><div class="ui grid" ng-if="formFields.receipt_type === \'delivery\'"><div class="row one column pt0"><div class="column"><div class="field"><label for="id_delivery_address">Адрес доставки:</label> <input type="text" required="" id="id_delivery_address" ng-model="formFields.delivery_address"></div></div></div><div class="row two column pt0"><div class="column"><div class="field" ng-class="{error: formFields.delivery_date && ordering_form.delivery_date.$invalid}"><label for="id_delivery_date">Дата доставки:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 0)}}" jdatepicker-only-future="true" name="delivery_date" placeholder="__.__.____" id="id_delivery_date" required="" ng-model="formFields.delivery_date"> <i class="icon calendar circular branded inverted"></i></div></div></div><div class="column"><div class="field"><label for="id_delivery_time">Время доставки:</label> <input type="text" required="" ng-model="formFields.delivery_time" id="id_delivery_time"></div></div></div></div><div class="ui grid" ng-if="formFields.receipt_type === \'office\'"><div class="row two column pt0"><div class="column"><div class="field" ng-class="{error: formFields.arrival_date && ordering_form.arrival_date.$invalid}"><label for="id_arrival_date">Дата оформления:</label><div class="ui icon input"><input type="text" jdatepicker="" jdatepicker-year-range="{{getYearRange(0, 0)}}" jdatepicker-only-future="true" name="arrival_date" placeholder="__.__.____" id="id_arrival_date" required="" ng-model="formFields.arrival_date"> <i class="icon calendar circular branded inverted"></i></div></div></div><div class="column" ng-if="!$root.currentBrand.arrival_time_is_hidden"><div class="field"><label for="id_arrival_time">Время оформления:</label> <input type="text" required="" ng-model="formFields.arrival_time" id="id_arrival_time"></div></div></div></div></div></form><div class="b-ordering-block_icon"><i class="icon write"></i></div></div></div><div class="five wide column"><div class="b-ordering-block_submit b-full-width-bg b-ordering-block b-full-width-bg--grey"><button type="button" onclick="yaCounter41407164.reachGoal(\'m-order\'); return true;" ng-click="sendPolicyOrdering()" ng-disabled="ordering_form.$invalid || policyOrderingInProgress" ng-class="[policyOrderingInProgress ? \'loading\' : \'\', ($root.currentBrand.order_the_policy_button || $root.currentBrand.main_buttons_color)]" class="ui button">Заказать полис</button></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/policy.info.html",'<div class="mt30 b-cards-info" ng-if="getSelectedResult().id"><div class="ui grid stackable"><div class="row"><div class="column"><div class="ui card" style="width: 100%"><div class="content"><div class="ui stackable grid"><div class="row two column"><div class="column"><h3 class="header" ng-bind="root.selectedResult.insurance_company.title"></h3></div><div class="column"><h3 class="header">+ бесплатный БРОКЕС АССИСТАНС <span class="colour-red">*</span></h3></div></div></div></div><div class="content"><div class="ui stackable grid"><div class="row two column"><div class="column"><div ng-repeat="option in root.selectedResult.program.option_set"><h4 class="header mb5" ng-bind="option.title" style="font-weight: bold"></h4><p class="mb10" ng-bind="option.note"></p></div></div><div class="column"><h4 class="header mb5" style="font-weight: bold;">Сбор справок</h4><p class="mb10">Выезд эксперта "БРОКЕРС" в страховую компанию для составления заявления о страховом случае</p><h4 class="header mb5" style="font-weight: bold;">Аварийный комиссар</h4><p class="mb10">Помощь в оформлении европротокола</p><h4 class="header mb5" style="font-weight: bold;">Консультация</h4><p class="mb10">Горячая линия 24/7</p><h4 class="header mb5" style="font-weight: bold;">Эвакуация</h4><p class="mb10">1 раз в год</p><h4 class="header mb5" style="font-weight: bold;">Подарок</h4><p class="mb10">Да</p><h4 class="header mb5" style="font-weight: bold;">Ремонт кузова</h4><p class="mb10">Контроль выполнения восстановительного ремонта в "Автоцентре БРОКЕРС"</p><h4 class="header mb5" style="font-weight: bold;">Автомобиль в аренду</h4><p class="mb10">Нет</p><h4 class="header mb5" style="font-weight: bold;">Требования к ПУС</h4><p class="mb10">Нет</p><h4 class="header mb5" style="font-weight: bold;">Ремонт стекол</h4><p class="mb10">Контроль выполнения восстановительного ремонта в "Автоцентре БРОКЕРС"</p><h4 class="header mb5 colour-red" style="font-weight: bold;"><span class="colour-red">*</span> Возможность расширения до:</h4><p class="mb10 colour-red">Геолокация и вызов экстренных служб, Досудебное урегулирование по ДТП, Зарядка аккумулятора, Подвоз бензина, Услуга "Трезвый водитель", Выездной шиномонтаж</p></div></div></div></div><div class="extra content" ng-hide="root.selectedResult.show_info_on_last_step"><button class="ui button green small" title="Перейти к заказу" ng-click="bigSteps.setBigStep(\'fourth\');" type="button">Заказать</button></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/program_list.manager.html",'<div class="b-post-calculate" ng-show="postCalculateParams.is_visible"><div align="center"><div class="b-post-calculate_pre" ng-show="!postCalculateParams.second && !postCalculateParams.third"><div ng-show="!postCalculateParams.first"><div class="b-post-calculate_pre-title"><i class="icon info circle"></i> КАСКО можно сделать дешевле! Попробуем?</div><div class="b-post-calculate_pre-actions mt20"><button class="ui button green small" ng-click="postCalculateParams.first = true;" type="button">Да, конечно</button> <button class="ui button orange small ml10" ng-click="postCalculateParams.is_visible = false;" type="button">Нет, спасибо</button></div></div><div ng-show="postCalculateParams.first"><div class="b-post-calculate_pre-title"><i class="icon info circle"></i> Самостоятельно на сайте или с помощью менеджера?</div><div class="b-post-calculate_pre-actions mt20"><button class="ui button green small" ng-click="postCalculateParams.second = true;" type="button">Я сам</button> <button class="ui button olive small ml10" ng-click="toManager()" type="button">Пусть позвонит менеджер</button></div></div></div></div><div class="b-post-calculate_manager" ng-show="postCalculateParams.third"><div class="ui form"><div class="ui grid two column stackable"><div class="row"><div class="column"><div class="field"><label for="id_manager__client_name">Как к вам обращаться?</label> <input type="text" id="id_manager__client_name" ng-model="postCalculateParams.manager__client_name"></div></div><div class="column"><div class="field"><label for="id_manager__client_phone">Номер телефона:</label> <input type="text" ui-mask="+7 (999) 999-9999" placeholder="+7 (___) ___-____" ng-model="clientParams.manager__client_phone" id="id_manager__client_phone"></div></div></div><div class="row"><div class="column"></div><div class="column"><button class="ui button green fluid" ng-click="sendToManager()" ng-disabled="!postCalculateParams.manager__client_name || !clientParams.manager__client_phone || postCalculateParams.button_is_disabled" type="button">Отправить заявку на звонок</button></div></div></div></div></div><div class="b-post-calculate_fields css-bigger-labels" ng-show="postCalculateParams.second"><div class="ui form"><div class="ui grid two column stackable doubling"><div class="row"><div class="column"><div class="field"><label for="id_deductible_value">Франшиза:</label> <input type="text" id="id_deductible_value" class="input-has-slider" name="deductible_value" ng-model="params.deductible_value"><div input-slider="" is-sum="true" default-min="0" slider-step="500" default-max="50000" ng-model="params.deductible_value"></div></div></div><div class="column" align="center"><p class="pt10"><i class="icon help circle grey"></i>Франшиза — это та часть ущерба, которую вы возмещаете за свой счет, если наступил страховой случай.</p></div></div><div class="row"><div class="sixteen wide column"><div class="field pt10"><label>Рассрочка оплаты на год:</label><div class="ui buttons mt5" style="border: none;"><button class="ui teal button" ng-repeat="item in params.contributoryScheme" type="button" ng-class="{basic: item.id !== params.contributory_scheme}" ng-click="params.contributory_scheme = item.id"><span ng-bind="item.title"></span></button></div></div></div></div><div class="row" ng-hide="$root.currentBrand.payment_form_is_hidden"><div class="sixteen wide column"><div class="field"><label>Ремонт:</label><div class="four ui buttons mt5" style="border: none;"><button class="ui teal button" ng-repeat="item in paymentForm" type="button" ng-class="{basic: item.id !== params.payment_form}" ng-click="params.payment_form = item.id"><span ng-bind="item.title"></span></button></div></div></div></div><div class="row"><div class="sixteen wide column"><div class="mt15" align="right"><button class="ui button green m0" style="width: 50%;" ng-disabled="params.recalculateButtonIsDisabled" ng-click="calculateKasko()" ng-class="{loading: params.recalculateButtonIsDisabled}" type="button">Обновить тарифы</button></div></div></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/second_big_step.html",'<div><div class="ui large labels" ng-class="$root.currentBrand.steps_buttons_color"><div class="ui label basic mb10" ng-repeat="item in carFilterParams.brandSteps.second" ng-show="getCurrentStepObject(item).getLabelTitle()"><span ng-bind="getCurrentStepObject(item).getLabelTitle()"></span> <i class="icon delete" ng-click="setActiveStep(getCurrentStepObject(item).name)" ng-keydown="$event.keyCode == 13 && setActiveStep(getCurrentStepObject(item).name)" tabindex="0"></i></div></div><div class="p20" ng-show="getActiveStepSecond().name !== carFilterParams.brandSteps.second[0]"><div class="ui divider" style="border-top-style: dashed;"></div></div><div ng-repeat="item in carFilterParams.brandSteps.second" class="c-hidden" ng-class="\'show-active-\' + getCurrentStepObject(item).name" ng-include="getCurrentStepObject(item).templateUrl"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/sms_step_osago.html",'<div class="ui grid three column doubling stackable css-bigger-labels"><div class="row"><div class="column"><div class="field"><label for="id_client_name">Как к вам обращаться?</label> <input type="text" ng-disabled="calculationInterParams.client_params_are_disabled || calculationInterParams.sms_is_visible" ng-model="calculationInterParams.client_name" placeholder="Имя" id="id_client_name"></div></div><div class="column"><div class="field"><label for="id_client_phone">Номер телефона:</label> <input type="text" ui-mask="+7 (999) 999-9999" ng-disabled="calculationInterParams.client_params_are_disabled || calculationInterParams.sms_is_visible" placeholder="+7 (___) ___-____" model-view-value="true" ng-model="calculationInterParams.client_phone" id="id_client_phone"></div></div><div class="column"><div class="field"><label>&nbsp;</label> <button class="ui button teal fluid" ng-disabled="!calculationInterParams.client_phone || !calculationInterParams.client_name || calculationInterParams.client_params_are_disabled || calculationInterParams.sms_is_visible" ng-click="showSMSformOsago()" type="button">Отправить</button></div></div></div><div class="row" ng-if="calculationInterParams.sms_is_visible"><div class="column"><a href="" class="css-bottom-dashed pt30" style="font-size: 15px;" ng-click="calculationInterParams.sms_is_visible = false;">Изменить номер телефона</a></div><div class="column"><div class="field" ng-class="{error: !calculationInterParams.sms_code}"><label for="id_sms_code">Код из СМС:</label> <input type="text" ng-model="calculationInterParams.sms_code" placeholder="1234" maxlength="4" input-integer="" id="id_sms_code"></div></div><div class="column"><div class="field"><label>&nbsp;</label> <button class="ui button green fluid" ng-disabled="!calculationInterParams.sms_code || calculationInterParams.sms_button_is_disabled" ng-click="confirmCodeOsago()" type="button">Подтвердить</button></div></div></div><div class="row" ng-show="calculatorParams.confirm_code_is_incorrect"><div class="sixteen wide column"><div class="ui message error visible">Код СМС не совпал с отправленным.</div></div></div></div>');
}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/carFilter/views/third_big_step.html",'<div class="ui grid three column doubling stackable css-bigger-labels"><div class="row"><div class="column"><div class="field"><label for="id_client_name">Как к вам обращаться?</label> <input type="text" ng-disabled="clientParams.client_params_are_disabled || clientParams.sms_is_visible" ng-model="clientParams.client_name" placeholder="Имя" id="id_client_name"></div></div><div class="column"><div class="field"><label for="id_client_phone">Номер телефона:</label> <input type="text" ui-mask="+7 (999) 999-9999" ng-disabled="clientParams.client_params_are_disabled || clientParams.sms_is_visible" placeholder="+7 (___) ___-____" model-view-value="true" ng-model="clientParams.client_phone" id="id_client_phone"></div></div><div class="column"><div class="field"><label>&nbsp;</label> <button class="ui button teal fluid" ng-disabled="!clientParams.client_phone || !clientParams.client_name || clientParams.client_params_are_disabled || clientParams.sms_is_visible" ng-click="showSMSform();calculateKaskoCarFilter()" onclick="yaCounter41407164.reachGoal(\'m-show-tariff\'); return true;" type="button">Показать тарифы</button></div></div></div><div class="row" ng-if="clientParams.sms_is_visible"><div class="column"><a href="" class="css-bottom-dashed pt30" style="font-size: 15px;" ng-click="clientParams.sms_is_visible = false;">Изменить номер телефона</a></div><div class="column"><div class="field" ng-class="{error: !clientParams.sms_code}"><label for="id_sms_code">Код из СМС:</label> <input type="text" ng-model="clientParams.sms_code" placeholder="1234" maxlength="4" input-integer="" id="id_sms_code"></div></div><div class="column"><div class="field"><label>&nbsp;</label> <button class="ui button green fluid" ng-disabled="!clientParams.sms_code || clientParams.sms_button_is_disabled" ng-click="confirmCode()" onclick="yaCounter41407164.reachGoal(\'m-confirm-code\'); return true;" type="button">Подтвердить</button></div></div></div><div class="row" ng-show="calculatorParams.confirm_code_is_incorrect"><div class="sixteen wide column"><div class="ui message error visible">Код СМС не совпал с отправленным.</div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/preCalculator/views/pre_calculator.other.html","")}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/preCalculator/views/pre_calculator.rolf.html",'<div class="b-full-width-bg mt10 p20 pt20"><div class="ui grid stackable"><div class="two wide column"></div><div class="six wide column"><button type="button" ng-if="!preCalculatorParams.is_second_step" ng-click="preCalculatorParams.is_second_step = true;" class="ui button fluid big branded" style="height: 100%;">КАСКО на новый автомобиль</button></div><div class="six wide column"><a ui-sref="index.calculator.kasko" ng-if="!preCalculatorParams.is_second_step" type="button" class="ui button fluid big blue">КАСКО на авто с пробегом для новых клиентов</a></div><div class="two wide column"></div></div><div ng-if="preCalculatorParams.is_second_step"><div class="ui grid stackable"><div class="row"><div class="column wide"><h2 class="b-content_title m0 mb30">Укажите нужный вариант</h2><div class="mt15"><sem-checkbox ng-model="preCalculatorParams.selectedType" sem-label="{{ typesToSelect.first.title }}" sem-type="radio" class="" name="selected_type" value="first"></sem-checkbox></div><div class="mt15"><sem-checkbox ng-model="preCalculatorParams.selectedType" sem-label="{{ typesToSelect.second.title }}" sem-type="radio" class="" name="selected_type" value="second"></sem-checkbox></div><button type="button" ng-disabled="!preCalculatorParams.selectedType" ng-click="preCalculatorParams.toNextStep()" ng-class="$root.currentBrand.main_buttons_color" class="ui button right floated">Далее</button></div></div></div></div></div><style>\n    .ui.button {\n        font-weight: 400;\n    }\n</style>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/postCalculator/views/post_calculator.rolf-previous.html",'<div class="b-full-width-bg mt30 p20 pt20 pb20"><h3>Для того, чтобы получить максимально выгодное предложение свяжитесь с нами по телефону 8&nbsp;495&nbsp;788&#045;99&#045;77 или напишите нам.</h3><div class="ui form"><div class="ui grid two column stackable"><div class="row three column"><div class="column"><div class="field"><label for="id_manager__client_name">Имя</label> <input type="text" id="id_manager__client_name" ng-disabled="postCalculatorParams.is_visible" ng-model="postCalculatorParams.client_name"></div></div><div class="column"><div class="field"><label for="id_manager__client_phone">Телефон</label> <input type="text" ng-disabled="postCalculatorParams.is_visible" ui-mask="+7 (999) 999-9999" placeholder="+7 (___) ___-____" ng-model="postCalculatorParams.client_phone" id="id_manager__client_phone"></div></div></div></div><div class="ui grid stackable"><div class="row"><div class="wide column"><div class="field"><label></label> <textarea rows="4" placeholder="Текст сообщения" ng-disabled="postCalculatorParams.is_visible" ng-model="postCalculatorParams.message">\n            </textarea></div></div></div><div class="row"><div class="column"><button class="ui button green" ng-click="preSendToManager()" ng-disabled="!postCalculatorParams.client_name || !postCalculatorParams.client_phone || !postCalculatorParams.message || postCalculatorParams.button_is_disabled" type="button">Отправить</button></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/postCalculator/views/post_calculator.rolf.html",'<div class="b-full-width-bg mt30 p20 pt20 pb20"><h3>Для того, чтобы получить максимально выгодное предложение свяжитесь с нами по телефону 8&nbsp;495&nbsp;788&#045;99&#045;77 или напишите нам.</h3><div class="ui form"><div class="ui grid stackable"><div class="row three column"><div class="column"><div class="field"><label for="id_manager__client_name">Имя</label> <input type="text" id="id_manager__client_name" ng-disabled="postCalculatorParams.is_visible" ng-model="postCalculatorParams.client_name"></div></div><div class="column"><div class="field"><label for="id_manager__client_phone">Телефон</label> <input type="text" ng-disabled="postCalculatorParams.is_visible" ui-mask="+7 (999) 999-9999" placeholder="+7 (___) ___-____" ng-model="postCalculatorParams.client_phone" id="id_manager__client_phone"></div></div></div></div><div class="ui grid stackable"><div class="row"><div class="column"><h3 class="b-content_title">Выберите марку:</h3><div class="ui basic four buttons"><button type="button" ng-click="setCarMark(\'Mitsubishi\')" ng-class="{\'active\': postCalculatorParams.carMark === \'Mitsubishi\'}" class="ui button">Mitsubishi</button> <button type="button" ng-click="setCarMark(\'Ford\')" ng-class="{\'active\': postCalculatorParams.carMark === \'Ford\'}" class="ui button">Ford</button> <button type="button" ng-click="setCarMark(\'Mazda\')" ng-class="{\'active\': postCalculatorParams.carMark === \'Mazda\'}" class="ui button">Mazda</button> <button type="button" ng-click="setCarMark(\'Hyundai\')" ng-class="{\'active\': postCalculatorParams.carMark === \'Hyundai\'}" class="ui button">Hyundai</button></div></div></div><div class="row"><div class="column"><button class="ui button green" ng-click="preSendToManager()" ng-disabled="!postCalculatorParams.client_name || !postCalculatorParams.client_phone || !postCalculatorParams.carMark || postCalculatorParams.button_is_disabled" type="button">Отправить</button></div></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/first_big_step.html",'<div><div class="ui large labels" ng-class="$root.currentBrand.steps_buttons_color"><div class="ui label basic mb10" ng-repeat="item in carFilterParams.brandSteps.first" ng-show="getCurrentStepObject(item).getLabelTitle()"><span ng-bind="getCurrentStepObject(item).getLabelTitle()"></span> <i class="icon delete" ng-click="setActiveStep(getCurrentStepObject(item).name)" ng-keydown="$event.keyCode == 13 && setActiveStep(getCurrentStepObject(item).name)" tabindex="0"></i></div></div><div class="p20" ng-show="getActiveStep().name !== carFilterParams.brandSteps.first[0]"><div class="ui divider" style="border-top-style: dashed;"></div></div><div ng-repeat="item in carFilterParams.brandSteps.first" ng-show="getCurrentStepObject(item).name === getActiveStep().name" ng-class="\'show-active-\' + getCurrentStepObject(item).name" ng-include="getCurrentStepObject(item).templateUrl"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.calculation_type.html",'<div><h3 class="b-content_title mb30 mt30">Тип расчета ОСАГО:</h3><div class="p20 mb25" ng-show="$root.currentBrand.show_user_agreement && !carFilterParams.calculation_type"><sem-checkbox ng-model="personalData.user_agreement" sem-label="Согласен на обработку моих персональных данных" id="personal_data" name="personal_data"></sem-checkbox></div><div ng-class="{\'css-disabled-links\': !personalData.user_agreement}"><h3 class="b-content_title p20 m0"><a href="" ng-repeat="item in calcTypes" ng-click="setCalculationType(item.id)" ng-bind="item.title" ng-class="{\'css-bottom-dashed--active\': item.id == calculationInterParams.calculation_type}" class="mr25 css-bottom-dashed"></a></h3></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.car_cost.html",'<div class="fields"><div class="five wide field nowrap"><label for="id_car_cost">Укажите стоимость автомобиля в руб.:</label> <input type="text" ng-model="calculationInterParams.car_cost" price-formatter="2" class="input-has-slider" required="" no-empty="" id="id_car_cost"><div input-slider="" is-sum="true" default-min="100000" slider-step="5000" default-max="3000000" ng-model="calculationInterParams.car_cost"></div></div><div class="eleven wide field c-tar"><label>&nbsp;</label> <button type="button" ng-click="toNextStep(\'car_cost\')" ng-class="$root.currentBrand.main_buttons_color" ng-disabled="!calculationInterParams.car_cost" class="ui button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.car_mark.html",'<div class="calculator-caption calculator-caption-model mb15"><div class="pos-rel mb15"><b>Выберите марку:</b> <label class="b-car-search"><div class="ui icon input transparent"><input type="text" placeholder="Найти" ng-model="carSearch.title"> <i class="icon search"></i></div></label></div><div car-marks-list="" style="clear: both;" ng-model="calculation.car_mark" limit="56"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.car_model.html",'<div class="calculator-caption calculator-caption-model mb15"><div class="pos-rel mb15"><b>Выберите модификацию —</b> {{ allSelected.carMark.title }} <span ng-if="!allSelected.carModel.title">{{ allSelected.carModelGroup.title }}</span> <span ng-if="allSelected.carModel.title">{{ allSelected.carModel.title }}</span>:</div><div car-models-list="" style="clear: both;" ng-model="calculation.car_model" car-mark-id="modelCarMark" car-manufacturing-year="calculation.car_manufacturing_year" car-model-group-id="calculation.car_model_group"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.car_model_group.html",'<div class="calculator-caption calculator-caption-model mb15"><div class="pos-rel mb15"><b>Выберите модель —</b> {{allSelected.carMark.title}} <span ng-if="!allSelected.carModel.title">{{allSelected.carModelGroup.title}}</span> <span ng-if="allSelected.carModel.title">{{allSelected.carModel.title}}</span>:</div><div car-group-models-list="" style="clear: both;" ng-model="calculation.car_model_group" car-manufacturing-year="calculation.car_manufacturing_year" car-mark-id="modelCarMark"></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.car_settings.tumen.html",'<div class="ui form is-form" ng-form="car_settings_tumen_form"><div class="ui grid"><div class="row three column bottom aligned"><div class="column"><div class="field"><label for="id_car_cost">Укажите стоимость автомобиля в руб.:</label> <input type="text" ng-model="calculationInterParams.car_cost" price-formatter="2" class="input-has-slider" required="" no-empty="" id="id_car_cost"><div input-slider="" is-sum="true" default-min="100000" slider-step="5000" default-max="3000000" ng-model="calculationInterParams.car_cost"></div></div></div><div class="column"><div class="field"><label for="id_mileage">Укажите пробег автомобиля в км:</label> <input type="text" ng-model="calculationInterParams.mileage" price-formatter="2" class="input-has-slider" id="id_mileage"><div input-slider="" is-sum="true" default-min="0" slider-step="500" default-max="200000" ng-model="calculationInterParams.mileage"></div></div></div><div class="column"><div class="field"><label for="id_engine_power">Выберите мощность двигателя, л.с.:</label> <input type="text" ng-class="{\'is-invalid-calc\': calculationInterParams.engine_power < 10 || calculationInterParams.engine_power > 999}" ng-model="calculationInterParams.engine_power" input-only="[0-9]{1,3}" placeholder="0" class="input-has-slider" required="" id="id_engine_power"><div input-slider="" default-min="70" slider-step="1" default-max="500" ng-model="calculationInterParams.engine_power"></div></div></div></div><div class="row three column"><div class="column nowrap"><div class="field"><label for="id_car_displacement">Укажите объем двигателя:</label> <input type="text" ng-model="calculationInterParams.engine_displacement" price-formatter="2" ng-min="0.1" ng-max="10" required="" id="id_car_displacement"></div></div></div><div class="row two column"><div class="column"><div class="field"><label>Укажите коробку передач:</label><div class="ui two basic buttons"><button class="ui button" ng-repeat="item in carFilterParams.transmission" ng-click="calculationInterParams.params.transmission = item.id;" ng-class="[getActiveButtonClass(item.id === calculationInterParams.params.transmission), $root.currentBrand.united_buttons_color]" type="button"><span ng-bind="item.title"></span></button></div></div></div><div class="column"><div class="field"><label>Укажите привод:</label><div class="ui basic buttons three"><button class="ui button" ng-repeat="item in carFilterParams.driveOfCar" ng-click="calculationInterParams.params.drive_of_car = item.id;" ng-class="[getActiveButtonClass(item.id === calculationInterParams.params.drive_of_car), $root.currentBrand.united_buttons_color]" type="button"><span ng-bind="item.title"></span></button></div></div></div></div><div class="row one column"><div class="column" align="right"><button type="button" ng-click="toNextStep(\'car_settings.tumen\')" ng-disabled="!calculationInterParams.engine_power || car_settings_tumen_form.$invalid" ng-class="$root.currentBrand.main_buttons_color" class="ui button">Далее</button></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.contributory_scheme.html",'<div class="ui grid"><div class="bottom aligned row"><div class="ten wide column"><div class="field"><label>Рассрочка оплаты на год:</label><div class="ui four basic buttons mt5" ng-class="$root.currentBrand.united_buttons_color"><button class="ui button" ng-repeat="item in calculatorParams.contributoryScheme" ng-class="{active: item.id == calculationInterParams.contributory_scheme}" type="button" ng-click="calculationInterParams.contributory_scheme = item.id"><span ng-bind="item.title"></span></button></div></div></div><div class="six wide right aligned column"><button type="button" ng-click="toNextStep(\'contributory_scheme\')" class="ui button branded">Далее</button></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.drivers.html",'<div ng-form="all_drivers_form" class="css-bigger-labels css-bigger-slider is-form"><div ng-repeat="item in calculationInterParams.drivers track by $index" ng-form="driver_kasko_form"><h2 class="b-content_title mb20 mt30" ng-if="calculationInterParams.currentDriverIndex === $index"><span ng-bind="$index + 1"></span>-й водитель:</h2><h3 class="b-content_title mb20 mt30" ng-if="calculationInterParams.lastDriverIndex > $index && calculationInterParams.currentDriverIndex !== $index"><span><span ng-bind="$index + 1"></span>-й водитель: <span ng-bind="item.gender === \'M\' ? \'Муж.\' : \'Жен.\'"></span> <span ng-bind="item.age + \'/\' + item.expirience"></span> <i class="icon write ml10" ng-if="all_drivers_form.$valid && !calculationInterParams.driverIsEditing" ng-click="toEditDriver($index)"></i></span></h3><div class="ui grid three column mt20 doubling stackable" ng-if="calculationInterParams.currentDriverIndex === $index"><div class="row"><div class="column"><div class="field" ng-class="{\'error\': item.age < 18 || item.age > 90}"><label for="id_driver_age_{{$index}}">Возраст:</label> <input type="text" id="id_driver_age_{{$index}}" class="input-has-slider" price-formatter="" name="age" required="" ng-model="item.age"><div input-slider="" default-min="18" slider-step="1" default-max="90" ng-model="item.age"></div></div></div><div class="column"><div class="field" ng-class="{\'error\': item.age - item.expirience < 18}"><label for="id_driver_expirience_{{$index}}">Стаж:</label> <input type="text" id="id_driver_expirience_{{$index}}" required="" class="input-has-slider" name="expirience" price-formatter="" ng-model="item.expirience"><div input-slider="" default-min="0" slider-step="1" default-max="72" ng-model="item.expirience"></div></div></div><div class="column"><div class="field"><label>Пол:</label><div class="ui basic two buttons"><button class="ui button" ng-click="item.gender = \'M\'" ng-class="getActiveButtonClass(item.gender === \'M\')" type="button">Мужской</button> <button class="ui button" ng-click="item.gender = \'F\'" ng-class="getActiveButtonClass(item.gender === \'F\')" type="button"><span class="h-button-expander"></span> Женский</button></div></div></div></div><div class="row mt10"><div class="column"><div class="field"><label>В браке:</label><div class="ui basic two buttons"><button class="ui button" ng-click="item.is_married = true" ng-class="getActiveButtonClass(item.is_married)" type="button">Да</button> <button class="ui button" ng-click="item.is_married = false" ng-class="getActiveButtonClass(!item.is_married)" type="button">Нет</button></div></div></div><div class="column"><div class="field"><label>Дети:</label><div class="ui basic two buttons"><button class="ui button" ng-click="item.has_children = true" ng-class="getActiveButtonClass(item.has_children)" type="button">Да</button> <button class="ui button" ng-click="item.has_children = false" ng-class="getActiveButtonClass(!item.has_children)" type="button">Нет</button></div></div></div></div><div class="row"><div class="column"></div><div class="column"></div><div class="column"><div class="field" align="right"><label>&nbsp;</label> <button class="fluid ui button" ng-class="$root.currentBrand.main_buttons_color" ng-disabled="driver_kasko_form.$invalid || item.age > 90 || item.age < 18 || item.age - item.expirience < 18" ng-click="goNextDriver($index)" onclick="yaCounter41407164.reachGoal(\'m-drivers\'); return true;" type="button">Далее</button></div></div></div></div></div><div align="right" ng-class="$root.currentBrand.main_buttons_color" ng-if="calculationInterParams.currentDriverIndex === calculationInterParams.drivers.length"><button class="ui button green" type="button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.drivers_count.html",'<div><h2 class="b-content_title mb20">Выберите количество водителей:</h2><div class="five ui basic buttons"><button class="ui button" ng-repeat="item in driversChanging" ng-click="changeDriversCount(item)" ng-class="$root.currentBrand.united_buttons_color" type="button"><span ng-bind="item.title"></span></button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.engine_power.html",'<div class="fields"><div class="five wide field nowrap"><label for="id_engine_power">Выберите мощность двигателя, л.с.:</label> <input type="text" ng-class="{\'is-invalid-calc\': calculationInterParams.engine_power < 10 || calculationInterParams.engine_power > 999}" ng-model="calculationInterParams.engine_power" input-only="[0-9]{1,3}" placeholder="0" class="input-has-slider" required="" id="id_engine_power"><div input-slider="" default-min="70" slider-step="1" default-max="500" ng-model="calculationInterParams.engine_power"></div></div><div class="eleven wide field c-tar"><label>&nbsp;</label> <button type="button" ng-click="toNextStep(\'engine_power\')" ng-disabled="!calculationInterParams.engine_power" ng-class="$root.currentBrand.main_buttons_color" class="ui button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.exploitation_area.html",'<div><h3 class="b-content_title mb20 mt30">Выберите регион эксплуатации автомобиля:</h3><div class="ui grid stackable"><div class="twelve wide column" ng-show="!carFilterParams.ownerRegistrationViewIsFull"><h3 class="b-content_title p20 m0"><a href="" ng-repeat="item in mainRegions" ng-click="selectExploitationArea(item.id)" ng-bind="item.title" ng-class="{\'css-bottom-dashed--active\': item.id == calculationInterParams.exploitation_area}" class="mr25 css-bottom-dashed mb10"></a> <a href="" ng-click="toggleOwnerRegistrationView()" ng-if="!$root.currentBrand.exploitation_area_all_are_hidden">другой</a></h3></div><div class="five wide column" ng-show="carFilterParams.ownerRegistrationViewIsFull"><div class="p20 field"><div class="ui search selection dropdown" id="id_exploitation_area" ng-focus="carFilterParams.was_clicked = true;" ng-click="carFilterParams.was_clicked = true;" sem-dropdown="" sem-dropdown-placeholder="Не выбран" ng-model="calculationInterParams.exploitation_area" ng-change="carFilterParams.was_clicked && selectExploitationArea()" sem-dropdown-items="ownerRegistration"></div></div></div><div class="seven wide column" ng-show="carFilterParams.ownerRegistrationViewIsFull">&nbsp;</div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.is_credit.html",'<div><h3 class="b-content_title mb20 mt30">Куплен в кредит?</h3><div class="ui grid three column doubling stackable"><div class="row"><div class="column"><div class="ui basic buttons" ng-class="$root.currentBrand.united_buttons_color" style="width: 100%"><button class="ui button" ng-click="carFilterParams.setIsCredit(false)" type="button">Нет</button> <button class="ui button" ng-click="carFilterParams.setIsCredit(true)" type="button">Да</button></div></div><div class="column"></div><div class="column"></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.is_earlier_insurance.html",'<div><h3 class="b-content_title mb20 mt30">Ранее страховался?</h3><div class="ui grid three column doubling stackable"><div class="row"><div class="column"><div class="ui basic buttons" ng-class="$root.currentBrand.united_buttons_color" style="width: 100%"><button class="ui button" ng-click="carFilterParams.setIsEarlierInsurance(false)" type="button">Нет</button> <button class="ui button" ng-click="carFilterParams.setIsEarlierInsurance(true)" type="button">Да</button></div></div><div class="column"></div><div class="column"></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.is_multidrive.html",'<div class="ui grid three column mt20 doubling stackable" ng-form="multidrive_form"><div class="row"><div class="column"><div class="field" ng-class="{\'error\': item.age < 18 || item.age > 90}"><label for="id_drivers_minimal_age">Минимальный возраст:</label> <input type="text" id="id_drivers_minimal_age" class="input-has-slider" price-formatter="" name="drivers_minimal_age" required="" ng-model="calculationInterParams.drivers_minimal_age"><div input-slider="" default-min="18" slider-step="1" default-max="90" ng-model="calculationInterParams.drivers_minimal_age"></div></div></div><div class="column"><div class="field" ng-class="{\'error\': calculationInterParams.drivers_minimal_age - calculationInterParams.drivers_minimal_experience < 18}"><label for="id_drivers_minimal_experience">Минимальный стаж:</label> <input type="text" id="id_drivers_minimal_experience" required="" class="input-has-slider" name="drivers_minimal_experience" price-formatter="" ng-model="calculationInterParams.drivers_minimal_experience"><div input-slider="" default-min="0" slider-step="1" default-max="72" ng-model="calculationInterParams.drivers_minimal_experience"></div></div></div></div><div class="row"><div class="column"></div><div class="column"></div><div class="column"><div class="field" align="right"><label>&nbsp;</label> <button class="fluid ui button" ng-disabled="multidrive_form.$invalid || calculationInterParams.drivers_minimal_age > 90 || calculationInterParams.drivers_minimal_age < 18 || calculationInterParams.drivers_minimal_age - calculationInterParams.drivers_minimal_experience < 18" ng-click="toNextStep(\'is_multidrive\')" onclick="yaCounter41407164.reachGoal(\'m-multidrive\'); return true;" ng-class="$root.currentBrand.main_buttons_color" type="button">Далее</button></div></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.mileage.html",'<div class="fields"><div class="five wide field nowrap"><label for="id_mileage">Укажите пробег автомобиля в км:</label> <input type="text" ng-model="calculationInterParams.mileage" price-formatter="2" class="input-has-slider" id="id_mileage"><div input-slider="" is-sum="true" default-min="0" slider-step="500" default-max="200000" ng-model="calculationInterParams.mileage"></div></div><div class="eleven wide field c-tar"><label>&nbsp;</label> <button type="button" onclick="yaCounter41407164.reachGoal(\'m-mileage\'); return true;" ng-click="toNextStep(\'mileage\')" ng-class="$root.currentBrand.main_buttons_color" class="ui button">Далее</button></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.owner_registration.html",'<div><h3 class="b-content_title mb20 mt30">Выберите регион регистрации собственника:</h3><div class="ui grid stackable"><div class="twelve wide column" ng-show="!carFilterParams.ownerRegistrationViewIsFull"><h3 class="b-content_title p20 m0"><a href="" ng-repeat="item in mainOwnerRegistrations" ng-click="selectOwnerRegistration(item.id)" ng-bind="item.title" ng-class="{\'css-bottom-dashed--active\': item.id == carFilterParams.owner_registration}" class="mr25 css-bottom-dashed mb10"></a> <a href="" ng-click="toggleOwnerRegistrationView()" ng-if="!$root.currentBrand.owner_registration_all_are_hidden">другой</a></h3></div><div class="five wide column" ng-show="carFilterParams.ownerRegistrationViewIsFull"><div class="p20 field"><div class="ui search selection dropdown" id="id_owner_registration" ng-focus="carFilterParams.was_clicked = true;" ng-click="carFilterParams.was_clicked = true;" sem-dropdown="" sem-dropdown-placeholder="Не выбран" ng-model="carFilterParams.owner_registration" ng-change="carFilterParams.was_clicked && selectOwnerRegistration()" sem-dropdown-items="ownerRegistration"></div></div></div><div class="seven wide column" ng-show="carFilterParams.ownerRegistrationViewIsFull">&nbsp;</div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.policy_settings.tumen.html",'<div class="ui form is-form" ng-form="policy_settings_tumen_form"><div class="ui grid"><div class="row two column bottom aligned"><div class="column"><div class="field"><label>Оплата:</label><div class="ui basic two buttons"><button class="ui button" type="button" ng-repeat="item in calculatorParams.contributoryScheme" ng-click="calculationInterParams.contributory_scheme = item.id" ng-class="[getActiveButtonClass(item.id === calculationInterParams.contributory_scheme), $root.currentBrand.united_buttons_color]"><span ng-bind="item.title"></span></button></div></div></div><div class="column"><div class="field"><label>Автомобиль на гарантии:</label><div class="ui basic two buttons"><button class="ui button" type="button" ng-repeat="item in carFilterParams.yesNo" ng-click="calculationInterParams.is_under_warranty = item.id" ng-class="[getActiveButtonClass(item.id === calculationInterParams.is_under_warranty), $root.currentBrand.united_buttons_color]"><span ng-bind="item.title"></span></button></div></div></div></div><div class="row two column bottom aligned"><div class="column"><div class="field"><label>Новое ТС:</label><div class="ui basic two buttons"><button class="ui button" type="button" ng-repeat="item in carFilterParams.yesNo" ng-click="calculationInterParams.is_new_car = item.id" ng-class="[getActiveButtonClass(item.id === calculationInterParams.is_new_car), $root.currentBrand.united_buttons_color]"><span ng-bind="item.title"></span></button></div></div></div><div class="column"><div class="field"><label>Выбор СТОА:</label><div class="ui basic two buttons"><button class="ui button" type="button" ng-repeat="item in $root.currentBrand.payment_forms" ng-click="calculationInterParams.payment_form = item.id" ng-class="[getActiveButtonClass(item.id === calculationInterParams.payment_form), $root.currentBrand.united_buttons_color]"><span ng-bind="item.title"></span></button></div></div></div></div></div><div class="row one column"><div class="column" align="right"><button type="button" ng-click="toNextStep(\'policy_settings.tumen\')" ng-disabled="policy_settings_tumen_form.$invalid" ng-class="$root.currentBrand.main_buttons_color" class="ui button mt20">Далее</button></div></div></div>')}]),angular.module("kaskoTemplates").run(["$templateCache",function(e){e.put("/js/modules.shared/calculatorSteps/views/step.year.html",'<div><div class="mb10"><strong>Год выпуска автомобиля:</strong></div><car-manufacturing-years></car-manufacturing-years></div>')}]),function(e){e.module("brandingConfigs",[]).service("brandingConfigs",["$stateParams","moduleType",function(e,t){var a={kasko:{exploitation_area_all_are_hidden:!0,watermark_is_hidden:!0,with_sms:!1,payment_form_is_hidden:!0,arrival_time_is_hidden:!0,steps_buttons_color:"red",link_to_registration_in_email:!0,main_buttons_color:"blue",united_buttons_color:"",exploitation_areas:[30261],payment_forms:[{id:107,title:"У официального дилера"},{id:105,title:"Не официальные СТОА"}],templates:{}},osago:{owner_registration_all_are_hidden:!0,owner_registrations:[104,29871],watermark_is_hidden:!0,show_personal_data:!0,show_user_agreement:!0,link_to_registration_in_email:!0,steps_buttons_color:"red",main_buttons_color:"blue",
templates:{}}};return a[t]}]).service("stepsService",["moduleType",function(e){var t={kasko:{stepsHacks:{},steps:{first:["year","car_mark","car_model_group","car_model","engine_power","exploitation_area","car_cost","mileage"],second:["drivers_count",function(e){return e.is_multidrive?"is_multidrive":"drivers"},"is_credit","calc"]}},osago:{stepsHacks:{},steps:{first:["year","car_mark","car_model_group","car_model","is_credit","engine_power","owner_registration","calculation_type"],second:["drivers_count"]}}};return t[e]}])}(angular),function(e){!function(){var t={kasko:!1,osago:!1},a=e(".js-choose--post"),i=e(".js-choose--pre");a.hide();var n={Kasko:e("#KaskoApp"),Osago:e("#OsagoApp")},r=e(".js-calc-type");e(".js-show-choosing-calc").click(function(t){return e(".b-app-modal").removeClass("b-app-modal--is-hidden"),i.show(),a.hide(),!1}),e(".js-calc-panel-item").click(function(){return e(this).hasClass("js-calc-panel-item--kasko")?(t.kasko||(window.location.hash="#!/pre",angular.bootstrap(n.Kasko,["KaskoApp"]),t.kasko=!0),r.text("КАСКО"),n.Osago.hide(),n.Kasko.show()):(t.osago||(window.location.hash="#!/osago/",angular.bootstrap(n.Osago,["OsagoApp"]),t.osago=!0),r.text("ОСАГО"),n.Osago.show(),n.Kasko.hide()),a.show(),i.hide(),!1}),e(".js-app-modal-close").click(function(){e(".b-app-modal").addClass("b-app-modal--is-hidden")})}()}(jQueryApp);